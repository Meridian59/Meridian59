% Meridian 59, Copyright 1994-2012 Andrew Kirmse and Chris Kirmse.
% All rights reserved.
%
% This software is distributed under a license that is described in
% the LICENSE file that accompanies it.
%
% Meridian is a registered trademark.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
BreakRodHold is Rod

constants:

   include blakston.khd

resources:

   include breakrodhold.lkod

   BreakRodHold_name_rsc = "rod of movement"
   BreakRodHold_icon_rsc = wand5.bgf
   BreakRodHold_desc_rsc = \
      "This rod is elegantly carved with smooth and flowing runes. It exudes "
      "an implicit understanding that it will protect its bearer from "
      "paralyzing magics for two seconds. The energies involved will also "
      "prevent the bearer from casting those same magics for four seconds."
      
   BreakRodHold_success_rsc = \
      "The rod sends flowing energies coursing through you!"
   
   BreakRodHold_drop_rsc = \
      "The freeing magics generated by your rod of movement fade."
   BreakRodHold_secondary_drop_msg = \
      "You feel your ability to cast paralyzing magics return."
   BreakRodHold_success_wav = kraanan.wav

classvars:

   vrName = BreakRodHold_name_rsc
   vrIcon = BreakRodHold_icon_rsc

   viBulk = 25
   viWeight = 25
   viValue_average = 800

   viGround_group = 2
   viInventory_group = 1
   
   vrGoodDesc = BreakRodHold_desc_rsc
   
   use_success_msg = BreakRodHold_success_rsc
   rod_success_wav_default_rsc = BreakRodHold_success_wav
   duration_expire_msg = BreakRodHold_drop_rsc
   secondary_duration_expire_msg = BreakRodHold_secondary_drop_msg
   
   viStartHits = 3
   viStartMaxHits = 3
   viConsumesHits = 3

   vbDurationEffect = TRUE
   viEffectDuration = 2000
   vbSecondaryDurationEffect = TRUE
   viSecondaryEffectDuration = 4000

properties:

messages:

   CastSpell(what = $, apply_on = $)
   {
      % Dispel current hold so that immunity isn't wasted.
      if poOwner <> $
         AND IsClass(poOwner,&Player)
         AND Send(poOwner,@IsEnchanted,#byClass=&Hold)
      {
         Send(poOwner,@RemoveEnchantment,
               #what=Send(SYS,@FindSpellByNum,#num=SID_HOLD));
      }

      propagate;
   }

end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
