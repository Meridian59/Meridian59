% Meridian 59, Copyright 1994-2012 Andrew Kirmse and Chris Kirmse.
% All rights reserved.
%
% This software is distributed under a license that is described in
% the LICENSE file that accompanies it.
%
% Meridian is a registered trademark.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This class is the base for the Quest engine. It serves to keep all the shared
% data (quest templates and quest node templates) in a central place.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
QuestEngine is UtilityFunctions

constants:
   
   include blakston.khd
   include protocol.khd

   QUEST_MAX_NUM_PLAYERS = 5
   QUEST_MAX_MAX_ACTIVE = 100
   
% Field names for a QuestTemplate
%	QT_NUM_PLAYERS       = 1
%	QT_QUEST_TYPE        = 2
%	QT_PLAYER_RESTRICT   = 3
%	QT_QUEST_NODES       = 4
%	QT_MAX_NUM_ACTIVE    = 5
%	QT_ACTIVE_QUESTS     = 6
%	QT_SCHEDULE_CHANCE   = 7
%  QT_PLAYER_RESTRICT2  = 8

% Field names for a QuestNodeTemplate
	QNT_NPC_LIST      = 1
	QNT_NPC_MODIFIER  = 2
	QNT_TYPE          = 3
	QNT_CARGO_LIST    = 4
	QNT_MONSTER_LIST  = 5
	QNT_PRIZE_LIST    = 6
	QNT_PENALTY_LIST  = 7
	QNT_ASSIGN_HINT   = 8
	QNT_SUCCESS_HINT  = 9
	QNT_FAILURE_HINT  = 10
	QNT_TIME_LIMIT    = 11

resources:

	% Chess piece names
	pawn = "Knave"
	pawn1 = "Queen's Keep's Knave"
	pawn2 = "Queen's Steed's Knave"
	pawn3 = "Queen's Priestess' Knave"
	pawn4 = "Queen's Knave"
	pawn5 = "King's Keep's Knave"
	pawn6 = "King's Steed's Knave"
	pawn7 = "King's Priestess' Knave"
	pawn8 = "King's Knave"
	rook = "Keep"
	rook1 = "King's Keep"
	rook2 = "Queen's Keep"
	knight = "Steed"
	knight1 = "King's Steed"
	knight2 = "Queen's Steed"
	bishop = "Priestess"
	bishop1 = "King's Priestess"
	bishop2 = "Queen's Priestess"
	queen = "Queen"
	king = "King"

	two = "two"
	three = "three"
	four = "four"
	five = "five"
	six = "six"
	seven = "seven"

	default_message = "Red Sky begins before the next full moon."
	chess_move = "%q to %q %q"
	chess_capture = "%q captures %q"
	chess_substring = "%q"

	default_assign_hint = "You have been assigned a new questnode."
	temp_assign_hint_bring_me_item = \
	"Excuse me.  I was just doing some minor experimentation with the fringes of the known magics.  I need %INDEF_CARGO %CARGO to continue my research.  Could you be so kind as to bring that to me?"

	temp_assign_hint_bring_message = "Please deliver this message for me to %NPC: %CARGO"
	temp_success_hint_bring_message = "Thanks, but I already knew that."
	temp_assign_hint_reward_message = "You can tell %NPC this for me, though: %CARGO"
	temp_success_hint_reward_message = "For stating the obvious, your reward is %INDEF_PRIZE %PRIZE."

	default_success_hint = "You have successfully completed this questnode."
	first_success_hint = "Ah, just the person I was looking for."
	temp_success_hint_bring_me_item	= "Thanks for bringing me %DEF_CARGO %CARGO.  I don't have much, but let me give you %INDEF_PRIZE %PRIZE for your trouble."
	default_failure_hint = "You have failed to accomplish my request in a timely fashion.  I am very disappointed in you."
	never_again_failure_hint = "Hmmph.  You have failed me.  I will not impose on you in the future with requests of this sort."

	temp_assign_hint_chess1 = "I'm playing a chess game with %NPC.  I've been thinking about it, and I'm ready to send %HIMHER_NPC my next move.  Would you please tell %HIMHER_NPC that my move is %CARGO?"
	temp_success_hint_chess1 = "A brilliant move, but easily blocked."
	temp_assign_hint_chess2 = "Please tell %NPC %CARGO."
	temp_success_hint_chess2 = "That peacock told you that, eh?"
	temp_assign_hint_chess3 = "Well, tell %HIMHER_NPC %CARGO.  And while you're there, tell %HIMHER_NPC 'checkmate'."
	temp_success_hint_chess3 = "A cunning move.  I must be sure to congratulate %NPC.  Take this %PRIZE as a token of my appreciation for being our courier."

	temp_assign_hint_monster = "Beware %DEF_MONSTER %MONSTER, my beamish boy.  The jaws that bite, the claws that catch.  Willst thou slay him for me?"
	temp_success_hint_monster = "Oh, calloo, callay, frabjous day!  Thoust hast slain %DEF_MONSTER %MONSTER."

	temp_assign_hint_monster_item = "I need you to go forth and kill %INDEF_MONSTER %MONSTER, and bring me %DEF_CARGO %CARGO fresh from his steaming carcass.  I will reward you suitably."
	temp_success_hint_monster_item = "Ah, that's just what I needed.  Here is your compensation, %INDEF_PRIZE %PRIZE."

	temp_assign_hint_food_item = "I'm a little hungry, and I've been having a craving for %INDEF_CARGO %CARGO.  Would you be so kind as to bring one to me, right away?"
	temp_success_hint_food_item = "Oh, yummy!  Thank you, and here's %INDEF_PRIZE %PRIZE."

	temp_assign_hint_E3_message = "Can you help me?  I am in terrible trouble.  When I was outside the walls picking mushrooms, a vicious band of Avar attacked me.  Although I escaped, I dropped Tepal's Book of Scavengermancy.  He will hate me if I don't get it back for him.  Could you go find it and bring it to him?  Please.  If you do I'll cast a hex to make you stronger for a few days."
        temp_success_hint_E3_message = "There's my book!  Well, orc-be-damned, I thought it was gone forever."	 
        temp_failure_hint_E3_message = "Didn't Zala mention something to you about getting back my book?  Well, you can forget about that.  I don't want it anymore.  And I'll tell you something, it will be a long time before I lend her anything again."
	temp_E3_trigger = "hello"

	duke_join1_trigger = "join"
	duke_join2_assign = "So, you wish to prove yourself worthy of my trust?  "
	      "You can begin by bringing me %INDEF_CARGO%CARGO."
	duke_join2_success = "Ah, good work.  Your service to our cause will not go unnoticed."
	duke_join2_failure = "Subject: You may not join our ranks, knave!\n"
	      "Hah!  You are not faithful enough to serve our cause!"
	duke_standard1_trigger = "loyalty"
	duke_standard2_assign = "Ah, %NAME, my loyal servant.  I require you to collect all taxes due from %NPC.  "
	      "Return within the hour."
	duke_standard2_failure = "Subject: Tax Collection\n"
	      "I could not wait any longer, I have already sent another courier to collect my taxes."
	duke_standard2_trigger = "tax"
	duke_standard3_assign = "Oh, yes, my tax money for the Duke...  Here it is, %INDEF_CARGO%CARGO."
	duke_standard3_success = "You have done well."
	duke_standard3_failure = "Subject: Your membership in my faction has been revoked\n"
	      "You have failed me.  I will not be so foolish as to rely on your service in the future."
	princess_join2_assign = "So, you wish to prove yourself worthy of my trust?  "
	      "Wouldst thou be so kind as to deliver an official letter to %NPC?  "
	      "I would be most grateful."
	princess_standard2_assign = "Ah, %NAME, my loyal servant.  "
	      "Wouldst thou be so kind as to deliver an official letter to %NPC?  "
	      "I would be most grateful."
	princess_standard2_success = "A letter from her highness?!  Excellent.  Thank you, %NAME."
	princess_standard2_failure = "Subject: Your membership in my faction has been revoked\n"
	      "Thou hath failed me.  I will not be so foolish as to rely on thy service in the future."
	rebel_join2_assign = "You wish to join our fight for freedom?  I cannot trust you, for you may "
	      "be a spy for my enemies.  Prove your value by bringing me %INDEF_CARGO%CARGO."
	rebel_join2_success = "Excellent work!  This will equip the troops I field in battle.  Consider "
	      "yourself one of the freedom fighters for the land."
	rebel_join2_failure = "Subject: Your lack of action.\n"
	      "Your lack of actions probably confirms my fears that you were a spy for the other weak "
	      "leaders.  Do not bother me again with your false desires to fight for true freedom."
	rebel_standard2_assign = "Ah, %NAME, my fellow freedom fighter.  My troops have need of more "
	      "equipment.  This war costs us much, and I do not have the luxury of a large treasury like "
	      "the other leaders do.  Bring me %INDEF_CARGO%CARGO and I will not forget your loyalty."
	rebel_standard2_success = "Ah, excellent.  I will definitely put this to good use."
	rebel_standard2_failure = "Subject: You are not a true rebel\n"
	      "You have failed me when I needed you most.  Go crawling to one of the other lieges, for "
	      "I have no more use of one such as you."

	disciple_trigger = "disciple"
        disciple_learn_success = "~ISo, you wish to become my disciple?~I"
	disciple_assign = "~IYou must prove yourself before your learning may progress.  Bring me %CARGO.~I"
	disciple_success = "~IYou have proven yourself, my disciple.  Your learning may now progress.~I"
	disciple_failure = "It appears you need more experience before you are ready to be my disciple.  You may try again another day."

   kraanandisciple_assign = "`B`bYou have two hours in which to kill a %MONSTER.  Go immediately.  "
         "Return and tell me when you are done."
   kraanandisciple_success = "`B`bYou have done well. You are a worthy follower.  Perhaps it is you who will crack "
         "the stone around Kraanan's soul.  Seek me when you wish to learn more of his ways and his spells."
   kraanandisciple_failure = "Subject: Your weakness of heart\n"
         "I lack faith in your ability to serve Kraanan.  We need those with determinination, focus and skill.  "
         "Return here only when these things are within you."

   shalilledisciple_trigger = "The ways of violence and destruction have hardened our people.  It is time to move "
         "towards gentleness and peace.  I will begin this process by granting forgiveness for your deeds.  Please "
         "accept my blessing."
   shalilledisciple_assign = "`bYou wish to learn more of the gentle, healing ways of our good Lady.  You must "
         "brave the temple of %NPC, and proclaim your willingness to forgive their violence and brutality. Heal "
         "them if you can.  Say, \"%CARGO\"  Then, return and tell me that you have done as I asked."
   shalilledisciple_success = "`bBlessed be this day. Today there is the birth of another soul filling with the "
         "light of Shal'ille.  Seek me when you are ready to learn more of the Blessed Mother's knowledge and "
         "spells.  You are worthy."
   shalilledisciple_failure = "Subject: Keep heart, child of Shal'ille\n"
         "Failure is part of life.  Search your heart and find the blemish.  Please return to me and then we "
         "will begin our journey down the road to harmony once again."

   farendisciple_trigger = "You have defiled the land with your ways.  The land gives life, yet you treat it "
         "as the enemy to be conquered.  You are fools, all, if you continue on this sacriligious path.  Embrace "
         "nature, do not spurn it like a forgotten lover.  Repent your ways.  Follow the words of Faren.  Live for "
         "nature, not in opposition to it."
   farendisciple_assign = "`B`gYou wish the blessing of the land through our Lord Faren.  You must prove that you "
         "are worthy of his blessings.  Take this message to %NPC: \"%CARGO\"  Return quick to notify me when you "
         "are done and perhaps Faren will favor you with power."
   farendisciple_success = "`B`gThe gaze of Faren is upon you. You have done well.  Seek me when you would learn "
         "more of his ways and his spells. "
   farendisciple_failure = "Subject: Look within and burn, child\n"
         "Faren does not see those without the fire of desire within them. You must return when you have "
         "found this inside yourself, not sooner."

   qordisciple_trigger = "In darkness all shall be bound.  Our Mistress would walk among men in the comfort "
         "of a lightless sky and a bloody moon."
   qordisciple_assign = "`rYou wish to be surrounded by the ineffable embrace of our patron Mistress.  "
         "Your judgement is keen but what of your loyalty?  To prove this to me you must invoke Mistress Qor to "
         "%NPC, thus:  %CARGO  After that, return and tell me you are done and we shall revel in the beauty of "
         "corruption."
   qordisciple_success = "`rYou have fulfilled my wishes. You are not only wise but tenacious.  Seek me out when you "
         "would learn more of Qor's spells of power."
   qordisciple_failure = "Subject: Qor has deemed you unworthy\n"
         "You weak, pathetic soul! It was just as I suspected. I am glad to have given you nothing of real value "
         "or it would surely be lost now.  If you come back here, perhaps I will allow you another chance to join "
         "the ranks of the elite."

   scimitarlearn_trigger = "pupil"
   scimitarlearn_assign_2 = "So you are a warrior? Ha! Don't look like much of a warrior to me.  Before I will "
         "spend my time teaching you the valuable ways of the scimitar, you must prove yourself by slaying "
         "%INDEF_MONSTER%MONSTER.  Do this and return to me. "
   scimitarlearn_failure_2 = "Subject: Learning to wield the scimitar\n"
         "Failure is part of learning.  Failure is crucial for a warrior.  You tried and that is important, "
         "but do not think for a second that I will teach you anything.  Now I must return to my work."
   scimitarlearn_assign_3 = "That took long enough.  I do not like to be kept waiting so long.  With this "
         "extra time I have decided that you must slay %INDEF_MONSTER%MONSTER now.  This time do not waste so many "
         "strokes with that...weapon.  Go now."
   scimitarlearn_failure_3 = "Subject: Learning to wield the scimitar\n"
         "Ah, well perhaps I have asked too much for one with little experience.  I have no time to tutor you "
         "in the basics of weaponry.  Come back when you have some more skill under your belt."
   scimitarlearn_assign_4 = "You again!  I thought the underworld had taken you.  What was it that I asked of "
         "you?  Oh yes, you were to slay %INDEF_MONSTER%MONSTER.  Go do that and I will teach you.  No arguing now.  "
         "Go now or we shall both grow old and die before you can learn the majesty of the scimitar.  Slay another "
         "%MONSTER."
   scimitarlearn_success_4 = "Finally.  The first thing I must teach you is to snap to it.  Come to me and we "
         "shall begin to learn how to effectively use the greatest weapon in the land: the scimitar."
   scimitarlearn_failure_4 = "Subject: Learning to wield the scimitar\n"
         "Your lack of skill and sheer sloth has cost you the opportunity to study with me.  A shame, you were "
         "so close.  Perhaps you were too long at your mother's breast.  Practice, novice, that is what you need."

   fadelearn_trigger = "pupil"
   fadelearn_assign_2 = "I am glad thou art here;  I am willing to make a trade.  I stumbled across a formula for "
         "speeding the growing process of certain plants, but it has fallen into the hands of the scoundrel %NPC.  "
         "I will teach thee the small magicks I know if thou wilt but retrieve this formula for me.  Do not let "
         "%HIMHER_NPC deceive thee, %NPC wishes nothing more than to selfishly delay my harvest."
   fadelearn_trigger_2 = "formula"
   fadelearn_failure_2 = "Subject: Plant growth formula\n"
         "The plants will now not be ready to harvest for one more month.  Thou hast failed me and cost the "
         "land a valuable antidote;  A pox on thee."
   fadelearn_assign_3 = "I have the formula of which you speak.  I am reluctant to give it to you, however, as I "
         "believe that Joguer's motives are not as noble as he claims.  If you prove to me your strength of purpose "
         "by slaying a %MONSTER, however, I will defer to your judgement.  Hurry now, else Joguer's lovely harvest "
         "of poison will be delayed!"
   fadelearn_failure_3 = "Subject:  You have chosen wisely\n"
         "I see you trust my judgement of Joguer.  I thought that your task might slow you up enough to force "
         "you to think the matter through.  Now we have prevented Joguer's premature harvest, and can rest "
         "knowing there will be no new poison in the land, at least for now."
   fadelearn_assign_4 = "Very well, here is the formula.  I am not happy to be giving you this.  I believe that you "
         "have disrupted an important course of events. But, that is not your concern really is it.  You just want "
         "to get your spell and be off.  Well, I suggest that you do just that."
   fadelearn_success_4 = "Ah, at last.  Thou hast done a great service not only to thyself but also to the entire "
         "realm.  These plants may change the course of history.  They are an antidote to a terrible disease that "
         "is beginning to spread through the land.  Come to me when thou would learn from me, friend."
   fadelearn_failure_4 = "Subject:  Plant growth formula\n"
         "Thy dallience hath cost not only to yourself the posssibility of learning my magicks, but also to "
         "the entire realm a chance to resist a new disease that is slowly spreading.  I hope thou dost not catch "
         "it thyself.  That would be a fine bit of justice, eh?  Trouble me no further, knave."

   dementlearn_trigger = "pupil"
   dementlearn_assign_2 = "I can teach you the little I know of the mystical arts, but I need a favor.  "
         "I urgently need to get this "
         "%CARGO to %NPC, but am reluctant to approach %HIMHER_NPC.  You see, %NPC is of late afflicted "
         "by some unwholesome force which seems to feed off human energy.  I know no more than to be in "
         "%NPC's presence is likely to have some terrible effect on you.  Make your meeting brief and "
         "perhaps you can avoid these effects."
   dementlearn_success_2 = "Thank you, %NAME.  I hope that this %CARGO will help me dispel the force of which you "
         "were warned.  Go now, unless you wish to be so afflicted as well."
   dementlearn_failure_2 = "Subject:  Delivery of the %CARGO\n"
         "I understand your aprehension and fear of approaching %NPC.  Nonetheless, you have failed and our deal "
         "is hereby nullified."
   dementlearn_success_3 = "Ah, you have returned from your errand, %NAME.  You have done well.  I hope you have "
         "not suffered too greatly from your contact with %SOURCE_NPC.  I understand the effects are only temporary.  "
         "Nevertheless, you have proved yourself worthy of my teachings.  Come back when you want to learn the "
         "\"dement\"spell ."
   dementlearn_failure_3 = "Subject:  Dement spell\n"
         "I haven't heard back from you in a while, so I assume you are no longer interested in learning it.  "
         "Come back later if you change your mind, friend."

   guildshield_intro = "I heard that %QBNPC wants someone to go on a mining expedition for %QBHIMHER_NPC, and "
         "that it may be of particular interest to your guild members.  You may want to send one of them to ask "
         "%QBHIMHER_NPC about it."
   guildshield_initial_trigger = "mining expedition"
   guildshield_assign = "Aye, someone eager to do this favor for me.  Undoubtedly you've heard that the orc mines "
         "have reopened.  Well, them orcs mine a strain of iron ore that's of a much higher grade than what we "
         "can get out of the stripped out Jasper mines.  I want to get my hands on some more of it before the "
         "Princess or Duke or whoever's running the show now closes them caves back up.  Bring me some ore, and "
         "I'll use the last of what I have now to make you a coat of arms."
   guildshield_success = "Ah, this will make for some fine weapons and armor!  Thank you greatly, %NAME.  "
         "In your absence, I have fashioned a shield which displays your guild's crest and colors.  "
         "Wear it forth proudly, you have done well for your guild this day."
   guildshield_failure = "Subject: Ore from the orc mines\n"
         "Never mind about the ore;  I've made other, more reliable, arrangements."

   lutequest_trigger_1 = "instrument"
   lutequest_assign_2 = "Of course you'll need an instrument to play.  I'll even help you get one.  "
         "Here's what you do:  %NPC can set you up with one, go to %HIMHER_NPC and say \"%CARGO\"."
   lutequest_trigger_2a = "Parrin sent me"
   lutequest_trigger_2b = "I need an instrument"
   lutequest_trigger_2c = "Parrin told me to see you about a lute"
   lutequest_trigger_2d = "Could I get that lute you are holding for Parrin"
   lutequest_trigger_2e = "Parrin says you have a lute for him"
   lutequest_failure_2 = "Subject: That lute you wanted\n"
         "It's too late, %NPC gave the lute to someone else.  If you're serious about learning to play, "
         "come back later and I might know where you can find another one."
   lutequest_assign_3 = "You are going to learn to play from Parrin?!  Good luck!  By the way, Parrin owes "
         "me a favor.  If you do something for me, I'll give you the lute;  I need this %CARGO rushed to %NPC.  "
         "It needs to be delivered within twenty minutes or I won't give you the instrument.  When you've "
         "done that, come back."
   lutequest_success_3 = "Ah, %NAME, I've been anxiously awaiting this %CARGO's arrival!  "
         "Thank you for your swift delivery."
   lutequest_failure_3 = "Subject: You missed your deadline\n"
         "You wasted too much time getting to %NPC.  Don't bother coming back for the lute.  Next time, I'll "
         "get a quicker messenger."
   lutequest_success_4 = "Thank you, here is the lute.  Please learn to play it well."
   lutequest_failure_4 = "Subject: You forgot to pick up your lute!\n"
         "%NPC tells me you were supposed to go back there to pick up your lute.  I think %NPC "
         "has already found someone else to whom to give the lute by now though.  Sorry for all the trouble you "
         "went to, but thanks again for making the delivery."

   truthquest_trigger_1 = "pupil"
   truthquest_trigger_2 = "sings"
   truthquest_assign_2 = "Are you truly ready to learn the magic of songs of Jala?  If so you must prove "
         "your devotion to the arts.  I would like you to try out your voice.  Go to %NPC and ~Ising~I a song.  "
         "Any song you wish.  Then come back to me and let me know how it went."
   truthquest_success_2 = "By my troth, that is awful.  Did Parrin send thee?  "
         "Tell him to train thy voice, %NAME"
   truthquest_failure_2 = "Subject: Your vocal audition\n"
         "If you are too shy to sing a simple song, then I'm afraid you will never make for a good minstrel.  "
         "I'm afraid I cannot teach you the spells of Jala at this time.\n\n-Parrin Aragone"
   truthquest_failure_3 = "Subject: Your vocal audition\n"
         "Where have you been?  I could not wait any longer for you.  I'm afraid I have taken on other students.  "
         "Perhaps, I will teach you at a later date.\n\n-Parrin Aragone"
   truthquest_trigger_4 = "bad"
   truthquest_assign_4 = "Ah, you have returned.  What did they think of your song?  Good or bad?"
   truthquest_success_4 = "Oh well, we shall work on that.  Now open your mind to the ways of Jala;  I shall "
         "train your voice, if you are willing."
   truthquest_failure_4 = "Subject: Your vocal audition\n"
         "You will have to be more honest with yourself about your ability if I am to teach you "
         "the ways of Jala."
   truthquest_trigger_5 = "good"
   truthquest_success_5 = "That would be a remarkable thing indeed, for a fledgling bard like yourself.  "
         "Are you being entirely honest with yourself, %NAME?"

   bonepriestessquest_trigger_1 = "riija"
   bonepriestessquest_assign_2 = "Wak-wak!  Hedd of Pit Boss!  Wak wak wa-ak!"
   bonepriestessquest_success_2 = "Chp chp chp chp chp chp chp!"
   bonepriestessquest_failure_2 = "Subject:  Ik ik ak\n"
         "Wak wak riija no ak!  Chp Chp kp ip!"

   madscientistquest_trigger_1 = "kohuzotz"
   madscientistquest_assign_2 = "I am always eager to experiment on my pets.  If you bring me a live specimen, "
         "I might have something interesting to give you in return."
   madscientistquest_success_2 = "Excellent.  Good work, fair apprentice."
   madscientistquest_failure_2 = "Subject: kohuzotz specimen\n"
         "You have taken so long to bring me a specimen that I have obtained one through other means.  "
         "I shall be busy with my fresh subject for a while, so don't bother bringing me another."

   tradingpost_trigger_1 = "inventory"
   tradingpost_assign_2 = "I'm always looking for people to help replenish my inventory.  If you'd be willing "
         "to bring me %INDEF_CARGO%CARGO, I can make it well worth your trip."
   tradingpost_success_2 = "Splendid.  Here, I don't need this."
   tradingpost_failure_2 = "Subject: Shipment of %CARGO\n"
         "Never mind, I've found another supplier."

   bowmaker_trigger_1 = "arrows"
   bowmaker_assign_2 = "I use special materials to make my best arrows.  The tailfeathers of an avar magician "
         "are reputed to offer magical properties to any arrow they fletch.  Go, see if you can find an avar "
         "willing to trade a tailfeather for something they find precious."
   bowmaker_success_2 = "Nyuk nyuk uk ak a-ak!"
   bowmaker_failure_2 = "Subject: Avar feather\n"
         "Clearly, you were unable to find an avar feather for me.  Ah, well.  I shall look elsewhere."
   bowmaker_success_3 = "Thanks.  Here, take this scrap of metal as your reward."
   bowmaker_assign_4 = "I use special materials to make my best arrows.  The tailfeathers of an avar magician "
         "are reputed to offer magical properties to any arrow they fletch.  Go, kill avar shamans until you "
         "find one which offers a suitably undamaged tailfeather."
   bowmaker_failure_4 = "Subject: Avar feather\n"
         "Clearly, you were unable get an avar feather for me.  I understand, avar shamans are formidable "
         "opponents.  If you wish, return later, perhaps I will need more."

   chickensoupquest_trigger_2 = "chicken soup"
   chickensoupquest_assign_2 = "I'm feeling a little sick.  I don't suppose you could go to the Widow Qesino "
         "and ask her for a bowl of her special chicken soup, could you?  I'd be most grateful."
   chickensoupquest_failure_2 = "Subject: Chicken soup\n"
         "Oh, well...  I guess you have better things to do than help me out.  That's ok, I'm getting over "
         "my cold anyway."
   chickensoupquest_assign_3 = "Oh, of course, dear!  Here's a bowl of my special soup for %NPC.  Wish %HIMHER_NPC "
         "well for me."
   chickensoupquest_success_3 = "Thanks so much, I feel better already just from smelling this delicious soup!  "
         "Here, take this %PRIZE as a token of my appreciation."
   chickensoupquest_failure_3 = "Subject: %NPC's cold\n"
         "You ate that bowl of soup yourself, didn't you?  Shame on you, now, %NAME!  %NPC is sick after all, "
         "poor dear."

   stunteddwarf_trigger = "stunted dwarf"
   stunteddwarf_assign_2 = "Hot day, eh.  Sure would be a great day for a stunted dwarf."
   stunteddwarf_assign_3 = "Ah, an ancient drink.  Actually, the recipe has been lost in time, although I hear "
         "that %NPC might know of it."
   stunteddwarf_trigger_4 = "myth"
   stunteddwarf_assign_4 = "Stunted dwarf?  Ha!  That’s just a myth, and you tell %HIMHER_NPC I said that!"
   stunteddwarf_success_4 = "Ah, well.  If you ever hear anyone mention a stunted dwarf, you be sure to find out "
         "what you can."
   stunteddwarf_assign_6 = "Ah, you need a recipe for your garden variety stunted dwarf, eh?  Tell you what.  "
         "Prove to me you’re hero enough to drink one, and I’ll give you the recipe.  Go kill a kriipa for me."
   stunteddwarf_success_6 = "Fine job, %NAME.  Take this recipe."
   stunteddwarf_failure_6 = "Subject: Stunted Dwarf\n"
         "I see you have wisely forgotten about having a stunted dwarf.  It is, after all, not a drink for the "
         "faint of heart or weak of stomach."
   stunteddwarf_success_7 = "How remarkable!  You must be a persistent one, %NAME.  I must give you something "
         "equally rare in return."

   hypochondriac_assign_2 = "Thank god you’re here!  I think I’m dying!  I’ve got %CARGO!  Go to %NPC and "
         "ask %HIMHER_NPC about a cure for it!"
   hypochondriac_trigger_2a = "paragolisys"
   hypochondriac_trigger_2b = "miriatetosis"
   hypochondriac_trigger_2c = "pelagalosilis"
   hypochondriac_trigger_2d = "the great fungus disease"
   hypochondriac_failure_2 = "Subject: %CARGO\n"
         "It's a good thing someone else came by and saved me from my ailment!  Surely you would have left me "
         "to slowly waste away into a painful, lingering death."
   hypochondriac_trigger_3 = "sacchaqua"
   hypochondriac_assign_3 = "Ah, he’s dying, eh?  Well, why don’t you go to %NPC and say that Frisconar "
         "needs another Sacchaqua potion."
   hypochondriac_failure_3 = "Subject: Frisconar's unending ailments\n"
         "Guess you gave up on old Frisconar.  I don't blame you, I don't have much patience for his fussing "
         "either."
   hypochondriac_assign_4 = "How very amusing.  You would think an accomplished Apothecary like Frisconar "
         "would know that this is nothing more than sugar water.  Well, take this to him."
   hypochondriac_success_4 = "Oh, thank the gods!  I ... I was seeing stars!  The light at the end of the tunnel!  "
         "I’m alive!  Here, take this %PRIZE - I owe it to you for saving my life!"
   hypochondriac_failure_4 = "Subject: O woe is me!\n"
         "Where have you been?!  I am finished now, for sure.  As I write this, my sight dims until I can barely "
         "see the paper before me.  My breath is short and causes me great pain.  My search for a cure to my "
         "illness must continue, though you have failed me.  I must pin my frail and tattered hopes to another, "
         "and hope that they will not let me down as you have.  Farewell, perhaps forever."

   qoroffering_assign_2 = "`r%NAME, dark devotee of our Mistress of the Bloody Moon, will you give of yourself "
         "so that your Mistress may be stronger?"
   qoroffering_trigger_2 = "yes"
   qoroffering_assign_3 = "`rWorship with me, then.  Together, we will draw upon our own life essence to birth "
         "a symbol of our Mistress' power.  Rarely are the stars so well aligned for the dark ritual we "
         "shall undertake, so we must speak quickly.  Incant these words with me: %CARGO"
   qoroffering_trigger_3 = "By the light of a bloody moon, I summon thee, Qor, Mistress of the Dark"
   qoroffering_failure_3 = "Subject: Fool!\n"
         "The window of time has passed, and now we have both suffered for your hesitation.  The ritual begun "
         "but left unfinished has drawn away a piece of our power.  I am not pleased with you, worm."
   qoroffering_assign_4 = "`r%CARGO!"
   qoroffering_success_5 = "`rAh, this is a great day for Qor!  Go now, carry forth the power of our Mistress "
         "into the world!"

   shalilleoffering_assign_2 = "`b%NAME, pure disciple of our Lady of the Silver Light, will you give of yourself "
         "so that your Goddess may be stronger?"
   shalilleoffering_trigger_2 = "yes"
   shalilleoffering_assign_3 = "`bWorship with me, then.  Together, we will draw upon our own life essence to birth "
         "a symbol of our Lady's purity.  Rarely are the stars so well aligned for the holy ceremony we "
         "shall undertake, so we must speak quickly.  Incant these words with me: %CARGO"
   shalilleoffering_trigger_3 = "By the light of a bright sun, we beseech thee, Shal'ille, rebirth us"
   shalilleoffering_failure_3 = "Subject: Alas\n"
         "This day we have not reached high enough, yet we have reached, and that is enough.  Today we are left "
         "weak and empty-handed, but when the time is right Shal'ille shall lift us, my disciple."
   shalilleoffering_assign_4 = "`b%CARGO!"
   shalilleoffering_success_5 = "`bPraise Shal'ille!  Go now, carry forth into the world this symbol of our "
         "Lady's purity of spirit!"

   farenoffering_assign_2 = "`B`g%NAME, child of our Mistress of the Wilds, will you give of yourself "
         "so that your Mother may be stronger?"
   farenoffering_trigger_2 = "yes"
   farenoffering_assign_3 = "`B`gWorship with me, then.  Together, we will draw upon our own life essence to form "
         "a symbol of the power of nature.  Rarely are the stars so well aligned for the ritual we "
         "shall undertake, so we must speak quickly.  Incant these words with me: %CARGO"
   farenoffering_trigger_3 = "By the earth, the winds, the seas, and the fire inside, I summon thee, Faren, Mistress of the Wilds"
   farenoffering_failure_3 = "Subject: The stars were off\n"
         "I miscalculated the positioning of various forces;  the time was not right to manifest Faren's power.  "
         "Perhaps another time, when the celestial clocks tick around once more."
   farenoffering_assign_4 = "`B`g%CARGO!"
   farenoffering_success_5 = "`B`gBehold, the Turbulence of Nature manifest!  Go now, carry forth the power of our "
         "Mistress into the world!"

   kraananoffering_assign_2 = "`B`b%NAME, heroic champion of the Fist, will you give of yourself "
         "so that your Lord may be stronger?"
   kraananoffering_trigger_2 = "yes"
   kraananoffering_assign_3 = "`B`bWorship with me, then.  Together, we will draw upon our own life essence to forge "
         "a symbol of our Lord's power.  Rarely are the stars so well aligned for the ancient ceremony we "
         "shall undertake, so we must speak quickly.  Incant these words with me: %CARGO"
   kraananoffering_trigger_3 = "By the spark of steel against steel, I summon thee, Kraanan the Fist"
   kraananoffering_failure_3 = "Subject: You must strengthen thyself!\n"
         "The window of time has passed, and now we have both suffered for your hesitation.  The ritual begun "
         "but left unfinished has drawn away a piece of our power.  You were weaker than I had hoped;  Fortify "
         "thy spirit, and perhaps another day we shall be successful."
   kraananoffering_assign_4 = "`B`b%CARGO!"
   kraananoffering_success_5 = "`B`bAh, this is a great day for Kraanan!  Go now, carry forth the strength of our Lord "
         "into the world!"

   riijaoffering_assign_2 = "%NAME, Lord Fool wishes to fortify you.  Will you chant with me?"
   riijaoffering_trigger_2 = "yes"
   riijaoffering_assign_3 = "Incant these words with me: %CARGO.  Feel your power grow with every word spoken."
   riijaoffering_trigger_3 = "Your words speak wisdom through me, Lord Riija"
   riijaoffering_failure_3 = "Subject: Fool!\n"
         "He who stands at the edge of a cliff yet walks blithely on is both God and Fool.  Walk on, servant of "
         "seeming."
   riijaoffering_assign_4 = "%CARGO!"
   riijaoffering_success_5 = "Behold, the double-edged blessing of Riija.  Bear it forth into the world and reap "
         "the chaos it sows!  Remember these ancient words of wisdom:  this is really going to hurt in the morning."

   sporeburstlearn_assign_2 = "Oh, %LORDLADY %NAME, it is ~Iindeed~I a pleasure to see you.  I have watched your progress "
         "in the arcane studies with great interest;  rarely have I encountered one so worthy of my tutelage.  You "
         "may know of my research in the magical arts.  Well, I have at last crafted an entirely new spell, "
         "grafted together from the energy fields of what the religious rabble would call Faren and Qor.  I will "
         "teach you my new incantation, if you but perform one small task for me:  bring me %INDEF_CARGO%CARGO, "
         "that I may research its mystical properties."
   sporeburstlearn_assign_2_h = "Oh, %LORDLADY %NAME, it is ~Iindeed~I a pleasure to see you.  I have watched your progress "
         "in the arcane studies with great interest;  rarely have I encountered one so worthy of my tutelage.  You "
         "may know of my research in the magical arts.  Well, I have at last crafted an entirely new spell.  "
         "I will "
         "teach you my new incantation, if you but perform one small task for me:  bring me %INDEF_CARGO%CARGO, "
         "that I may research its mystical properties."
   sporeburstlearn_failure_2 = "Subject:  Weak fool!\n"
         "I misjudged you, %NAME.  I believed you were capable of great things, heights of power unachieved even "
         "by the Necromancers of antiquity.  I see now that I was wrong."
   sporeburstlearn_success_2 = "You are a worthy pupil, indeed, %NAME.  Ah, %INDEF_CARGO%CARGO!  Can you ~Ifeel~I its "
         "magical essence, coming off it in waves?  The power contained herein is far beyond the trivial "
         "religious significance those parlor priests attach to it.  This is the stuff of which the universe "
         "is fashioned! ..."
   sporeburstlearn_assign_3 = "Ah yes, the spell, the spell.  Sporeburst!  Now bring me %INDEF_CARGO%CARGO, and I "
         "shall teach you that, and more - I have recently discovered another intriguing spell as well."
   sporeburstlearn_assign_3_h = "Ah yes, the spell, the spell.  Curse weapon!  Now bring me %INDEF_CARGO%CARGO, and I "
         "shall teach you."
   sporeburstlearn_success_3 = "It has been many moons since %INDEF_CARGO%CARGO last touched my lips.  Would you "
         "care for a sip?  It's ~Iquite~I refreshing.  Well, return when you wish to learn the sporeburst spell, and "
         "we'll have a little toast - ~ITo the foolish masses, who offer up their feeble bodies of blood and bone to "
         "be swallowed by silent stones or jigging delusory puppet-gods.~I"
   sporeburstlearn_success_3_h = "It has been many moons since %INDEF_CARGO%CARGO last touched my lips.  Would you "
         "care for a sip?  It's ~Iquite~I refreshing.  Well, return when you wish to learn the curse weapon spell, and "
         "we'll have a little toast - ~ITo the foolish masses, who offer up their feeble bodies of blood and bone to "
         "be swallowed by silent stones or jigging delusory puppet-gods.~I"

   polishquest_assign = "Excuse me.  I’ve been honing my jewelling skills, and I was wondering if you have any "
         "uncut gems of any sort.  If you do, I’d be happy to polish them and give you one of the result."
   polishquest_success = "Ah, thank you.  Allow me to reward you."
   polishquest_failure = "Subject:  Gem polishing\n"
         "Never mind about the uncut gems, I found some from someone else.  Thanks, though."

   priestessinsignia_trigger = "insignia"
   priestessinsignia_assign_2 = "~II see you have an unmarked shield.  I am more than willing to offer my insignia "
         "to a brave mage, provided they offer me a tithe.~I"
   priestessinsignia_trigger_2 = "tithe"
   priestessinsignia_assign_3 = "~II have heard about a passage to another world opening up.  I am interested in "
         "the magical reagents from that land - perhaps their emergence will result in the strengthening of magic "
         "for faithmages like you and I.  Go and find me %CARGO.~I"
   priestessinsignia_success_3 = "~IExcellent.  The Eternal thank you for your benevolence.~I"
   priestessinsignia_failure_3 = "Subject: Insignia\n"
         "I had thought so much better of you.  Oh, well.  I shall watch for a better crusader in the future."

   monkinsignia_trigger = "insignia"
   monkinsignia_assign_2 = "~gI ~rsee ~byou have ~ran ~gun~bmarked ~kshield.  ~rI am more ~bthan ~gwilling ~bto ~goffer ~bmy ~rinsignia "
         "to a brave ~gt~br~ki~bc~rk~ks~gt~be~kr,~r provided they offer ~b~Bme~B~r a tithe.~k"
   monkinsignia_trigger_2 = "tithe"
   monkinsignia_assign_3 = "~II have heard about a `gpassage `kto another world opening up.  `bI `kam interested in "
         "the magical `rreagents `kfrom that land - perhaps `gtheir emergence `kwill result in the `rstrengthening`g of`b magic "
         "`kfor faithmages like you and I.  ~rGo and find ~bme %CARGO."
   monkinsignia_success_3 = "~B~bEx~rcell~gent.  ~kThe Trickster ~rthanks~k you for your benevolence.~B"
   monkinsignia_failure_3 = "Subject: Insignia\n"
         "I had thought so much better of you.  Oh, well.  I shall watch for a better fool in the future."

   factioninsignia_trigger = "insignia"
   factioninsignia_assign_2 = "I see you have a shield with colors, but no insignia.  If you would care to earn "
         "mine, I have a mission for you."
   factioninsignia_trigger_2 = "mission"
   factioninsignia_assign_3 = "In the midst of this political chaos, subjects openly consort against me.  "
         "Fortunately, I have spies in place which keep an eye on their connivings.  Reportedly, %NPC "
         "has been conferring with %CARGO, and I am naturally quite intrigued by whatever they talked about.  "
         "Do me a favor, mention that person’s name to our friend %NPC, and repeat for me word for "
         "word what is told to you."
   factioninsignia_trigger_3a = "Esseldi"
   factioninsignia_trigger_3b = "Drechx"
   factioninsignia_trigger_3c = "Bei Naq"
   factioninsignia_trigger_3d = "Cylill"
   factioninsignia_trigger_3e = "Alzahakar"
   factioninsignia_trigger_3f = "Priestess Qerti'nya"
   factioninsignia_trigger_3g = "Priestess Xiana"
   factioninsignia_trigger_3h = "Jonas d’Accor"
   factioninsignia_failure_3 = "Subject: Insignia mission\n"
         "My disappointment is profound.  I had thought that certainly, you would be more reliable than the "
         "common thugs and unreliable swine that make up my spy network.  Apparently, you are below them."
   factioninsignia_assign_4 = "%CARGO."
   factioninsignia_trigger_4a = "Uh... I don’t really know what you're talking about"
   factioninsignia_trigger_4b = "An outstanding citizen.  It's been a while since we last had a good talk"
   factioninsignia_trigger_4c = "Ah, yes!  We were just chatting about what a fine job the Princess is doing"
   factioninsignia_trigger_4d = "Ah, yes!  We were just chatting about what a fine job the Duke is doing"
   factioninsignia_trigger_4e = "That jerk took everything I owned in a game of Zoxila just last week"
   factioninsignia_trigger_4f = "Who?  The name doesn't sound familiar"
   factioninsignia_success_4 = "Hmmm, fascinating.  I will have my spies scry further, but your information has "
         "provided the insight that I required.  Here, please accept my insignia as a token of my appreciation."
   factioninsignia_failure_4 = "Subject: Insignia mission\n"
         "I'm afraid you've failed the little test your leige and I concocted.  As we had expected, your "
         "loyalty is questionable."

   mysterymonster_assign_2 = "Wouldst thou do something for me?  I will reward thee.  I have insect troubles, "
         "it is so, indeed."
   mysterymonster_trigger_2 = "insect"
   mysterymonster_assign_3 = "Verily, some large insect was nesting in my storage area for a while.  I managed to "
         "force it out by building a small fire and blowing smoke inside.  When the smoke cleared I sought out "
         "my special stash of dress patterns, and one was missing!"
   mysterymonster_trigger_3 = "pattern"
   mysterymonster_assign_4 = "I ~Ineed~I that pattern back, and I'll wager it is still stuck to that insect's "
         "carapace.  Could thou get it back for me?  The problem is, with all that smoke I could see not when it "
         "ran off quite what kind of bug it was.  It can not be too far away, though."
   mysterymonster_success_4 = "Bless thee, child!  Here, this robe is from one of my other special patterns.  "
         "It has a very ancient design indeed.  Wear it well, friend."
   mysterymonster_failure_4 = "Subject: Missing dress pattern\n"
         "I found another copy of the missing dress pattern, so nevermind about the one I lost.  I thank thee "
         "for trying, though."

   moxalscam1_assign_2 = "Ah, friend and fellow dreamer!  I think I have found the perfect opportunity for us!  "
         "It can’t fail!  Surely you want to hear more about this golden opportunity!"
   moxalscam1_trigger_2 = "opportunity"
   moxalscam1_assign_3 = "Simple!  Just take this letter to %NPC.  "
         "Before you know it, the cash will start rolling in!"
   moxalscam1_failure_3 = "Subject: My wayward partner!\n"
         "I guess you're not serious about making money...  That's too bad.  Come back when you really feel, "
         "deep in your heart, that it's time to be rich!"
   moxalscam1_assign_4 = "Hmmm...  According to this, we're supposed to pass the letter on to someone else, "
         "then we both get rich.  Ok, why don't you take it to %NPC."
   moxalscam1_failure_4 = "Subject: Where's my money?!?!\n"
         "You promised me shillings, and lots of them!  Where are they?  You kept them for yourself, didn't you?  "
         "I won't forget your treachery...  Watch your back, thief."
   moxalscam1_success_5 = "Hmmm...  Apparently, this person thinks I’m a complete idiot.  I’m somewhat surprised "
         "that YOU fell for it.  Ah well, since you went to all this trouble, let me give you a little something.  "
         "Here."

   moxalscam2_assign_2 = "Early last week I had a great idea, and I’ve been trying to convince %NPC to help me "
         "finance it.  Look, if you convince %HIMHER_NPC, I’ll split the returns with both of you 50/50/50."
   moxalscam2_failure = "Subject: My wayward partner!\n"
         "Well, sheesh!  You didn't have to help me, but you said you would...  I mean no one was twisting "
         "your arm, right?  Well, come back when your gut tells you it's time to make some serious shillings."
   moxalscam2_assign_3 = "Oh, Riija, let me guess.  Moxal sent you.  "
         "Well, tell him, AGAIN, that I’m not interested."
   moxalscam2_trigger_3 = "not interested"
   moxalscam2_assign_4 = "Now, now, now.  Maybe you didn’t try hard enough.  Try again, and be sure to remind "
         "%HIMHER_NPC about the tenfold - no, HUNDREDFOLD - return."
   moxalscam2_assign_5 = "SHEESH, WHAT IS IT WITH YOU PEOPLE?  Look, Moxal is either a pie-eyed fool or a total "
         "thief, I haven’t figured out which, but only a total idiot would give him money.  "
         "Tell him I’m NOT INTERESTED."
   moxalscam2_success_5 = "*-sigh-*  Ah, well, %SOURCE_NPC was not of strong enough stomach, I guess.  "
         "I don’t suppose YOU have 100,000 shillings to invest in a moderately risky venture?"

   letter_trigger = "need a courier"
   council_letter_assign = "Why yes I do.  Take this letter to the councilor %NPC as fast as possible.  "
         "He will pay for the service."
   council_letter_success = "I’ve been expecting this letter.  Thank you, %NAME.  Here is your fee."
   council_letter_failure = "Subject:  The letter I entrusted to you\n"
         "%NPC did not get my letter in time.  I shall find another courier in the future."

   chess_assign_2 = "I'm playing a game of chess with a friend, would you be willing to courier "
         "my next move to my opponent?"
   chess_trigger = "yes"
   chess_assign_3 = "Wonderful!  Please tell %NPC that my next move is %CARGO."
   chess_assign_4 = "An interesting ploy, but easily countered.  Tell %NPC that my move is %CARGO."
   chess_success_4 = "Very clever!  I'll have to think a bit before I respond.  Thank you for helping "
         "us conduct our game, here's a little something for your trouble."
   chess_failure = "Subject:  My chess move\n"
         "Never mind about delivering my move;  I've found another courier."

   chess_checkmate_assign_5 = "Ha!  %NPC fell right into my trap!  Tell %HIMHER_NPC that my next move "
         "is %CARGO.  Oh, and tell %HIMHER_NPC that's checkmate."
   chess_checkmate_success_5 = "Oh.  Yes, I should have seen that.  Ah, well.  Thank you for serving as "
         "our courier.  By the terms of my agreement with %SOURCE_NPC, I must cover the courier fees for the "
         "game.  Please take this as a reward for your trouble."

   love_letter_1_assign = "Yes, actually, I have %INDEF_CARGO%CARGO for my darling %NPC.  Please take it to her, "
         "and send her my love.  Tell her that I miss her, won't you?  And that I long for the moment when next "
         "we meet.  Go now, quickly, lest she think that my love for her is fleeting and fickle."
   love_letter_1_success = "Ah, another letter from %SOURCE_NPC.  How wonderful.  Please take this for thy "
         "trouble."
   love_letter_failure = "Subject:  Thou didst not deliver my letter!\n"
         "Thanks to thy negligence, my darling %NPC must think that I no longer care for %HIMHER_NPC.  In the future I "
         "shall endeavor to choose a more reliable courier!"

   love_letter_2_assign = "Yes, actually, I have a missive in need of delivery.  If thou wouldst give this letter "
         "to %NPC I would be most grateful."  
   love_letter_2_success = "Ah, a letter from my fair %SOURCE_NPC!  It warms my heart to know that she is thinking "
         "of me.  Please take this as a token of my thanks."

   necroguild_assign_2 = "I crave to return to your plane of existence, my dark child.  Wilt thou help "
      "me to rise again?"
   necroguild_trigger_2 = "yes"
   necroguild_assign_3 = "Excellent.  My soul craves the blood of the innocent.  Bring me this, that I might "
      "rule Meridian once again!"
   necroguild_failure_3 = "Subject: you have failed.\n"
      "You have failed me.  I shall seek another to bring me back into this world."
   necroguild_success_3 = "Ah!  LIFE!!  I, along with my dark Order of Necromancers, have been reborn!  "
      "For your faithful service to me, I appoint you Master of the Order."
      
   aphrodesiac_assign_2 = "Yes, I desperately need a courier!  I will try to put this delicately.  "
      "I am having... uh... problems with... well, man problems.  I am told that %NPC knows of a powerful "
      "aphrodesiac.  Please, make haste and ask %HIMHER_NPC of it."
   aphrodesiac_failure_2 = "Subject: Your errand\n"
      "I suppose you have forsaken me.  I shall seek another to fulfill my quest."
   aphrodesiac_trigger_2 = "aphrodesiac"
   aphrodesiac_assign_3 = "Yes, I know of a powerful aphrodesiac:  the egg of a queen spider.  Fetch me "
      "one, and I shall prepare a potion for her."
   aphrodesiac_failure_3 = "Subject: The spider egg\n"
      "I suppose you were unable to find a spider egg.  Very well, I shall find one myself and deliver "
      "the potion.  Do not trouble yourself about it."
   aphrodesiac_assign_4 = "A fine specimen!  Deliver this potion to %NPC.  I am sure she will be pleased "
      "with the results."
   aphrodesiac_failure_4 = "Subject: The aphrodesiac potion\n"
      "I suppose you decided to use that potion for your own purposes.  May it serve you well."
   aphrodesiac_success_4 = "You are my savior, %NAME.  Bless you.  Here, take this as a token of my thanks."

   necrowarning_assign_2 = "Yes, I have need of a messenger.  It would seem we have a new power in the land, "
      "or rather a very old power, full of darkness.  Perhaps those fools in the temples will finally get what "
      "they deserve for their arrogance.  How could they possibly think that their gods are the only gods?  "
      "Hopefully this letter will help speed the inevitable along.  Take it to %NPC and return to me for your..."
      " reward.  Fail me and you will suffer."
   necrowarning_success_2 = "You have been the tool of an unsound person.  I expect this from him, but there is "
      "no excuse for your depravity.  Can you not find a better sponsor for your enthusiasm?  Well, perhaps not."
   necrowarning_failure_2 = "Subject: My letter\n"
      "So you would trifle with me.  Your insolence is either the act of a fool or the act of a coward.  "
      "Either way you should hope we do not meet again.  Please accept this curse as a token of my displeasure."
   necrowarning_success_3 = "I suppose you have returned to collect your reward.  In truth, your reward is the "
      "knowledge of the message you delivered, but... I understand your peoples desire for payment of a "
      "more material sort so here it is."

   barrestock_assign_2 = "Yes, I'm running very low on supplies.  %NPC knows what I need and its already paid "
      "for.  Just ask %HIMHER_NPC about the shipment, and make haste!"
   barrestock_trigger_2 = "shipment"
   barrestock_failure_2 = "Subject: my shipment of supplies\n"
      "Nevermind about the shipment.  I shall find another courier."
   barrestock_assign_3 = "Ah yes, the shipment is ready for delivery.  Make haste with these %INDEF_CARGO%CARGO "
      "back to %NPC, and no dishonesty now, or I shall have to report you to the justicar as an outlaw."
   barrestock_assign_3_h = "Ah yes, the shipment is ready for delivery.  Make haste with these %INDEF_CARGO%CARGO "
      "back to %NPC, and no dishonesty now, or your misdeeds shall surely haunt you."
   barrestock_success_3 = "Thank you, %NAME, you have done me a great service this day.  Take this small token "
      "of my thanks."
   barrestock_failure_3 = "Subject: Thief!\n"
      "I have reported your theft of %CARGO to the justicar, and henceforth you are to be considered an outlaw."
   barrestock_failure_3_h = "Subject: Thief!\n"
      "I have reported your theft of %CARGO to a wizard friend of mine, and he has ensured that you will suffer for your dishonesty."

   catering_assign_2 = "Perhaps you can help me.  I am having a private party and my errand boy has become ill.  "
      "will you help me by delivering the food?  %NPC is catering the party and knows where the food needs to go, "
      "just ask %HIMHER_NPC about the catering assignment.  "
      "You will be amply rewarded when you have completed the delivery.  Please hurry."
   catering_failure_2 = "Subject: Catering\n"
      "I have found another errand boy."
   catering_trigger_2 = "catering"
   catering_assign_3 = "Yes, the party!  I was worried no one would show up!  Here is the food, %INDEF_CARGO%CARGO.  "
      "Please take it to %NPC, setting up the party preparations is up to %HIMHER_NPC.  Please don't lose track "
      "of the food, this business is very important to me.  Should the delivery never reach %NPC, "
      "I will be forced to inform the justicar of your theft.  I'm sure this won't be necessary, though."
   catering_assign_3_h = "Yes, the party!  I was worried no one would show up!  Here is the food, %INDEF_CARGO%CARGO.  "
      "Please take it to %NPC, setting up the party preparations is up to %HIMHER_NPC.  Please don't lose track "
      "of the food, this business is very important to me.  Should the delivery never reach %NPC, "
      "I will be forced to speak to a wizard friend of mine.  I'm sure this won't be necessary, though."
   catering_failure_3 = "Subject: you stole the food for the party!\n"
      "I have reported you to the justicar, and henceforth you are to be considered an outlaw."
   catering_failure_3_h = "Subject: you stole the food for the party!\n"
      "I have spoken to a wizard friend of mine, and he has ensured that you will suffer for your dishonesty."
   catering_success_3 = "Ah, what a mouthwatering spread!  Here is your comission, I thank you for your speed."

   apothecary_assign_2 = "%NPC has need of these %INDEF_CARGO%CARGO, please take them to %HIMHER_NPC.  "
      "Thievery of any of the items will result in your being labelled an outlaw.  "
      "I have made arrangements for %NPC to pay you for your time.  "
      "You have one Meridian day in which to deliver these items."
   apothecary_assign_2_h = "%NPC has need of these %INDEF_CARGO%CARGO, please take them to %HIMHER_NPC.  "
      "Thievery of any of the items will result in grave misfortune.  "
      "I have made arrangements for %NPC to pay you for your time.  "
      "You have one Meridian day in which to deliver these items."
   apothecary_success_2 = "Thank you for your prompt delivery.  Business has been booming lately!  "
      "I wonder why?  Oh well, here is your pay.  Perhaps stop back later if you are interested in "
      "performing this service again.  You have helped relations between myself and %SOURCE_NPC."
   apothecary_failure_2 = "Subject: Thief!\n"
      "Your thievery of %INDEF_CARGO%CARGO has labelled you an outlaw."
   apothecary_failure_2_h = "Subject: Thief!\n"
      "Your thievery of %INDEF_CARGO%CARGO has forced me to have a curse placed upon you.  Wear it well."

   ore_assign_2 = "%NPC has run out of ore.  Take this ore to %HIMHER_NPC, and quickly.  "
      "It would be unwise to betray me.  Theft will be reported and you will thenceforth be deemed an outlaw.  "
      "Please hurry.  %NPC will pay you for your troubles."
   ore_assign_2_h = "%NPC has run out of ore.  Take this ore to %HIMHER_NPC, and quickly.  "
      "It would be unwise to betray me.  Theft will result in misfortune for us both.  "
      "Please hurry.  %NPC will pay you for your troubles."
   ore_success_2 = "Thank you for the ore.  Here is your reward.  Perhaps we can do business again."
   ore_failure_2 = "Subject: Thief!\n"
      "Your theft of the ore has been reported.  You have been deemed an outlaw and will need to contact "
      "the authorities to rectify this matter."
   ore_failure_2_h = "Subject: Thief!\n"
      "Your theft of the ore has been reported.  I have spoken to a wizard friend of mine, and "
      "he has ensured that you will suffer for your dishonesty."
      

   vaulttax_assign_2 = "Yes, I have need of a courier.  %NPC is due a certain percentage of profits from my "
      "business.  Please take this tithe of %INDEF_CARGO%CARGO to %HIMHER_NPC quickly.  I am too busy to do it myself.  "
      "Be warned that any thievery will be reported and you will be labeled an outlaw.  Perhaps worse, I hear "
      "that %NPC now keeps company with a wizard.  I have arranged for %NPC to pay you for your troubles."
   vaulttax_assign_2_h = "Yes, I have need of a courier.  %NPC is due a certain percentage of profits from my "
      "business.  Please take this tithe of %INDEF_CARGO%CARGO to %HIMHER_NPC quickly.  I am too busy to do it myself.  "
      "Be warned that any thievery will be reported and I hear "
      "that %NPC now keeps company with a wizard.  I have arranged for %NPC to pay you for your troubles."
   vaulttax_success_2 = "Ah, I see %SOURCE_NPC is on time this week.  Thank you for your swiftness and honor.   "
      "%SOURCE_NPC could use you around more often."
   vaulttax_failure_2 = "Subject: Thief!\n"
      "Your thievery of %CARGO has made you an outlaw by decree of %NPC."
   vaulttax_failure_2_h = "Subject: Thief!\n"
      "I have spoken to a wizard friend of mine, and he has ensured that you will suffer for your dishonesty."

   merchanttax_assign_2 = "Will you take my taxes to %NPC?  I am certain I am late this time and need you "
      "to take these %INDEF_CARGO%CARGO to %NPC.  Thievery will brand you an outlaw quickly so think not about "
      "deception.  I have arranged for your fee to be paid by %HIMHER_NPC."
   merchanttax_assign_2_h = "Will you take my taxes to %NPC?  I am certain I am late this time and need you "
      "to take these %INDEF_CARGO%CARGO to %NPC.  Thievery will result in misfortune so think not about "
      "deception.  I have arranged for your fee to be paid by %HIMHER_NPC."
   merchanttax_success_2 = "Ah, I was wondering when %SOURCE_NPC was going to pay me a visit.  "
      "Here is your payment for your... speedy service.   "
   merchanttax_failure_2 = "Subject: Thief!\n"
      "Your thievery of %CARGO has made you an outlaw by decree of %NPC."

   latetax_assign_2 = "A matter of urgency has been brought to my attention.  Certain property and business "
      "owners in the community have been remiss in their financial obligations to me.  Will you please take "
      "this letter to %NPC immediately.  Be warned that this letter is the property of the realm and failure "
      "to deliver it in a timely fashion will brand you an outlaw.  Here is something for your troubles.  "
      "Now make haste."
   latetax_assign_2_h = "A matter of urgency has been brought to my attention.  Certain property and business "
      "owners in the community have been remiss in their financial obligations to me.  Will you please take "
      "this letter to %NPC immediately.  Be warned that this letter is the property of the realm and failure "
      "to deliver it in a timely fashion will most certainly result in much suffering for you.  "
      "Here is something for your troubles.  Now make haste."
   latetax_success_2 = "What's this?  You know, it is strange how strict %SOURCE_NPC has become about collecting "
      "taxes.  I suspect there is more to this than meets the eye.  I have my suspicions but they are of no "
      "concern to you."
   latetax_failure_2 = "Subject: You are now an outlaw\n"
      "You have been branded an outlaw for failure to deliver a government issued letter to %NPC."
   latetax_failure_2_h = "Subject: You will now suffer, thief\n"
      "I have spoken to a wizard friend of mine, and he has ensured that you will suffer for your dishonesty."

   kocweapon_assign_2 = "I need a guaranteed delivery made to the mainland.  It's government business, so "
      "failure to deliver it would result in outlaw status.  Are you willing to accept these terms?"
   kocweapon_assign_2_h = "I need a guaranteed delivery made to the mainland.  It's government business, so "
      "failure to deliver it would result in misfortune.  Are you willing to accept these terms?"
   kocweapon_failure_2 = "Subject: I shall seek another courier\n"
      "I understand your reluctance to commit yourself to such a long journey.  Thank you anyway."
   kocweapon_assign_3 = "%NPC has requested my services for %HIMHER_NPC to supply the faction's troops, but "
      "unfortunately I have no one to take the supplies to %HIMHER_NPC.  Here are the %INDEF_CARGO%CARGO to "
      "be delivered;  I am sure that %NPC "
      "will pay your for your troubles.  Remember that you are bound by law to deliver the supplies, and  "
      "failure to deliver them will result in your being branded an outlaw.  For some reason I trust you, though."
   kocweapon_assign_3_h = "%NPC has requested my services for %HIMHER_NPC to supply the faction's troops, but "
      "unfortunately I have no one to take the supplies to %HIMHER_NPC.  Here are the %INDEF_CARGO%CARGO to "
      "be delivered;  I am sure that %NPC "
      "will pay your for your troubles.  Remember that you are bound by law to deliver the supplies, and  "
      "failure to deliver them will result in misfortune.  For some reason I trust you, though."
   kocweapon_failure_3 = "Subject: Thief!\n"
      "Your thievery has made you an outlaw by decree of %NPC."
   kocweapon_failure_3_h = "Subject: Thief!\n"
      "The bad luck brought on by your evil deed shall now follow you wherever you go."
   kocweapon_success_3 = "Thank you.  This is but the first delivery of many.  "
      "May it foster good trade relations for years to come.  Here, please take %INDEF_CARGO%CARGO."

   kocale_assign_2 = "I need a guaranteed delivery made to the island.  "
      "Failure to deliver it would result in outlaw status.  Are you willing to accept these terms?"
   kocale_assign_2_h = "I need a guaranteed delivery made to the island.  "
      "Failure to deliver it would be very unfortunate for you.  Are you willing to accept these terms?"
   kocale_failure_2 = "Subject: I shall seek another courier\n"
      "I understand your reluctance to commit yourself to such a long journey.  Thank you anyway."
   kocale_assign_3 = "%NPC in Kocatan has asked for supplies of our brew for his customers on the other side.  "
      "Please take these %INDEF_CARGO%CARGO to %HIMHER_NPC.  I have arranged for %npc to pay you for the journey.  "
      "Do not steal my goods.  Not only will it brand you an outlaw but I also have a friend, a wizard, "
      "very proficient in curses.  But let us not dwell on the seedier side of life.  "
      "This could be the beginning of something very profitable for all involved, my friend!"
   kocale_assign_3_h = "%NPC in Kocatan has asked for supplies of our brew for his customers on the other side.  "
      "Please take these %INDEF_CARGO%CARGO to %HIMHER_NPC.  I have arranged for %npc to pay you for the journey.  "
      "Do not steal my goods;  I have a friend, a wizard, "
      "very proficient in curses.  But let us not dwell on the seedier side of life.  "
      "This could be the beginning of something very profitable for all involved, my friend!"
   kocale_failure_3 = "Subject: Thief!\n"
      "Your thievery has made you an outlaw by decree of the Duke."
   kocale_failure_3_h = "Subject: Thief!\n"
      "The bad luck brought on by your evil deed shall now follow you wherever you go."
   kocale_success_3 = "I see %SOURCE_NPC has kept his word.  This is very good.  "
      "I am sure that this is the beginning of a mutually beneficial relationship.  "
      "Here is a token of my gratitude."

   necrowarning2_assign_2 = "I have news of great urgency.  My travels have taken me to many places and I "
      "have seen many strange things but none so dangerous as these vile necromancers.  Please take this "
      "letter to %NPC, and quickly.  It is my belief that these creatures threaten all of "
      "Meridian.   They come from a power older than our gods, though these forces may be linked on some "
      "level."
   necrowarning2_success_2 = "You bring me the rantings of a poor soul with a pitifully addled brain?  "
      "I have more important concerns at this moment.  Leave my presence, as I have nothing to say to you."
   necrowarning2_failure_2 = "Subject: My letter\n"
      "You have failed your friends and the folk of Meridian for ages to come.  They are doomed to an "
      "existence beseiged by dreadful malice and you choose not to give them a warning?  Your failure will "
      "cost lives.  I hope you can live with that."
   necrowarning2_success_3 = "She listens not, but no matter.  She has been warned.  Thank you, brave soul.  "
      "Take this as your material reward for your service to the people of Meridian."

   warletter_trigger1 = "need a courier"
   warletter_assign = "Ah, yes!  I have just written this letter to %NPC.  Please deliver it to %HIMHER_NPC.  "
      "I suggest you hire a guard because it may be dangerous.  I'm sure the reward will be enough for you and "
      "a guard."
   warletter_success = "Why, thank you!  I wasn't expecting a letter from %SOURCE_NPC, but it is welcomed.  "
      "Please take this as a token of my appreciation."
   warletter_failure = "Subject: My letter?\n"
      "I have heard from a reliable source that you not only did you fail to deliver my letter, but that you "
      "opened it and read it!  How dare you!  Next time I'll report you to the Justicar."


   identify_trigger = "need a courier"
   potion_identify_assign_1 = \
      "As a matter of fact, yes!  I recently received this potion.  I tried to identify it magically, but it "
      "seems to repel my efforts.  Could you take it to %NPC and ask %HIMHER_NPC if it can be identified?  "
      "Come back with the knowledge of what it is and I'll reward you."
   potion_identify_assign_2 = \
      "Hmmm, a most interesting specimen.  Let me just take a few drops for analysis...  "
      "Ah yes, this appears to be a %CARGO.  Let me put a label on it so that %NPC "
      "will know what it is."
   potion_identify_success = \
      "Excellent, I'm sure I'll be able to find a good use for a %CARGO.  Here, please take this in payment."
   potion_identify_failure_1 = "Subject: That strange potion\n"
      "Did you get lost?  Don't worry, that happens often to people that are new to the area.  The potion "
      "probably was not very important anyway.  I might have other jobs for you if you visit again in the "
      "future.  Take care!"
   potion_identify_failure_2 = "Subject: That strange potion\n"
      "Did you get lost?  Don't worry, that happens often to people that are new to the area.  %NPC contacted "
      "me and said the potion wasn't important anyway.  Feel free to throw that %CARGO away, as it is way "
      "beyond its expiration date by now."

   wand_identify_assign_1 =\
      "Well, now that you mention it, I do have this wand I picked up the other day but I can't figure out "
      "what it does - it seems to repel magic.  Could you take it to %NPC and have %HIMHER_NPC identify it for me?  "
      "I'd be most grateful if you could."
   wand_identify_assign_2 =\
      "A wand, eh?  Well let me see here... ah ha!  You see these runes here... along the handle...  "
      "Those say that this is a %CARGO.  Allow me to put a label with the translation on the wand so "
      "that %NPC will be able to know what this is."
   wand_identify_success = \
      "Marvelous.  A %CARGO will certainly come in handy.  Let me give you something for your trouble."
   wand_identify_failure_1 = "Subject: That odd wand\n"
      "About that wand, I remembered that it was a pretty useless item.  Don't bother identifying it, "
      "I'm sure it is not worth it.  I will probably have other odd jobs for you to run should you come "
      "back to visit in the future.  See you later!"
   wand_identify_failure_2 = "Subject: That odd wand\n"
      "About that wand, %NPC told me that it wasn't important anyway.  Don't worry about returning it.  "
      "Actually, if I were you, I would throw it away.  Although I could tell what it was, it didn't look "
      "like it would work properly."

   jala_necklace_trigger = "necklace"
   jala_necklace_assign_1 =\
      "A necklace of Jala?  I have heard about such lovely things, although I do not have one myself.  Rumor is "
      "that %NPC has been bragging about that lately.  Perhaps you should go ask %HIMHER_NPC about the necklace?"
   jala_necklace_assign_2 =\
      "Why, YES!  I am glad to see you friend.  You see, I had the best idea in the world!  You sing, right?  "
      "Why don't you go ask %NPC if some ~Ientertainment~I would please %HIMHER_NPC?  I'll act as your agent and "
      "we can split the profits fairly.  Oh, and I'll give you that necklace you want, too."
   jala_necklace_trigger_2 = "entertainment"
   jala_necklace_assign_3 =\
      "You sing here?  HA!  There is NO way I am trusting that idiot Moxal.  Go talk to %NPC and ask "
      "%HIMHER_NPC about this ~Iproposal~I of Moxal's."
   jala_necklace_trigger_3 = "proposal"
   jala_necklace_assign_4 =\
      "Why did %NPC send you here?  Tell %HIMHER_NPC to quit being so silly and to let you ~Ising~I."
   jala_necklace_trigger_4 = "sing"
   jala_necklace_assign_5 =\
      "Fine.  Go fetch your %CARGO and play a song, then give the %CARGO to me."
   jala_necklace_assign_6 =\
      "Excellent!  After that performance, people will pay me good money for the lute of such a famous Bard.  "
      "Go tell %NPC that you have done well."
   jala_necklace_success = \
      "Finally done?  The payment was smaller than I expected, so I will have to keep it all to cover my expenses.  "
      "But, here is the necklace I promised you.  Come back soon!"
   jala_necklace_failure_1 =\
      "Did you get lost?  Don't you know that %NPC lives on the island?"
   jala_necklace_failure_2 =\
      "Oh, my!  You did not arrive in time for the show!  %NPC told me that other entertainment was arranged."
   jala_necklace_failure_3 =\
      "I knew this was another of Moxal's scams.  Do not get mixed up with him next time, my friend."
   jala_necklace_failure_4 =\
      "Did you lose your nerve?  You just need to stand up to %NPC next time!"
   jala_necklace_failure_5 =\
      "Not interested?  Fine, I will find someone else who is."
   jala_necklace_failure_6 =\
      "You didn't visit Moxal?  I heard he was laughing about what a sucker he found.  Expect him to want "
      "to exploit you again!"

   faction_soldier_trigger = "soldier"
   duke_faction_soldier_assign_1 =\
      "Yes, perhaps you'll do.  Prove your loyalty by murdering %INDEF_MONSTER%MONSTER.  You can usually find "
      "some guarding a flagpole.  Come back afterwards to tell of your deeds."
   duke_faction_soldier_assign_2 =\
      "Excellent.  Now, show your contempt for my enemies by murdering %INDEF_MONSTER%MONSTER.  Return "
      "to me when you are done to let me know the deed is done."
   duke_faction_soldier_success =\
      "You have done well, my soldier.  Join the ranks of the elite and bring my influence and power to those "
      "in this land!"
   duke_faction_soldier_failure =\
      "Lost your nerve?  How do you think you could ever survive on the field of combat if you have no stomach "
      "for killing?"

   princess_faction_soldier_assign_1 =\
      "I am in need of allies.  Please, prove your loyalty by fighting %INDEF_MONSTER%MONSTER.  You should "
      "find one guarding a flagpole nearby.  Come back and let me know you are done."
   princess_faction_soldier_assign_2 =\
      "I am glad to see you have returned.  Please fight %INDEF_MONSTER%MONSTER.  Tell me when you are "
      "done and you will be made a soldier."
   princess_faction_soldier_success =\
      "It is good that we can count you as an ally.  Take this as a symbol of your commitment to the battle."
   princess_faction_soldier_failure =\
      "Yes, this war is ugly and frightful and there is no shame for turning aside from the grisly task asked of "
      "you.  However, I need soldiers that will defend the royal right to the throne on the battlefield.  Visit "
      "later if you should gain enough nerve to fight our enemy."

   rebel_faction_soldier_assign_1 =\
      "I have faith in you.  Go dispatch %INDEF_MONSTER%MONSTER near a flagpole, return to report on your battle, "
      "and then we will talk about your future as a soldier."
   rebel_faction_soldier_assign_2 =\
      "Yes, I have heard stories of your fight.  Now go conquer %INDEF_MONSTER%MONSTER and you shall "
      "join us as an equal when you are done."
   rebel_faction_soldier_success =\
      "I knew you were a fit soldier.  Now you properly join us in our fight for freedom against tyranny!"
   rebel_faction_soldier_failure =\
      "I am disappointed in you.  I expected better out of a loyal supporter.  Should you be willing to "
      "fight against those that support tyranny, you know where to find me."

   murder_trigger = "murder"
   murder_say = "%CARGO"
   murder_princess_assign = \
      "Like the rest of the people in my fair lands, I am curious "
      "to learn who killed the former Duke.  Though he and I were often rivals, "
      "it saddened me to see him pass so violently.  "
      "If you will, aid my search by asking %NPC for any information about "
      "the murder, and please report it back to me." 
   murder_princess_success = \
      "I don't know if we can trust these rumors.  I thank you for "
      "your help;  the more we investigate, the closer we will come to "
      "the truth.  Please take this as a token of appreciation."
   murder_jonas_assign = \
      "As there doesn't seem to be much investigation of the former Duke's murder going on, "
      "I have taken it upon myself to uncover the killer.  Whoever committed the act must still be "
      "at large, and may strike again.  Ask %NPC about the murder and repeat any useful information "
      "back to me."
   murder_jonas_success = \
      "Hmm, perhaps this is the information I have been looking for.  "
      "Thank you for your help in this matter.  Take this with my "
      "thanks."
   murder_duke_assign = \
      "The passing of my uncle weighs heavily upon my mind.  "
      "Night and day, I can think of nothing else!  I must see that "
      "someone pays for this awful crime.  Please help "
      "my investigation by asking %NPC for any information about the "
      "murder.  Make sure to tell me what %NPC has to say."
   murder_duke_success = \
      "Ah, another piece in the complicated puzzle of my Uncle's death.  "
      "Take this with my thanks and my appreciation, my loyal follower."
   murder_princess_w_1 = \
      "Well, if you ask me, it seems like the Princess has quite "
      "a few armed troops.  Why is she mobilizing them unless she "
      "has something to hide?"
   murder_princess_w_2 = \
      "I honestly have no idea.  The duke was killed by a weapon "
      "and not magic, right?"
   murder_princess_w_3 = \
      "The murder of the Duke is a tragedy.  I think that no one is "
      "really above suspicion, even the fair Princess.  But, what kind "
      "of weapon would she use?"
   murder_princess_w_4 = \
      "I have heard that the Princess was trained in the arts of both "
      "weaponcraft and magic.  Although she hasn't used one in ages, I "
      "have also heard she is still an expert with the sword."
   murder_princess_w_5 = \
      "Oh, I doubt that the person that killed the Duke did the deed "
      "alone.  I am sure anyone, even the Princess, could have hired "
      "some shady character to murder in cold blood."
   murder_princess_m_1 = \
      "The Duke's death was obviously motivated by power.  There is no "
      "doubt that someone influential, like the Princess, wanted him out "
      "of the picture to increase her own power."
   murder_princess_m_2 = \
      "What other motive can there be but money?  With the shocking news "
      "of the death of the Duke, those in power could raid his holdings "
      "and gain some money.  Look at the faction troops roaming the lands.  "
      "They aren't cheap, you know."
   murder_princess_m_3 = \
      "It is unfortunate, but I'm sure that the driving force behind the "
      "Duke's unfortunate end is related to taxes.  Perhaps someone was "
      "tired of paying the high taxes, or perhaps another party wanted the "
      "tax money for themselves?"
   murder_princess_m_4 = \
      "People say that the intense feelings of dislike the Duke had for the "
      "poor Princess might have played a role in that dark night.  I doubt "
      "that this is the case.  While such feelings can drive one to rash "
      "actions, I don't think the young Princess struck out at him."
   murder_princess_m_5 = \
      "The competition between the Duke and the Princess plays a large part "
      "in the murder plot, I fear.  The Princess might have rationalized "
      "that it would be easier to play innocent, bide her time, then strike "
      "when the time was right."
   murder_princess_c_1 = \
      "Well, I certainly think it is strange that the Meridian Council had "
      "been meeting quite frequently at night the week before the poor Duke's "
      "bloody demise."
   murder_princess_c_2 = \
      "Only the blind would not notice how the Princess was conspicuously absent "
      "the night of the murder.  Can we trust her stories?"
   murder_princess_c_3 = \
      "I am suspicious of anyone with too strong of an alibi.  Like the "
      "Princess, isn't it suspicious that almost the whole Council swears "
      "they were probably in a meeting at that time?"
   murder_princess_c_4 = \
      "Isn't it strange that the Duke was murdered so violently, but no one "
      "saw or heard anything?  Perhaps there was some strange magic "
      "at work that night."
   murder_princess_c_5 = \
      "I thought I heard a priestess say that there were strange magical "
      "forces at work that night.  I wonder if the Princess knows anything "
      "about that?"
   murder_jonas_w_1 = \
      "I've heard that Jonas never cleans his sword in public like he "
      "sometimes did before the Duke's murder.  What is he trying to hide?"
   murder_jonas_w_2= \
      "Well, Jonas is a master of a variety of weapons, as he often reminds "
      "us.  I'm sure he's a master of whatever type of weapon was used in "
      "the murder of the Duke."
   murder_jonas_w_3 = \
      "I've heard someone say to a friend of mine that Jonas can't wield a "
      "real weapon to save his life, and that those war stories he tells are "
      "all a lie."
   murder_jonas_w_4 = \
      "Ran er'Hoth said the other day that the murder was done with a spoon.  "
      "Didn't Jonas say that he defended himself with a spoon one time when "
      "he was attacked in an inn?"
   murder_jonas_w_5 = \
      "Someone told me that there's a slight bloodstain on Jonas's scabbard.  "
      "Did he kill the Duke with his very own sword?"
   murder_jonas_m_1 = \
      "Have you heard the rumors about Jonas talking about the oppression "
      "of people by the nobility?  I think that's significant."
   murder_jonas_m_2 = \
      "I heard somewhere that Jonas has been talking about how he could "
      "guide the people better than the Duke could.  Perhaps he hoped to "
      "replace the old Duke."
   murder_jonas_m_3 = \
      "Hey, doesn't Jonas give very generously to the Temple of Kraanan "
      "the Fist?  I wonder if his personal wealth is in trouble."
   murder_jonas_m_4 = \
      "Jonas told someone that he was going to raise an army of his own.  "
      "That could get expensive.  I wonder where he plans to get the money "
      "from."
   murder_jonas_m_5 = \
      "Somone said that the Princess and Jonas have been becoming quite "
      "good friends lately.  Maybe she hired him to kill the Duke?  He is"
      "always looking to prove his fighting ability."
   murder_jonas_c_1 = \
      "I find it strange that you can never seem to find Jonas when you "
      "want to.  He seems like the slippery type that could make a quick "
      "getaway."
   murder_jonas_c_2 = \
      "Jonas claims he was in the Temple of Kraanan when the Duke was "
      "brutally murdered, but the Priestess Qerti'nya says she doesn't "
      "remember if he was there or not."
   murder_jonas_c_3 = \
      "I thought I heard that Jonas was blaming Rook for the murder.  Isn't "
      "it funny that he would try to get Rook in trouble, especially when "
      "you consider their history together?"
   murder_jonas_c_4 = \
      "I heard that Jonas intimidated the Princess into striking out against "
      "the Duke.  With all he has to gain, I think this is quite possible."
   murder_jonas_c_5 = \
      "I thought I saw Jonas at the Temple of Kraanan about the time of the "
      "Duke's murder, but I can't be certain."
   murder_miriana_w_1 = \
      "Well, travellers have told me that they see Miriana dancing in the "
      "woods with a knife.  Where did she get a weapon?"
   murder_miriana_w_2 = \
      "Somone said that Miriana once cut a spider in half with some strange "
      "magic.  The wound looked more like a weapon stroke than typical "
      "magical damage, they said."
   murder_miriana_w_3 = \
      "I overheard a conversation where one person told another that they "
      "heard Miriana running through the woods screaming something about "
      "Faren and wanting her weapon back.  What could that mean?"
   murder_miriana_w_4 = \
      "Somone said that Miriana knew the true power of the spell called "
      "'Nodeburst'.  I wonder what she does with all that power?"
   murder_miriana_w_5 = \
      "I once heard that the living trees used to cast their lightning "
      "bolts at Miriana, and that she would cast them back at the trees "
      "at a greater strength.  Could she have used that power against "
      "the Duke?"
   murder_miriana_m_1 = \
      "I overheard a guard say that he went with a small band of guards "
      "into the forest looking for Miriana.  He said that when they found "
      "her, they tried to give her a message from the Duke, but that she "
      "grew angry and left.  Did she hate the Duke?"
   murder_miriana_m_2 = \
      "A mage once told me that the Princess secretly supports Miriana "
      "because she knows how to tap the raw power of magic.  Could they "
      "have plotted against the Duke together?"
   murder_miriana_m_3 = \
      "I remember a story about how the Duke told a joke about how "
      "Miriana kept animal friends because they were the only ones that "
      "could stand her.  After that, there was a loud stroke of thunder "
      "outside the walls of the Keep.  Could there be any truth in that "
      "old story?"
   murder_miriana_m_4 = \
      "People have said that Miriana has held a grudge against the Duke's "
      "family for several generations.  Could she be that old?"
   murder_miriana_m_5 = \
      "A few years ago, I heard a story about how Miriana once visited the "
      "Duke, and warned him of some danger.  After the event she predicted "
      "happened, the Duke accused her of trying to kill him.  I wonder if "
      "she came back and finished the job?"
   murder_miriana_c_1 = \
      "A friend of a friend told me that Miriana was in the forest one day, "
      "and for no reason, she cried out, 'I did it, my lady.  He is dead.'  "
      "I wonder if she meant the Duke?"
   murder_miriana_c_2 = \
      "I don't know anything about what happened that night at the Duke's "
      "Keep.  I was in the forest, trying to find mushrooms while avoiding "
      "that Miriana."
   murder_miriana_c_3 = \
      "I saw a strange figure in the forest near Tos the night of the Duke's "
      "death.  It was a small person, perhaps about the size of a young girl."
   murder_miriana_c_4 = \
      "I recently went to the woods to find some herbs, and I overheard an "
      "adventurer talking to Miriana.  When he mentioned the Duke, she got "
      "very angry and refused to teach him the spells he requested."
   murder_miriana_c_5 = \
      "I've heard people claim that Miriana is behind the murder of the "
      "Duke.  I find the idea of a little girl being behind a murder like "
      "that to be laughable."
   murder_lich_c_1 =\
      " Well, I heard that one of the innkeepers was delivering some ale to the Duke's castle, "
      "to get ready for the big banquet.  Apparently there was a curious woman hanging around the "
      "delivery carts when they were going in.  He said she had very pale skin and was wearing a "
      "strange amulet."
   murder_lich_c_2 = \
      "I heard from a traveling merchant that there were all sorts of flashing lights and strange "
      "noises coming from the mountains over Brax on the night the Duke died."
   murder_lich_c_3 = \
      "I've heard people suggest that the Lich Queen might have killed the Duke, "
      "but if you think about it, the Duke hadn't really done much to get in her way.  "
      "Now if he had sent an army to Brax, like some people wanted him to, it might be a different story."
   murder_lich_c_4 =\
      "Well, I'm sure I don't know anything about that.  I was visiting my mother; she's not well you know.  "
      "But if you think about it, it seems like the necromancers have been awfully quiet lately, "
      "maybe too quiet."
   murder_lich_c_5 = \
      "Well, I can't be certain mind you, but I did hear that a large group of necromancers had been "
      "seen coming up through the mountains towards Tos about a week before the murder."
   murder_lich_w_1 =\
      "I don't know if I should tell you this or not, but a friend of mine works as a guard for the Duke "
      "and he says that there is a big cover up going on.  Seems the Duke wasn't murdered at all!  "
      "He killed himself trying to take off an Amulet of the Three!" 
   murder_lich_w_2 =\
      "I don't know anything about a weapon, but I do know that the feast hall was locked, "
      "no way in or out.  So whoever killed him must have had some way of teleporting out of there.  "
      "The only people I know of with magic like that are the necromancers."
   murder_lich_w_3 =\
      "I've heard that right before they found the body, some of the Duke's guards were attacked "
      "by horned skeletons!" 
   murder_lich_w_4 =\
      "A friend of mine who works for the Princess says that she was convinced that the Duke had "
      "become a Necromancer."
   murder_lich_w_5 =\
      "I've heard that one of the Duke's guards saw someone who looked exactly like the Duke walking "
      "out of the castle after the Duke had died.  He ran up to investigate, but whoever it was just "
      "disappeared, leaving only a puddle of slimy goo."
   murder_lich_m_1 =\
      "I've heard that the Duke was having the banquet to announce a big offensive against Brax "
      "to wipe out the Lich Queen and her necromancers.  Maybe she beat him to it."
   murder_lich_m_2 =\
      "Hmmm... well it's certainly no secret that the necromancers and Queen Venya'cyr would stop "
      "at nothing to disrupt and weaken us."
   murder_lich_m_3 =\
      "Well, the old Duke did just fine holding his own until Queen Venya'cyr reared her ugly head.  "
      "So if you ask me she's probably responsible."
   murder_lich_m_4 =\
      "Some people say that it must have been the lich queen who killed the Duke, but we all know "
      "that she hasn't left Brax in millennia."
   murder_lich_m_5 =\
      "Didn't Queen Venya'cyr vow to kill both the Duke and the Princess?   Kateriina should look out, "
      "she could be next!"
   murder_akardius_c_1=\
      "Well, don't tell Duke Akardius I said this, but its hard to think of anyone else who had access "
      "to the feast hall, now isn't it?"
   murder_akardius_c_2=\
      "All I know is that the new Duke moved pretty fast after his uncle died.  Almost like he had it "
      "all planned out ahead of time..."
   murder_akardius_c_3=\
      "Anyone who saw the look on that poor boy's face when he saw his uncle's body would know that he "
      "certainly couldn't have been responsible."
   murder_akardius_c_4=\
      "They say that the Duke was holding the banquet in honor of his Nephew.  It was to be his big "
      "welcome back to the mainland, and the Duke was going to name him as his heir."
   murder_akardius_c_5=\
      "There is more to Duke Akardius then meets the eye;  ever wonder where he's been all these years?  "
      "The Island, studying at the Temple of Riija, that's where!  I tell you, anyone who has spent that "
      "much time with the God of Trickery isn't to be trusted."
   murder_akardius_w_1=\
      "From what I've heard the Duke wasn't killed with a weapon or by magic.  It was poison.  "
      "Isn't poison the way the royals have always killed members of their own family?"
   murder_akardius_w_2=\
      "They say that the day after the Duke was killed Akardius got a new sword from the armory.  "
      "I wonder why he didn't want to carry his old one anymore..."
   murder_akardius_w_3=\
      "I've heard that Duke Akardius studied at the Temple of Riija while he was away.  I wonder if "
      "they teach more than simple illusions to advanced students.  After all, Riija is the trickster "
      "god and some tricks can be deadly."
   murder_akardius_w_4=\
      "I know they checked all the guards' weapons as soon as the Duke was killed, and I've heard that "
      "Duke Akardius volunteered to go first to set an example for his men."
   murder_akardius_w_5=\
      "They say that Duke Akardius was an accomplished swordsman.  Not that he'd have to be all that "
      "tough to get the jump on his uncle.  I mean after all he was a bit, um... big boned."
   murder_akardius_m_1=\
      "You know what they say: look toward the one who prospered the most."
   murder_akardius_m_2=\
      "I've heard that Duke Akardius didn't want to go to the Island, but that his uncle sent him "
      "away when he was young.  Maybe he hated his uncle for that."
   murder_akardius_m_3=\
      "I heard that the Duke had been praising Jonas's military skill and saying that he would make "
      "a worthy heir.  Perhaps Akardius got jealous."
   murder_akardius_m_4=\
      "Madelia told me that she went on a picnic with Akardius and that afterward he got very upset "
      "and ran off, crying, \"Oh how could I have done this to poor Princess Kateriina?\"   Could they "
      "be in love?  The Old Duke certainly wouldn't have approved of that!"
   murder_akardius_m_5=\
      "Everyone knows that the Duke was planning on making Akardius his heir anyway.  I don't see why he "
      "would have wanted to harm the uncle who had been so good to him."
   murder_maleval_c_1 =\
      "hmm... well the first thing that comes to mind is that Maleval certainly had free access to the Duke.  "
      "Don't know how Kalior could stand him.  He gives me the creeps."
   murder_maleval_c_2 =\
      "One of the Duke's guards told me that Maleval is always showing up in rooms that are supposed to be "
      " locked.  Maybe he has his own set of keys."
   murder_maleval_c_3 =\
      "My cousin's wife's brother is certain that Maleval was at the Qor temple the night of the Duke's murder... "
      "um... I mean, not that she would ever go there.  Nobody in my family follows Qor.  Certainly not!"
   murder_maleval_c_4 =\
      "One of the Duke's caterers told me that Kalior was holding the feast to announce that Akardius would be "
      "his new advisor.  I bet Maleval didn't like that one bit!"
   murder_maleval_c_5 =\
      "I've got a friend who tends the castle gardens and while he was trimming the hedges under the Duke's window "
      "he heard Maleval say, \"Tread carefully Kalior.  You would not want to try my patience.\"  "
      "He says he thinks they were arguing earlier about a planned offensive against Brax."
   murder_maleval_w_1 =\
      "Well who can say?  But if it turns out that magic was involved I'd be suspicious of Maleval.  "
      "He certainly has the means."
   murder_maleval_w_2 =\
      "The other day I heard Ran er'Hoth say, \"Melt, melt, melt, melt... That's how Dukie-wookie felt.\""
      "  Could that mean Kalior was killed with acid touch?"
   murder_maleval_w_3 =\
      "Well I certainly wouldn't know, although I would think you'd need pretty powerful magic for a job "
      "like that."
   murder_maleval_w_4 =\
      "I have it from a very authoritative source that Kalior was beaten to death, but I don't believe it "
      "for a second.  I'm certain Maleval did it and a beating just isn't his style."
   murder_maleval_w_5 =\
      "A friend says poor Kalior was asphyxiated, but he didn't get a close look at the body because he "
      "couldn't stop sneezing."
   murder_maleval_m_1 =\
      "I always had the feeling that Maleval was the real power behind the throne.  "
      "Perhaps he grew tired of his puppet."
   murder_maleval_m_2 =\
      "Maleval certainly seems to like young Akardius.  He seems almost protective.  I suppose it's only "
      "natural after what happened to Kalior."
   murder_maleval_m_3 =\
      "Well, despite what some might say, I think we can rule out Maleval.  He had Kalior in his pocket "
      "anyway, so why would he want him dead?  Surely a disciple of the Trickster will be harder to control!" 
   murder_maleval_m_4=\
      "There have been whispers about the dark wizard Maleval...  I think people are just frightened of "
      "him because he's so mysterious."
   murder_maleval_m_5=\
      "Supposedly Maleval thought Duke Kalior didn't have enough respect for magic.  Maybe he "
      "put together a little demonstration."
   murder_roq_m_1 = "Isn't there a professional assassin who lives in the sewers of Barloque?  "
      "He seems like a pretty clear suspect.  I'm surprised he hasn't already been arrested!"
   murder_roq_m_2 = "I've heard mutterings around Barloque about sending troops into the sewers to "
      "'clean them out', but it sounds like a witch hunt to me.  Everyone knows Roq retired years ago."
   murder_roq_m_3 = "Why do you think Roq hides out in the sewers?  Rumor has it that he killed "
      "Queen Katria all those years ago, and he's still in hiding.  Of course, my aunt used to say it "
      "was Kalior himself who put him up to it, so perhaps justice has been served."
   murder_roq_m_4 = \
      "You know, there was a time when Roq was a frequent guest at Blackstone Keep.  Many people even thought "
      "he was manipulating Kalior.  I wonder how he felt about no longer being Kalior's most trusted advisor?"
   murder_roq_m_5 = \
      "Logically speaking, it seems the easiest way to kill someone would be to hire an assassin.  "
      "That shifts blame away from you.  But then I've never planned a murder, so how would I know?"
   murder_roq_w_1 = \
      "I've heard that the Duke was killed by what appeared to be the thrust of a small blade between "
      "his shoulder blades."
   murder_roq_w_2 = \
      "From what I've heard the Duke's actual wound wasn't that bad, but it festered and ate "
      "into him in a matter of minutes.  Did the wound come from some magically cursed weapon?"
   murder_roq_w_3 = \
      "One of the Duke's guards says that Kalior and Akardius were playing a game of assassin before "
      "the banquet.  What if somebody switched out Akardius's black dagger?"
   murder_roq_w_4 = \
      "Someone told me that they saw Roq the day after the Duke's murder carrying only one blade.  "
      "Doesn't he usually have two?"
   murder_roq_w_5 = \
      "A friend says she heard the Duke scream exactly four times.  Does that mean he was stabbed multiply?"
   murder_roq_c_1 = \
      "I heard somebody say that Roq had been buying a bunch of new weapons lately.  "
      "I wonder where he got the money?"  % (tie-in to weapon selling NPC)
   murder_roq_c_2 = \
      "I've heard people say that Roq must have killed the Duke, just because he's an assassin.  "
      "I think that's silly.  And anyway, Roq couldn't have done it because I bought a dagger from him "
      "around the time of the murder.  That is, a friend told me he bought one.  A small one."
   murder_roq_c_3 = \
      "A friend says he saw a shadowy figure moving quickly through the Twisted Woods on the night of the "
      "murder.  He called out a greeting and it looked up at him with glowing red eyes, then disappeared."
   murder_roq_c_4 = \
      "Someone told me they saw Roq make a large deposit in Obert's vault shortly after the murder.  "
      "It was wrapped in cloth, but was apparently very heavy and made a clanking sound."
            % (Obert, when asked, will say that he must honor the privacy of his customers - but later in
            %  the mystery, players will be given a search warrant and will be able to retrieve the
            %  deposit.)
   murder_roq_c_5 = \
      "One of the Duke's guards told me that Roq paid a visit to Blackstone Keep earlier that evening.  "
      "Maleval encountered him on the steps and the two had harsh words, ending with the dark wizard "
      "storming off into the night."
            % (any of the guards questioned will refuse to speak about that night)
   murder_random_w_1 = \
      "Bah!  This whole thing is ridiculous.  The fact is the Duke just couldn't wait to start "
      "the feast and Akardius is too embarassed to admit that his uncle ate himself to death."
   murder_random_c_1 = \
      "I heard that Akardius took the Duke's body to a healer, even though he was dead.  "
      "I guess he was really desperate to save him."  % (Tie-in to Lady Aftyn dialoge.)
   murder_random_m_1 = \
      "Well, there have been a lot of rumors flying around about Maleval or the Princess or you name it.  "
      "Some fool probably even suspects me.  But I wouldn't be surprised if the Duke had some "
      "secret lover; looks like a crime of passion to me."


   questEngine_report_sender = "Quest Engine"
   questEngine_report_1 = "Subject: Report: Quest %q\n"
         "Quest %q has %q active instances, %q of which are unassigned, and %q of which have "
         "been assigned to:\n%q"
   questEngine_report_2 = ",\n"

classvars:

properties:

	piQuestTimerDelay = 5 * 60 * 1000    %	used to check if deadlines met and schedule new quests
	piQuestDeadlineTimerDelay = 60 * 1000     %  goes off once a minute
	piQuestHistoryRecentTime = 4 * 3600       %  4 hrs - defines what 'recently' means in history restrictions

	piDebug = FALSE
	piActive = TRUE                           % set to FALSE to suspend scheduling of new quests
	ptQuestTimer = $
	ptQuestDeadlineTimer = $
	plChessPiecesCaptured = $
	plChessPieces = $
	plChessPiecesFiles = $
	plChessPiecesRanks = $

	piDefaultNumPlayers = 1
	piDefaultQuestType = Q_TYPE_COMPETITIVE		% not used for single-player quests
	piDefaultPlayerRestrict = Q_PLAYER_NOTTRIED_RECENTLY	% not tried this quest for 24 hrs. of logged in time
	plDefaultQuestNodes = $	
	piDefaultMaxNumberActive = 1				% allow only 1 active at a time
	piDefaultRescheduleChance = 50				% 50/50 chance of scheduling a new quest each time timer fires
	plDefaultPlayerRestrict2 = $

	% QuestTemplate is
	%	[	number of players,
	%		type of quest,
	%		eligible player restrictions,
	%		quest nodes,
	%		max number active,
	%		currently active quests,
	%		percent chance of scheduling (on timer firing)
	%     special restrictions]

	plQuestTemplates = $

	plDefaultNPCList = $
	piDefaultNPCModifier = $	
	piDefaultQuestNodeType = $
	plDefaultCargoList = $
	plDefaultMonsterList = $		
	plDefaultPrizeList = $
	plDefaultPenaltyList = $
	piDefaultTimeLimit	= 600	% ten minutes

	% QuestNodeTemplate is
	%	[	NPC list,
	%		NPC modifier,
	%		questnode type,
	%		cargo list,
	%		monster list,
	%		prizelist,
	%		penaltylist,
	%		assign hint,
	%		success hint,
	%		failure hint,
	%		time limit	]

	plQuestNodeTemplates = $
	plQuestNodesAwaitingMonsterDeath = $
	
   piCensusTallyDeleted = 0
   piCensusTallyActive = 0
   piCensusTallyActiveOrphaned = 0
   piCensusTallyActiveDuplicate = 0

messages:

Constructor()
{
   send( self, @Recreate );
   return;
}

Delete()
{
   if( ptQuestTimer <> $ )
   {
      DeleteTimer( ptQuestTimer );
      ptQuestTimer = $;
   }
   if( ptQuestDeadlineTimer <> $ )
   {
      DeleteTimer( ptQuestDeadlineTimer );
      ptQuestDeadlineTimer = $;
   }
   
   propagate;
}

% does not start timer
% after this call, call RecreateQuestNodes to create questnodes and start timer
Recreate()
{
   local i;
   
   if( ptQuestTimer <> $ )
   {
      DeleteTimer( ptQuestTimer );
      ptQuestTimer = $;
   }
   if( ptQuestDeadlineTimer <> $ )
   {
      DeleteTimer( ptQuestDeadlineTimer );
      ptQuestDeadlineTimer = $;
   }
   
   plChessPiecesCaptured = [ pawn1, pawn2, pawn3, pawn4, pawn5, pawn6, pawn7, pawn8, rook1, rook2, knight1, knight2, bishop1, bishop2, queen ];
   plChessPieces = [ pawn, rook, knight, bishop, queen, king ];
   plChessPiecesFiles = [ rook1, rook2, knight1, knight2, bishop1, bishop2, queen, king ];
   plChessPiecesRanks = [ two, three, four, five, six, seven ];
	
   piDefaultNumPlayers = 1;
   piDefaultQuestType = Q_TYPE_COMPETITIVE;	% not used for single-player quests
   piDefaultPlayerRestrict = Q_PLAYER_NOTTRIED_RECENTLY;	 % not tried this quest for 24 hrs. of logged in time
   plDefaultQuestNodes = [ 1 ];			% only one node, the first
   piDefaultMaxNumberActive = 5;		% for testing, have 5 active at a time
   piDefaultRescheduleChance = 50;		% 50/50 chance of scheduling a new quest each time timer fires
	plDefaultPlayerRestrict2 = $;

   plDefaultNPCList = $;
   piDefaultNPCModifier = QN_NPCMOD_NONE;
   piDefaultQuestNodeType = QN_TYPE_SHOWUP;
   plDefaultCargoList = [];
   plDefaultMonsterList = [];
   plDefaultPrizeList = [];	
   plDefaultPenaltyList = [];

	% QuestTemplate is
	%	[	number of players,
	%		type of quest,
	%		eligible player restrictions,
	%		quest nodes,
	%		max number active,
	%		currently active quests,
	%		percent chance of scheduling (on timer firing)
	%     special restrictions]
%% Permanent quests, index is determined by constants from old quest setup
   % QST_ID_SHALILLE_DISCIPLE
   plQuestTemplates =	[  [  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 12, 13, 14 ],\
			      30,\
			      [],\
			      100 ] ];
   % QST_ID_KRAANAN_DISCIPLE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 10, 11 ],\
			      30,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_FAREN_DISCIPLE
   plQuestTemplates = cons([  piDefaultNumPlayers,\   
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 15, 16, 17 ],\
			      30,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_QOR_DISCIPLE
   plQuestTemplates = cons([  piDefaultNumPlayers,\   
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 42, 43, 44 ],\
			      30,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_SCIMITAR_PROF
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 45, 46, 47, 48 ],\
			      30,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_DEMENTIA_SPELL
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 92, 93, 94 ],\
			      20,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_FADE_SPELL
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 88, 89, 90, 91 ],\
			      20,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_PRINCESS_SERVICE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_FACTION_PRINCESS | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 8, 9 ],\
			      1,\
			      [],\
			      0 ], plQuestTemplates );
   % QST_ID_DUKE_SERVICE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_FACTION_DUKE | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 5, 6, 7 ],\
			      1,\
			      [],\
			      0 ], plQuestTemplates );
   % QST_ID_PRINCESS_JOIN
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_INTRIGUING | Q_PLAYER_FACTION_NEUTRAL | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 3, 4 ],\
			      30,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_DUKE_JOIN
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_INTRIGUING | Q_PLAYER_FACTION_NEUTRAL | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 1, 2 ],\
			      30,\
			      [],\
			      100 ], plQuestTemplates );
   % QST_ID_GUILDSHIELD
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      0,\
			      [ 18, 19 ],\
			      30,\
			      [],\
			      100,\
			      [ [ Q_R2_QN_ASSIGNABLE, FALSE ], [ Q_R2_IS_GUILD_MEMBER_OF, $ ] ]
			                                    ], plQuestTemplates );
   % QST_ID_GUILDSHIELD_INTRO
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_GUILDMASTER,\
			      [ 20 ],\
			      15,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_LUTE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE,\
			      [ 21, 22, 23, 24 ],\
			      20,\
			      [],\
			      4,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_TRUTH_SPELL_ENDBRANCH
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      0,\
			      [ 30 ],\
			      20,\
			      [],\
			      0,
			      [ [ Q_R2_QN_ASSIGNABLE, FALSE ], [ Q_R2_IS_PLAYER, $ ] ]
			                                    ], plQuestTemplates );
	% QST_ID_TRUTH_SPELL
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 25, 26, 27, 28 ],\
			      20,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_BONE_PRIESTESS
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 31, 32 ],\
			      20,\
			      [],\
			      10,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_MAD_SCIENTIST
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 33, 34 ],\
			      20,\
			      [],\
			      10,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_TRADING_POST_GOOD
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_KARMA_GOOD,\
			      [ 35, 36 ],\
			      20,\
			      [],\
			      10,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_TRADING_POST_EVIL
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_KARMA_EVIL,\
			      [ 35, 37 ],\
			      20,\
			      [],\
			      10,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_BOW_MAKER_GOOD
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_KARMA_GOOD,\
			      [ 38, 39, 40 ],\
			      20,\
			      [],\
			      10,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_BOW_MAKER_EVIL
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_KARMA_EVIL,\
			      [ 38, 41 ],\
			      20,\
			      [],\
			      10,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_CHICKEN_SOUP
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NEWBIE,\
			      [ 49, 50, 51 ],\
			      40,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_STUNTED_DWARF
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED,\
			      [ 52, 53, 54, 55, 56, 57, 58 ],\
			      20,\
			      [],\
			      2,
			      [ [ Q_R2_HAS_SKILL, SKID_BRAWLING, 50 ], [ Q_R2_HAS_SKILL, SKID_PROFICIENCY_SCIMITAR, 25 ] ]
			                                    ], plQuestTemplates );
	% QST_ID_HYPOCHONDRIAC
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 59, 60, 61, 62 ],\
			      5,\
			      [],\
			      10,
			      [ ]
			                                    ], plQuestTemplates );
	% QST_ID_QOR_OFFERING
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_KARMA_EVIL | Q_PLAYER_NOTNEWBIE,\
			      [ 63, 64, 65, 66, 66, 66, 67 ],\
			      1,\
			      [],\
			      10,
			      [ [ Q_R2_HAS_SPELL_SCHOOL, SS_QOR, 15 ] ]
			                                    ], plQuestTemplates );
	% QST_ID_SHALILLE_OFFERING
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_KARMA_GOOD | Q_PLAYER_NOTNEWBIE,\
			      [ 68, 69, 70, 71, 71, 71, 72 ],\
			      1,\
			      [],\
			      10,
			      [ [ Q_R2_HAS_SPELL_SCHOOL, SS_SHALILLE, 15 ] ]
			                                    ], plQuestTemplates );
	% QST_ID_FAREN_OFFERING
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_KARMA_NEUTRAL | Q_PLAYER_NOTNEWBIE,\
			      [ 73, 74, 75, 76, 76, 76, 77 ],\
			      1,\
			      [],\
			      10,
			      [ [ Q_R2_HAS_SPELL_SCHOOL, SS_FAREN, 15 ] ]
			                                    ], plQuestTemplates );
	% QST_ID_KRAANAN_OFFERING
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE,\
			      [ 78, 79, 80, 81, 81, 81, 82 ],\
			      1,\
			      [],\
			      10,
			      [ [ Q_R2_HAS_SPELL_SCHOOL, SS_KRAANAN, 15 ] ]
			                                    ], plQuestTemplates );
	% QST_ID_RIIJA_OFFERING
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE,\
			      [ 83, 84, 85, 86, 86, 86, 87 ],\
			      1,\
			      [],\
			      10,
			      [ [ Q_R2_HAS_SPELL_SCHOOL, SS_RIIJA, 8 ] ]
			                                    ], plQuestTemplates );
	% QST_ID_SPOREBURST_LEARN
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTSUCCEEDED | Q_PLAYER_NOTFAILED_RECENTLY,\
			      [ 95, 96, 97 ],\
			      10,\
			      [],\
			      4,
			      [ [ Q_R2_HAS_SPELL, SID_HOLD, 75 ] ]
			                                    ], plQuestTemplates );
   % QST_ID_POLISH_SERAPHYM
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE,\
			      [ 98, 99 ],\
			      20,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_PRIESTESS_INSIGNIA
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 100, 101, 102 ],\
			      80,\
			      [],\
			      100,
			      [ [ Q_R2_HAS_ITEM, &GuildShield ] ]
			                                    ], plQuestTemplates );
   % QST_ID_MONK_INSIGNIA
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 103, 104, 105 ],\
			      20,\
			      [],\
			      100,
			      [ [ Q_R2_HAS_ITEM, &GuildShield ] ]
			                                    ], plQuestTemplates );
   % QST_ID_FACTION_INSIGNIA
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_FACTION_SAME,\
			      [ 106, 107, 108, 109 ],\
			      40,\
			      [],\
			      100,
			      [ [ Q_R2_HAS_ITEM, &GuildShield ] ]
			                                    ], plQuestTemplates );
   % QST_ID_MYSTERY_MONSTER
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NEWBIE,\
			      [ 110, 111, 112, 113 ],\
			      20,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MOXAL_SCAM_1
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 114, 115, 116, 117, 117, 118 ],\
			      30,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MOXAL_SCAM_2
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 119, 120, 121, 122, 123 ],\
			      30,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_COUNCIL_LETTER
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NEWBIE,\
			      [ 124, 125 ],\
			      40,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_CHESS
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NEWBIE,\
			      [ 126, 127, 128, 129 ],\
			      20,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_CHESS_CHECKMATE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NEWBIE,\
			      [ 130, 131, 132, 133, 134 ],\
			      20,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_LOVE_LETTER_1
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 135, 136 ],\
			      20,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_LOVE_LETTER_2
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 137, 138 ],\
			      20,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_ESTABLISH_NECROGUILD
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE,\
			      [ 139, 140, 141 ],\
			      1,\
			      [],\
			      100,
			      [ [ Q_R2_USING_ITEM, &NecromancerAmulet ], [ Q_R2_NUM_AMULETS, 5 ] ]
			                                    ], plQuestTemplates );
   % QST_ID_APHRODESIAC
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 142, 143, 144, 145 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_NECRO_WARNING
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE | Q_PLAYER_KARMA_EVIL,\
			      [ 146, 147, 148 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_BAR_RESTOCK
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 149, 150, 151 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_PARTY
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 152, 153, 154 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_ORE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 155, 156 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_APOTHECARY
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 157, 158 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_VAULT_TAX
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 159, 160 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_MERCHANT_TAX
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 161, 162 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_LATE_TAX
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 163, 164 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_KOC_WEAPON_TRADE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 165, 166, 167 ],\
			      20,\
			      [],\
			      50,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_KOC_ALE_TRADE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_LAWFUL | Q_PLAYER_NOTNEWBIE,\
			      [ 168, 169, 170 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_NECRO_WARNING_2
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE | Q_PLAYER_KARMA_GOOD,\
			      [ 171, 172, 173 ],\
			      20,\
			      [],\
			      100,
			      [  ]
			                                    ], plQuestTemplates );
   % QST_ID_WARLETTER
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NOTNEWBIE,\
			      [ 174, 175 ],\
			      40,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_POTION_ID
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NEWBIE,\
			      [ 176, 177, 178 ],\
			      40,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_WAND_ID
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_NEWBIE,\
			      [ 179, 180, 181 ],\
			      40,\
			      [],\
			      100,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_PRINCESS_1
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_FACTION_PRINCESS,\
			      [ 182, 183, 184 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_PRINCESS_2
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_FACTION_PRINCESS,\
			      [ 182, 183, 185 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_PRINCESS_3
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_FACTION_PRINCESS,\
			      [ 182, 183, 186 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_DUKE_1
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_FACTION_DUKE,\
			      [ 187, 188, 189 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_DUKE_2
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_FACTION_DUKE,\
			      [ 187, 188, 190 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_DUKE_3
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY | Q_PLAYER_FACTION_DUKE,\
			      [ 187, 188, 191 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_JONAS_1
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 192, 193, 194 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_JONAS_2
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 192, 193, 195 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_MURDER_JONAS_3
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 192, 193, 196 ],\
			      30,\
			      [],\
			      0,
			      [ ]
			                                    ], plQuestTemplates );
   % QST_ID_REBEL_SERVICE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_FACTION_REBEL | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 197, 198 ],\
			      1,\
			      [],\
			      0,
			      [ ]                           ], plQuestTemplates );
   % QST_ID_REBEL_JOIN
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_INTRIGUING | Q_PLAYER_FACTION_NEUTRAL | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 199, 200 ],\
			      30,\
			      [],\
			      100,
			      [ ]                           ], plQuestTemplates );
   % QST_ID_JALA_NECKLACE
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 201, 202, 203, 204, 205, 206, 207 ],\
			      5,\
			      [],\
			      100,                 % TODO: Increase the spell school number below when we add new Jala spells
			      [[ Q_R2_HAS_SPELL_SCHOOL, SS_JALA, 11 ], [ Q_R2_DOES_NOT_HAVE_ITEM, &JalaNecklace ]]
			                                    ], plQuestTemplates );
   % QST_ID_DUKE_SOLDIER
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_FACTION_DUKE | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 208, 209, 210 ],\
			      30,\
			      [],\
			      100,
			      [[ Q_R2_HAS_HEALTH_LEVEL, 75 ], [ Q_R2_DOES_NOT_HAVE_ITEM, &DukeShield ]]
			                                    ], plQuestTemplates );
   % QST_ID_PRINCESS_SOLDIER
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_FACTION_PRINCESS | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 211, 212, 213 ],\
			      30,\
			      [],\
			      100,
			      [[ Q_R2_HAS_HEALTH_LEVEL, 75 ], [ Q_R2_DOES_NOT_HAVE_ITEM, &PrincessShield ]]
			                                    ], plQuestTemplates );
   % QST_ID_REBEL_SOLDIER
   plQuestTemplates = cons([  piDefaultNumPlayers,\
			      piDefaultQuestType,\
			      Q_PLAYER_FACTION_REBEL | Q_PLAYER_NOTTRIED_RECENTLY,\
			      [ 214, 215, 216 ],\
			      30,\
			      [],\
			      100,
			      [[ Q_R2_HAS_HEALTH_LEVEL, 75 ], [ Q_R2_DOES_NOT_HAVE_ITEM, &RebelShield ]]
			                                    ], plQuestTemplates );


   % now we fix up the faction service quests, since they need to have as many scheduled as members
   for i in Send(Send(SYS,@GetParliament),@GetFactionList) {
      if nth(i,1) = FACTION_PRINCESS {
         send(self,@SetQuestMaxActive,#index = QST_ID_PRINCESS_SERVICE, #new_max = (1+length(nth(i,2))) );
      }
      if nth(i,1) = FACTION_DUKE {
         send(self,@SetQuestMaxActive,#index = QST_ID_DUKE_SERVICE, #new_max = (1+length(nth(i,2))) );
      }
      if nth(i,1) = FACTION_REBEL {
         send(self,@SetQuestMaxActive,#index = QST_ID_REBEL_SERVICE, #new_max = (1+length(nth(i,2))) );
      }
   }
	
   return;
}

% recreate quest nodes and start timer
RecreateQuestNodes()
{
   local i, iMax, bOK, lNPCs, oNPC, lCargo, lCargo2;

   plDefaultNPCList = [ send( send( SYS, @GetLibrary ), @SelectQuester ),\
			send( send( SYS, @GetLibrary ), @SelectQuester ),\
			send( send( SYS, @GetLibrary ), @SelectQuester ),\
			send( send( SYS, @GetLibrary ), @SelectQuester ),\
			send( send( SYS, @GetLibrary ), @SelectQuester ) ];   % use old quest engine to select a random NPC

   piDefaultNPCModifier = QN_NPCMOD_NONE;
   piDefaultQuestNodeType = QN_TYPE_SHOWUP;										% show your face
   plDefaultCargoList = [ default_message ];										% list of messages
   plDefaultMonsterList = [ &SpiderBaby, &Centipede, &Ant, &FungusBeast, &Scorpion,\
			    &Slime, &Spider, &Troll, &Orc ];	% list of monster classes
   plDefaultPrizeList = [[[ QN_PRIZETYPE_ITEMCLASS, &Money, 10 ],\ 
			[ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ],\
			[ QN_PRIZETYPE_ITEMCLASS, &Emerald, 5 ],\
			[ QN_PRIZETYPE_ITEMCLASS, &Ruby, 5 ],\
			[ QN_PRIZETYPE_ITEMCLASS, &Diamond, 5 ],\
			[ QN_PRIZETYPE_ITEMCLASS, &Sapphire, 5 ],\
			[ QN_PRIZETYPE_ITEMCLASS, &EntrootBerry, 5 ],\
			[ QN_PRIZETYPE_ITEMCLASS, &OrcTooth, 5 ],\
			[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, 10, 1 ],\
			[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT, 10, 1 ],\
			[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AIM, 10, 1 ],\
			[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_STAMINA, 10, 1 ],\
			[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY, 10, 1 ],\
			[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM, 10, 1 ],\
			[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_STRENGTH, 10, 1 ]%,\
			%[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_HITPOINTS, 10, 1 ],\
			%[ QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MANA, 10, 1 ]
			] ];	
   plDefaultPenaltyList = [];	% none

   % QuestNodeTemplate is
   %	[	NPC list,
   %		NPC modifier,
   %		questnode type,
   %		cargo list,
   %		monster list,
   %		prizelist,
   %		penaltylist,
   %		assign hint,
   %		success hint,
   %		failure hint
   %		time limit	]

  % Will recreate questnodetemplates, including creating strings to hold the hints

   % template #1 is 1st Duke Join node, say "join" to Duke
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ duke_join1_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 1,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
                     #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &DukeLiege ) );
   }
   else
   {
      debug( "Error building QN #1" );
   }

   % template # 2 is 2nd Duke Join node, bring an item to me
   if send( self, @AddQuestNodeTemplate,\
	    #NPC_modifier = QN_NPCMOD_SAME,\
	    #questnode_type = QN_TYPE_ITEMFINDCLASS,\
	    #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Sapphire, 1 ],\
			   [ QN_PRIZETYPE_ITEMCLASS, &Ruby, 1 ],\
			   [ QN_PRIZETYPE_ITEMCLASS, &Emerald, 1 ],\
			   [ QN_PRIZETYPE_ITEMCLASS, &Diamond, 1 ] ],\
	    #prizelist = [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_DUKE ] ],
	    #timelimit = 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 2, #new_hint = duke_join2_assign);
      send( self, @SetQuestNodeSuccessHint, #index = 2, #new_hint = duke_join2_success );
      send( self, @SetQuestNodeFailureHint, #index = 2, #new_hint = duke_join2_failure );
   }
   else
   {
      debug( "Error building QN #2" );
   }
   
   % template #3 is 1st Princess Join node, say "join" to Princess
   if send( self, @AddQuestNodeTemplate,\
	    #questnode_type = QN_TYPE_MESSAGE,\
	    #cargolist = [ duke_join1_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 3,
	    #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
				  #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &PrincessLiege ) );
   }
   else
   {
      debug( "Error building QN #3" );
   }

   % template #4 is 2nd princess join node, deliver letter for her (placeholder)
   if send( self, @AddQuestNodeTemplate,
	    #questnode_type = QN_TYPE_ITEM,
    	    #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Letter, 1 ] ],
	    #prizelist = [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_PRINCESS ] ],
	    #timelimit = 3600 )    % an hour
   {
      lNPCs = $;
      % Xiana
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ShalillePriestess ) ), lNPCs );
      % Alzahakar
      %lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &OneCouncilor ) ), lNPCs );
      % Lady Aftyn
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer ) ), lNPCs );
      % Herbutte
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) ), lNPCs );
      % Esseldi
      %lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FiveCouncilor ) ), lNPCs );
      send( self, @SetQuestNodeNPCList, #index = 4, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 4, #new_hint = princess_join2_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 4, #new_hint = princess_standard2_success );
      send( self, @SetQuestNodeFailureHint, #index = 4, #new_hint = princess_standard2_failure );
   }
   else
   {
      debug( "Error building QN #4" );
   }

   % template #5 is 1st Duke Standard node, say "loyalty" to Duke
   if send( self, @AddQuestNodeTemplate,\
	    #questnode_type = QN_TYPE_MESSAGE,\
	    #cargolist = [ duke_standard1_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 5,
	    #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
				  #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &DukeLiege ) );
   }
   else
   {
      debug( "Error building QN #5" );
   }

   % template #6 is 2nd Duke Standard node, say "tax" to an NPC
   if send( self, @AddQuestNodeTemplate,
	    #questnode_type = QN_TYPE_MESSAGE,
    	    #cargolist = [ duke_standard2_trigger ],
	    #timelimit = 1800 )    % half an hour
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosTown )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothTown )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperTown )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_BARD,
		           #cNPC_class = &Minstrel )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      send( self, @SetQuestNodeNPCList, #index = 6, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 6, #new_hint = duke_standard2_assign );
      send( self, @SetQuestNodeFailureHint, #index = 6, #new_hint = duke_standard2_failure );
   }
   else
   {
      debug( "Error building QN #6" );
   }

   % template #7 is 3rd Duke Standard node, bring tax $$ back to Duke
   if send( self, @AddQuestNodeTemplate,
            #questnode_type = QN_TYPE_ITEMCLASS,
                #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Money, 2 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Money, 3 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Money, 4 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Money, 5 ] ],
            #prizelist = [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_UPDATE ],
                          [ QN_PRIZETYPE_SCHEDULE_QUEST, QST_ID_DUKE_SERVICE ] ],
            #penaltylist = [ [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_NEUTRAL ] ] ],
            #timelimit = 1800 )    % half an hour
   {
      send( self, @SetQuestNodeNPCList, #index = 7,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
			          #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &DukeLiege ) );
      send( self, @SetQuestNodeAssignHint, #index = 7, #new_hint = duke_standard3_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 7, #new_hint = duke_standard3_success );
      send( self, @SetQuestNodeFailureHint, #index = 7, #new_hint = duke_standard3_failure );
   }
   else
   {
      debug( "Error building QN #7" );
   }

   % template #8 is 1st Princess Standard node, say "loyalty" to Princess
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ duke_standard1_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 8,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
			          #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &PrincessLiege ) );
   }
   else
   {
      debug( "Error building QN #8" );
   }

   % template #9 is 2nd princess Standard node, deliver letter for her
   if send( self, @AddQuestNodeTemplate,
            #questnode_type = QN_TYPE_ITEM,
                #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Letter, 1 ] ],
            #prizelist = [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_UPDATE ],
                          [ QN_PRIZETYPE_SCHEDULE_QUEST, QST_ID_PRINCESS_SERVICE ] ],
            #penaltylist = [ [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_NEUTRAL ] ] ],
            #timelimit = 3600 )    % an hour
   {
      lNPCs = $;
      % Xiana
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ShalillePriestess ) ), lNPCs );
      % Alzahakar
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &OneCouncilor ) ), lNPCs );
      % Lady Aftyn
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer ) ), lNPCs );
      % Herbutte
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) ), lNPCs );
      % Esseldi
      lNPCs = cons( first( send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FiveCouncilor ) ), lNPCs );
      send( self, @SetQuestNodeNPCList, #index = 9, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 9, #new_hint = princess_standard2_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 9, #new_hint = princess_standard2_success );
      send( self, @SetQuestNodeFailureHint, #index = 9, #new_hint = princess_standard2_failure );
   }
   else
   {
      debug( "Error building QN #9" );
   }

   % template #10 is kraanan disciple quest kickoff, "favor"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ disciple_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 10,
       #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KraananPriestess ) );
   }
   else
   {
      debug( "Error building QN #10" );
   }
   % template #11 is kraanan disciple quest, kill monster
   if send( self, @AddQuestNodeTemplate,#questnode_type = QN_TYPE_MONSTER,#NPC_modifier = QN_NPCMOD_SAME,
         #monsterlist = [ &FungusBeast, &RedAnt, &Skeleton ],
         #timelimit = 2 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 11, #new_hint = kraanandisciple_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 11, #new_hint = kraanandisciple_success );
      send( self, @SetQuestNodeFailureHint, #index = 11, #new_hint = kraanandisciple_failure );
   }
   else
   {
      debug( "Error building QN #11" );
   }
   
   % template #12 is shal'ille disciple quest kickoff, "favor"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ disciple_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 12,
         #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ShalillePriestess ) );
   }
   else
   {
      debug( "Error building QN #12" );
   }
   % template #13 is shal'ille disciple quest, deliver message
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ shalilledisciple_trigger ], #timelimit = 3 * 3600 )
   {
      lNPCs = $;
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &QorPriestess )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FarenPriestess )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege )),lNPCs);
      send( self, @SetQuestNodeNPCList, #index = 13, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 13, #new_hint = shalilledisciple_assign );
      send( self, @SetQuestNodeFailureHint, #index = 13, #new_hint = shalilledisciple_failure );
   }
   else
   {
      debug( "Error building QN #13" );
   }
   % template #14 is shal'ille disciple quest, come back
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 14, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeSuccessHint, #index = 14, #new_hint = shalilledisciple_success );
      send( self, @SetQuestNodeFailureHint, #index = 14, #new_hint = shalilledisciple_failure );
   }
   else
   {
      debug( "Error building QN #14" );
   }
   % template #15 is faren disciple quest kickoff, "favor"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ disciple_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 15,
         #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FarenPriestess ) );
   }
   else
   {
      debug( "Error building QN #15" );
   }
   % template #16 is faren disciple quest, deliver message
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ farendisciple_trigger ], #timelimit = 3 * 3600 )
   {
      lNPCs = send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_BARTENDER, #onIsland = FALSE );
      send( self, @SetQuestNodeNPCList, #index = 16, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 16, #new_hint = farendisciple_assign );
      send( self, @SetQuestNodeFailureHint, #index = 16, #new_hint = farendisciple_failure );
   }
   else
   {
      debug( "Error building QN #16" );
   }
   % template #17 is faren disciple quest, come back
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 17, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeSuccessHint, #index = 17, #new_hint = farendisciple_success );
      send( self, @SetQuestNodeFailureHint, #index = 17, #new_hint = farendisciple_failure );
   }
   else
   {
      debug( "Error building QN #14" );
   }
   % template #18 is guild shield quest kickoff, "mining expedition"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ guildshield_initial_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 18,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_BLACKSMITH, #onIsland = FALSE ) );
      send( self, @SetQuestNodeSuccessHint, #index = 18,
            #new_hint = guildshield_assign );
   }
   else
   {
      debug( "Error building QN #18" );
   }
   % template #19 is guild shield quest finale, return ore to same blacksmith
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &OreChunk, 1 ] ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &GuildShield, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 19, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeSuccessHint, #index = 19, #new_hint = guildshield_success );
      send( self, @SetQuestNodeFailureHint, #index = 19, #new_hint = guildshield_failure );
      send( self, @SetQuestNodeTimeLimit, #index = 19, #new_limit = 2* 3600 ); % 2 hrs
   }
   else
   {
      debug( "Error building QN #19" );
   }
   % template #20 is guild shield intro quest, guildmaster shows up to be told which blacksmith to go to
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP,
         #prizelist = [ 
               [ QN_PRIZETYPE_SCHEDULE_QUEST, QST_ID_GUILDSHIELD ], 
               [ QN_PRIZETYPE_ACTIVATE_QUEST, QST_ID_GUILDSHIELD ],
               [ QN_PRIZETYPE_PASS_QUEST_RESTRICT2, Q_R2_IS_GUILD_MEMBER_OF, 1] ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 20,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_BARTENDER, #onIsland = FALSE  ));
      send( self, @SetQuestNodeSuccessHint, #index = 20, #new_hint = guildshield_intro );
      %send( self, @SetQuestNodeFailureHint, #index = 20, #new_hint = guildshield_failure );
   }
   else
   {
      debug( "Error building QN #20" );
   }
   % template #21 is lute quest, show up to be told who to go to, what to say
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ lutequest_trigger_1 ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 21,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel));
   }
   else
   {
      debug( "Error building QN #21" );
   }
   % template #22 is lute quest, say what parrin told you to
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ lutequest_trigger_2a, lutequest_trigger_2b, lutequest_trigger_2c,
                        lutequest_trigger_2d, lutequest_trigger_2e ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBartender )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperMerchant )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TwoCouncilor )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FiveCouncilor )
      {
         lNPCs = cons( oNPC, lNPCs );
      }
      send( self, @SetQuestNodeNPCList, #index = 22, #new_NPC_list = lNPCs);
      send( self, @SetQuestNodeAssignHint, #index = 22, #new_hint = lutequest_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 22, #new_hint = lutequest_failure_2 );
      send( self, @SetQuestNodeTimeLimit, #index = 22, #new_limit = 60 * 60 ); % one hour
   }
   else
   {
      debug( "Error building QN #22" );
   }
   % template #23 is lute quest, deliver the priority item.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Book, 1  ], [ QN_PRIZETYPE_ITEMCLASS, &Scroll, 1  ],
                        [ QN_PRIZETYPE_ITEMCLASS, &CurePoisonPotion, 1  ], [ QN_PRIZETYPE_ITEMCLASS, &Sacchaqua, 1  ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Rose, 1  ] ] )
   {
      % lNPCs was set in the previous node
      send( self, @SetQuestNodeNPCList, #index = 23, #new_NPC_list = lNPCs);
      send( self, @SetQuestNodeNPCModifier, #index = 23, #new_mod = QN_NPCMOD_DIFFERENT );
      send( self, @SetQuestNodeAssignHint, #index = 23, #new_hint = lutequest_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 23, #new_hint = lutequest_success_3  );
      send( self, @SetQuestNodeFailureHint, #index = 23, #new_hint = lutequest_failure_3 );
      send( self, @SetQuestNodeTimeLimit, #index = 23, #new_limit = 20 * 60 );
   }
   else
   {
      debug( "Error building QN #23" );
   }
   % template #24 is lute quest, come back to get your prize.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Lute, 1 ] ] )
   {
      %send( self, @SetQuestNodeNPCList, #index = 24, #new_NPC_list = lNPCs);
      send( self, @SetQuestNodeNPCModifier, #index = 24, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeSuccessHint, #index = 24, #new_hint = lutequest_success_4  );
      send( self, @SetQuestNodeFailureHint, #index = 24, #new_hint = lutequest_failure_4 );
      %send( self, @SetQuestNodeTimeLimit, #index = 24, #new_limit = 20 * 60 );
   }
   else
   {
      debug( "Error building QN #24" );
   }
   
   % template #25 is truth song quest, say truth
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ truthquest_trigger_1 ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 25,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel));
   }
   else
   {
      debug( "Error building QN #25" );
   }
   % template #26 is truth song quest,
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ truthquest_trigger_2 ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &barloqueVaultman ) {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &GuildCreator ) {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Barloquetailor ) {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothSergeant ) {
         lNPCs = cons( oNPC, lNPCs );
      }
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueClerk ) {
         lNPCs = cons( oNPC, lNPCs );
      }
      send( self, @SetQuestNodeNPCList, #index = 26, #new_NPC_list = lNPCs);
      send( self, @SetQuestNodeAssignHint, #index = 26, #new_hint = truthquest_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 26, #new_hint = truthquest_success_2  );
      send( self, @SetQuestNodeFailureHint, #index = 26, #new_hint = truthquest_failure_2 );
      send( self, @SetQuestNodeTimeLimit, #index = 26, #new_limit = 2 * 24 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #26" );
   }
   % template #27 is truth song quest, go back to parrin
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP ,
         #prizelist = [ [ QN_PRIZETYPE_SCHEDULE_QUEST, QST_ID_TRUTH_SPELL_ENDBRANCH ],
               [ QN_PRIZETYPE_ACTIVATE_QUEST, QST_ID_TRUTH_SPELL_ENDBRANCH ],
               [ QN_PRIZETYPE_PASS_QUEST_RESTRICT2, Q_R2_IS_PLAYER, 1]%,
               %[ QN_PRIZETYPE_PASS_NPC ]
               ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 27, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeFailureHint, #index = 27, #new_hint = truthquest_failure_3 );
      send( self, @SetQuestNodeTimeLimit, #index = 27, #new_limit = 2 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #27" );
   }
   % template #28 is truth song quest, say 'bad' to proceed
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ truthquest_trigger_4 ] )
   {
      %send( self, @SetQuestNodeNPCList, #index = 28, #new_NPC_list = lNPCs);
      send( self, @SetQuestNodeNPCModifier, #index = 28, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeAssignHint, #index = 28, #new_hint = truthquest_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 28, #new_hint = truthquest_success_4  );
      send( self, @SetQuestNodeFailureHint, #index = 28, #new_hint = truthquest_failure_4 );
      send( self, @SetQuestNodeTimeLimit, #index = 28, #new_limit = 60 * 1000 );
   }
   else
   {
      debug( "Error building QN #28" );
   }
   % template #29 is truth song quest, 'good' branch kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      %send( self, @SetQuestNodeNPCModifier, #index = 29, #new_mod = QN_NPCMOD_PASSED );
      send( self, @SetQuestNodeNPCList, #index = 29,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel));
   }
   else
   {
      debug( "Error building QN #29" );
   }
   % template #30 is truth song quest, 'good' branch
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ truthquest_trigger_5 ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 30,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel));
      %send( self, @SetQuestNodeNPCModifier, #index = 30, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeSuccessHint, #index = 30, #new_hint = truthquest_success_5  );
      send( self, @SetQuestNodeTimeLimit, #index = 30, #new_limit = 60 );
   }
   else
   {
      debug( "Error building QN #30" );
   }

   % template #31 is bone priestess quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ bonepriestessquest_trigger_1 ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 31,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBonePriestess));
   }
   else
   {
      debug( "Error building QN #31" );
   }
   % template #32 is bone priestess quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &OrcPitBossHead, 1  ] ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &SwordShardA, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 32, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeAssignHint, #index = 32, #new_hint = bonepriestessquest_assign_2  );
      send( self, @SetQuestNodeSuccessHint, #index = 32, #new_hint = bonepriestessquest_success_2  );
      send( self, @SetQuestNodeFailureHint, #index = 32, #new_hint = bonepriestessquest_failure_2 );
      send( self, @SetQuestNodeTimeLimit, #index = 32, #new_limit = 1 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #32" );
   }

   % template #33 is mad scientist quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ madscientistquest_trigger_1 ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 33,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanMadScientist));
   }
   else
   {
      debug( "Error building QN #33" );
   }
   % template #34 is mad scientist quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MONSTER_BRING,
         #monsterlist = [ &DragonFlyQueen ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &SwordShardB, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 34, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeAssignHint, #index = 34, #new_hint = madscientistquest_assign_2  );
      send( self, @SetQuestNodeSuccessHint, #index = 34, #new_hint = madscientistquest_success_2  );
      send( self, @SetQuestNodeFailureHint, #index = 34, #new_hint = madscientistquest_failure_2 );
      send( self, @SetQuestNodeTimeLimit, #index = 34, #new_limit = 1 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #34" );
   }

   % template #35 is trading post quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ tradingpost_trigger_1 ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 35,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &kocatanTradeMaster));
   }
   else
   {
      debug( "Error building QN #35" );
   }
   % template #36 is trading post quest (good)
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Meatpie, 50 ], [ QN_PRIZETYPE_ITEMCLASS, &Waterskin, 60 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Apple, 150 ], [ QN_PRIZETYPE_ITEMCLASS, &Chess, 1 ], 
                        [ QN_PRIZETYPE_ITEMCLASS, &ElderBerry, 350 ], [ QN_PRIZETYPE_ITEMCLASS, &Herbs, 250 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Mushroom, 200 ], [ QN_PRIZETYPE_ITEMCLASS, &JewelofFroz, 1 ] ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &SwordShardC, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 36, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeAssignHint, #index = 36, #new_hint = tradingpost_assign_2  );
      send( self, @SetQuestNodeSuccessHint, #index = 36, #new_hint = tradingpost_success_2  );
      send( self, @SetQuestNodeFailureHint, #index = 36, #new_hint = tradingpost_failure_2 );
      send( self, @SetQuestNodeTimeLimit, #index = 36, #new_limit = 1 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #36" );
   }
   % template #37 is trading post quest (evil)
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &MysticSword, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &PlateArmor, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &StoutGoblet, 100 ], [ QN_PRIZETYPE_ITEMCLASS, &NeruditeOreChunk, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &WineGoblet, 70 ], [ QN_PRIZETYPE_ITEMCLASS, &SpiderEgg, 1 ] ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &SwordShardC, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 37, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeAssignHint, #index = 37, #new_hint = tradingpost_assign_2  );
      send( self, @SetQuestNodeSuccessHint, #index = 37, #new_hint = tradingpost_success_2  );
      send( self, @SetQuestNodeFailureHint, #index = 37, #new_hint = tradingpost_failure_2 );
      send( self, @SetQuestNodeTimeLimit, #index = 37, #new_limit = 1 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #37" );
   }

   % template #38 is bow maker quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ bowmaker_trigger_1 ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 38,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBowMaker));
   }
   else
   {
      debug( "Error building QN #38" );
   }
   % template #39 is bow maker quest (good)
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &NeruditeOreChunk, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 39,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBonePriestess));
      send( self, @SetQuestNodeAssignHint, #index = 39, #new_hint = bowmaker_assign_2  );
      send( self, @SetQuestNodeSuccessHint, #index = 39, #new_hint = bowmaker_success_2  );
      send( self, @SetQuestNodeFailureHint, #index = 39, #new_hint = bowmaker_failure_2 );
      send( self, @SetQuestNodeTimeLimit, #index = 39, #new_limit = 1 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #39" );
   }
   % template #40 is bow maker quest (good)
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &AvarShamanFeather, 1 ] ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &SwordShardD, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 40, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeSuccessHint, #index = 40, #new_hint = bowmaker_success_3  );
      %send( self, @SetQuestNodeFailureHint, #index = 40, #new_hint = bowmaker_failure_3 );
      send( self, @SetQuestNodeTimeLimit, #index = 40, #new_limit = 1 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #40" );
   }
   % template #41 is bow maker quest (evil)
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MONSTER_ITEMCLASS,
         #monsterlist = [ &AvarShaman ],
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &AvarShamanFeather, 1 ] ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &SwordShardD, 1 ] ] )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 41, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeAssignHint, #index = 41, #new_hint = bowmaker_assign_4  );
      send( self, @SetQuestNodeSuccessHint, #index = 41, #new_hint = bowmaker_success_3  );
      send( self, @SetQuestNodeFailureHint, #index = 41, #new_hint = bowmaker_failure_4 );
      send( self, @SetQuestNodeTimeLimit, #index = 41, #new_limit = 1 * 60 * 60 );
   }
   else
   {
      debug( "Error building QN #41" );
   }

   % template #42 is qor disciple quest kickoff, "favor"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ disciple_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 42,
         #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &QorPriestess ) );
   }
   else
   {
      debug( "Error building QN #42" );
   }
   % template #43 is qor disciple quest, deliver message
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ qordisciple_trigger ], #timelimit = 2 * 3600 )
   {
      lNPCs = $;
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ShalillePriestess )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueBlacksmith )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperInnKeeper )),lNPCs);
      send( self, @SetQuestNodeNPCList, #index = 43, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 43, #new_hint = qordisciple_assign );
      send( self, @SetQuestNodeFailureHint, #index = 43, #new_hint = qordisciple_failure );
   }
   else
   {
      debug( "Error building QN #43" );
   }
   % template #44 is qor disciple quest, come back
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeNPCModifier, #index = 44, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeSuccessHint, #index = 44, #new_hint = qordisciple_success );
      send( self, @SetQuestNodeFailureHint, #index = 44, #new_hint = qordisciple_failure );
   }
   else
   {
      debug( "Error building QN #44" );
   }

   % template #45 is scimitar learn quest kickoff, "scimitar"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ scimitarlearn_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 45,
       #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBlacksmith ) );
   }
   else
   {
      debug( "Error building QN #45" );
   }
   % template #46 is scimitar learn quest, kill cave orc
   if send( self, @AddQuestNodeTemplate,#questnode_type = QN_TYPE_MONSTER,#NPC_modifier = QN_NPCMOD_SAME,
         #monsterlist = [ &CaveOrc ],
         #timelimit = 12 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 46, #new_hint = scimitarlearn_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 46, #new_hint = scimitarlearn_failure_2 );
   }
   else
   {
      debug( "Error building QN #46" );
   }
   % template #47 is scimitar learn quest, kill Yeti
   if send( self, @AddQuestNodeTemplate,#questnode_type = QN_TYPE_MONSTER,#NPC_modifier = QN_NPCMOD_SAME,
         #monsterlist = [ &Yeti ],
         #timelimit = 12 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 47, #new_hint = scimitarlearn_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 47, #new_hint = scimitarlearn_failure_3 );
   }
   else
   {
      debug( "Error building QN #47" );
   }
   % template #48 is scimitar learn quest, kill Yeti... again.
   if send( self, @AddQuestNodeTemplate,#questnode_type = QN_TYPE_MONSTER,#NPC_modifier = QN_NPCMOD_SAME,
         #monsterlist = [ &Yeti ],
         #timelimit = 12 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 48, #new_hint = scimitarlearn_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 48, #new_hint = scimitarlearn_success_4 );
      send( self, @SetQuestNodeFailureHint, #index = 48, #new_hint = scimitarlearn_failure_4 );
   }
   else
   {
      debug( "Error building QN #48" );
   }
   % template #49 is chicken soup quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothTown ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 49, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #49" );
   }
   % template #50 is chicken soup quest, say "chicken soup"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ chickensoupquest_trigger_2 ],
         #timelimit = 3600 )    % an hour
   {
      send( self, @SetQuestNodeNPCList, #index = 50,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperInnKeeper ) );
      send( self, @SetQuestNodeAssignHint, #index = 50, #new_hint = chickensoupquest_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 50, #new_hint = chickensoupquest_failure_2 );
   }
   else
   {
      debug( "Error building QN #50" );
   }
   % template #51 is chicken soup quest, bring the soup back
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,#NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &ChickenSoup, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Hammer, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &LongSword, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &Axe, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &ScaleArmor, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &FireRing, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &ColdRing, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &ShockRing, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &AcidRing, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &RingInvisibility, 1 ] ] ],
         #timelimit = 3600 )    % an hour
   {
     send( self, @SetQuestNodeAssignHint, #index = 51, #new_hint = chickensoupquest_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 51, #new_hint = chickensoupquest_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 51, #new_hint = chickensoupquest_failure_3 );
   }
   else
   {
      debug( "Error building QN #51" );
   }
   % template #52 is stunted dwarf quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_BARTENDER ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 52, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #52" );
   }
   % template #53 is stunted dwarf quest, say "stunted dwarf"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,#NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ stunteddwarf_trigger ],
         #timelimit = 5 * 60 )  % 5 minutes
   {
      send( self, @SetQuestNodeAssignHint, #index = 53, #new_hint = stunteddwarf_assign_2 );
   }
   else
   {
      debug( "Error building QN #53" );
   }
   % template #54 is stunted dwarf quest, say "stunted dwarf"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,#NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ stunteddwarf_trigger ],
         #timelimit = 24 * 3600 )    % a day
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionTown ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 54, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 54, #new_hint = stunteddwarf_assign_3 );
   }
   else
   {
      debug( "Error building QN #54" );
   }
   % template #55 is stunted dwarf quest, say "myth"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,#NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ stunteddwarf_trigger_4 ],
         #timelimit = 24 * 3600 )    % a day
   {
      send( self, @SetQuestNodeAssignHint, #index = 55, #new_hint = stunteddwarf_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 55, #new_hint = stunteddwarf_success_4 );
   }
   else
   {
      debug( "Error building QN #55" );
   }
   % template #56 is stunted dwarf quest, say "stunted dwarf" to island npc
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ stunteddwarf_trigger ],
         #timelimit = 2 * 24 * 3600 )    % 2 days
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanTown ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 56, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #56" );
   }
   % template #57 is stunted dwarf quest, go kill a kriipa
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MONSTER, #NPC_modifier = QN_NPCMOD_SAME,
         #monsterlist = [ &Kriipa ],
         #timelimit = 2 * 3600 )   %2 hours
   {
      send( self, @SetQuestNodeAssignHint, #index = 57, #new_hint = stunteddwarf_assign_6 );
      send( self, @SetQuestNodeSuccessHint, #index = 57, #new_hint = stunteddwarf_success_6 );
      send( self, @SetQuestNodeFailureHint, #index = 57, #new_hint = stunteddwarf_failure_6 );
   }
   else
   {
      debug( "Error building QN #57" );
   }
   % template #58 is stunted dwarf quest, give recipe to original npc
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ [ QN_PRIZETYPE_ITEM, &RecipeScroll, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingShalille, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &OfferingRiija, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &OfferingQor, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &OfferingFaren, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &OfferingKraanan, 1 ] ] ],
         #timelimit = 4 * 24 * 3600 )    % 4 days
   {
      send( self, @SetQuestNodeSuccessHint, #index = 58, #new_hint = stunteddwarf_success_7 );
   }
   else
   {
      debug( "Error building QN #58" );
   }

   % template #59 is hypochondriac quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      send( self, @SetQuestNodeNPCList, #index = 59,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) );
   }
   else
   {
      debug( "Error building QN #59" );
   }
   % template #60 is hypochondriac quest, say disease name to npc
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ hypochondriac_trigger_2a, hypochondriac_trigger_2b,
                        hypochondriac_trigger_2c, hypochondriac_trigger_2d ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperTown ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 60, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 60, #new_hint = hypochondriac_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 60, #new_hint = hypochondriac_failure_2 );
   }
   else
   {
      debug( "Error building QN #60" );
   }
   % template #61 is hypochondriac quest, say "sacchaqua" to npc
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ hypochondriac_trigger_3 ],
         #timelimit = 3600 )    % 1 hour
   {
      send( self, @SetQuestNodeNPCModifier, #index = 61, #new_mod = QN_NPCMOD_DIFFERENT );
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 61, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 61, #new_hint = hypochondriac_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 61, #new_hint = hypochondriac_failure_3 );
   }
   else
   {
      debug( "Error building QN #61" );
   }
   % template #62 is hypochondriac quest, bring the cure back to frisconar
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEM, &Sacchaqua, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &ScaleArmor, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &PlateArmor, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &FineLute, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &Rose, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &BerserkerRing, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &Gauntlet, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &EnfeebleWand, 1 ] ] ],
         #timelimit = 3600 )    % 1 hour
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 62, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 62, #new_hint = hypochondriac_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 62, #new_hint = hypochondriac_success_4 );
      send( self, @SetQuestNodeFailureHint, #index = 62, #new_hint = hypochondriac_failure_4 );
   }
   else
   {
      debug( "Error building QN #62" );
   }
   % template #63 is qor offering quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      send( self, @SetQuestNodeNPCList, #index = 63,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &QorPriestess ) );
   }
   else
   {
      debug( "Error building QN #63" );
   }
   % template #64 is qor offering quest, say "yes"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ qoroffering_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 64, #new_hint = qoroffering_assign_2 );
   }
   else
   {
      debug( "Error building QN #64" );
   }
   % template #65 is qor offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ qoroffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 30 seconds
   {
      send( self, @SetQuestNodeAssignHint, #index = 65, #new_hint = qoroffering_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 65, #new_hint = qoroffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #65" );
   }
   % template #66 is qor offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ qoroffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 66, #new_hint = qoroffering_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 66, #new_hint = qoroffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #66" );
   }
   % template #67 is qor offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ qoroffering_trigger_3 ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingQor, 1 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 67, #new_hint = qoroffering_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 67, #new_hint = qoroffering_success_5 );
      send( self, @SetQuestNodeFailureHint, #index = 67, #new_hint = qoroffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #67" );
   }

   % template #68 is shal'ille offering quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      send( self, @SetQuestNodeNPCList, #index = 68,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ShalillePriestess ) );
   }
   else
   {
      debug( "Error building QN #68" );
   }
   % template #69 is shal'ille offering quest, say "yes"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ shalilleoffering_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 69, #new_hint = shalilleoffering_assign_2 );
   }
   else
   {
      debug( "Error building QN #69" );
   }
   % template #70 is shal'ille offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ shalilleoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 30 seconds
   {
      send( self, @SetQuestNodeAssignHint, #index = 70, #new_hint = shalilleoffering_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 70, #new_hint = shalilleoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #70" );
   }
   % template #71 is shal'ille offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ shalilleoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 71, #new_hint = shalilleoffering_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 71, #new_hint = shalilleoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #71" );
   }
   % template #72 is shal'ille offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ shalilleoffering_trigger_3 ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingShalille, 1 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 72, #new_hint = shalilleoffering_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 72, #new_hint = shalilleoffering_success_5 );
      send( self, @SetQuestNodeFailureHint, #index = 72, #new_hint = shalilleoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #72" );
   }

   % template #73 is faren offering quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      send( self, @SetQuestNodeNPCList, #index = 73,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FarenPriestess ) );
   }
   else
   {
      debug( "Error building QN #73" );
   }
   % template #74 is faren offering quest, say "yes"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ farenoffering_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 74, #new_hint = farenoffering_assign_2 );
   }
   else
   {
      debug( "Error building QN #74" );
   }
   % template #75 is faren offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ farenoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 30 seconds
   {
      send( self, @SetQuestNodeAssignHint, #index = 75, #new_hint = farenoffering_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 75, #new_hint = farenoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #75" );
   }
   % template #76 is faren offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ farenoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 76, #new_hint = farenoffering_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 76, #new_hint = farenoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #76" );
   }
   % template #77 is faren offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ farenoffering_trigger_3 ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingFaren, 1 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 77, #new_hint = farenoffering_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 77, #new_hint = farenoffering_success_5 );
      send( self, @SetQuestNodeFailureHint, #index = 77, #new_hint = farenoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #77" );
   }

   % template #78 is kraanan offering quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      send( self, @SetQuestNodeNPCList, #index = 78,
         #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KraananPriestess ) );
   }
   else
   {
      debug( "Error building QN #78" );
   }
   % template #79 is kraanan offering quest, say "yes"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ kraananoffering_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 79, #new_hint = kraananoffering_assign_2 );
   }
   else
   {
      debug( "Error building QN #79" );
   }
   % template #80 is kraanan offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ kraananoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 30 seconds
   {
      send( self, @SetQuestNodeAssignHint, #index = 80, #new_hint = kraananoffering_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 80, #new_hint = kraananoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #80" );
   }
   % template #81 is kraanan offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ kraananoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 81, #new_hint = kraananoffering_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 81, #new_hint = kraananoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #81" );
   }
   % template #82 is kraanan offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ kraananoffering_trigger_3 ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingKraanan, 1 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -4, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -1, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_AGILITY , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 66 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 82, #new_hint = kraananoffering_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 82, #new_hint = kraananoffering_success_5 );
      send( self, @SetQuestNodeFailureHint, #index = 82, #new_hint = kraananoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #82" );
   }

   % template #83 is riija offering quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      send( self, @SetQuestNodeNPCList, #index = 83,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RiijaMonk ) );
   }
   else
   {
      debug( "Error building QN #83" );
   }
   % template #84 is riija offering quest, say "yes"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ riijaoffering_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 84, #new_hint = riijaoffering_assign_2 );
   }
   else
   {
      debug( "Error building QN #84" );
   }
   % template #85 is riija offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ riijaoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , 3, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -2, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, 2, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 30 seconds
   {
      send( self, @SetQuestNodeAssignHint, #index = 85, #new_hint = riijaoffering_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 85, #new_hint = riijaoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #85" );
   }
   % template #86 is riija offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ riijaoffering_trigger_3 ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , 3, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -2, 7 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, 2, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -1, 7 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -5, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -5, 2 ] ],
         #timelimit = 30 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 86, #new_hint = riijaoffering_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 86, #new_hint = riijaoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #86" );
   }
   % template #87 is riija offering quest, incant
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ riijaoffering_trigger_3 ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingRiija, 1 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , 25, 1 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -24, 4 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, 35, 1 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -34, 4 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -6, 2 ],
                        [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -6, 2 ] ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 87, #new_hint = riijaoffering_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 87, #new_hint = riijaoffering_success_5 );
      send( self, @SetQuestNodeFailureHint, #index = 87, #new_hint = riijaoffering_failure_3 );
   }
   else
   {
      debug( "Error building QN #87" );
   }
   
   % template #88 is fade learn quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ fadelearn_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index =88 , #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #88" );
   }
   % template #89 is fade learn quest, ask about formula
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ fadelearn_trigger_2 ],
         #timelimit = 3 * 3600 )    % 3 hrs
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Heretic ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RebelLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 89, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 89, #new_hint = fadelearn_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 89, #new_hint = fadelearn_failure_2 );
   }
   else
   {
      debug( "Error building QN #89" );
   }
   % template #90 is fade learn quest, prove resolve by killing monster
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MONSTER, #NPC_modifier = QN_NPCMOD_SAME,
         #monsterlist = [ &CaveOrc, &Troll ],
         #timelimit = 3600 )    % 1 hr
   {
      send( self, @SetQuestNodeAssignHint, #index = 90, #new_hint = fadelearn_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 90, #new_hint = fadelearn_failure_3 );
   }
   else
   {
      debug( "Error building QN #90" );
   }
   % template #91 is fade learn quest, return formula
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &FormulaScroll, 1 ] ],
         #timelimit = 3600 )    % 1 hr
   {
      send( self, @SetQuestNodeAssignHint, #index = 91, #new_hint = fadelearn_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 91, #new_hint = fadelearn_success_4 );
      send( self, @SetQuestNodeFailureHint, #index = 91, #new_hint = fadelearn_failure_4 );
   }
   else
   {
      debug( "Error building QN #91" );
   }
    
   % template #92 is dement learn quest kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ dementlearn_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 92 , #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #92" );
   }
   % template #93 is dement learn quest, deliver item
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Book, 1  ], [ QN_PRIZETYPE_ITEMCLASS, &Scroll, 1  ],
                        [ QN_PRIZETYPE_ITEMCLASS, &CureDiseasePotion, 1  ], [ QN_PRIZETYPE_ITEMCLASS, &Sacchaqua, 1  ] ],
         #prizelist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -5, 2 ] ],
         #timelimit = 4 * 3600 )    % 4 hrs
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RebelLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DarkWizard ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 93, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 93, #new_hint = dementlearn_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 93, #new_hint = dementlearn_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 93, #new_hint = dementlearn_failure_2 );
   }
   else
   {
      debug( "Error building QN #93" );
   }
   % template #94 is dement learn quest, come back
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #timelimit = 24 * 3600 )    % 1 day
   {
      send( self, @SetQuestNodeSuccessHint, #index = 94, #new_hint = dementlearn_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 94, #new_hint = dementlearn_failure_3 );
   }
   else
   {
      debug( "Error building QN #94" );
   }

   % template #95 is sporeburst learn quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DarkWizard ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 95, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #95" );
   }
   % template #96 is sporeburst learn quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingShalille, 1 ],[ QN_PRIZETYPE_ITEMCLASS, &OfferingFaren, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &OfferingKraanan, 1 ],[ QN_PRIZETYPE_ITEMCLASS, &OfferingRiija, 1 ] ],
         #timelimit = 2 * 24 * 3600 )    % 2 days
   {
      send( self, @SetQuestNodeAssignHint, #index = 96, #new_hint = sporeburstlearn_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 96, #new_hint = sporeburstlearn_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 96, #new_hint = sporeburstlearn_failure_2 );
   }
   else
   {
      debug( "Error building QN #96" );
   }
   % template #97 is sporeburst learn quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingQor, 1 ] ],
         #timelimit = 2 * 24 * 3600 )    % 2 days
   {
      send( self, @SetQuestNodeAssignHint, #index = 97, #new_hint = sporeburstlearn_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 97, #new_hint = sporeburstlearn_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 97, #new_hint = sporeburstlearn_failure_2 );
   }
   else
   {
      debug( "Error building QN #97" );
   }

   % template #98 is polish seraphym quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanShopkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 98, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #98" );
   }
   % template #99 is polish seraphym quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &UncutSeraphym, 3 ] ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &PolishedSeraphym, 1 ] ],
         #timelimit = 12 * 3600 )    % 12 hours
   {
      send( self, @SetQuestNodeAssignHint, #index = 99, #new_hint = polishquest_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 99, #new_hint = polishquest_success );
      send( self, @SetQuestNodeFailureHint, #index = 99, #new_hint = polishquest_failure );
   }
   else
   {
      debug( "Error building QN #99" );
   }
   
   % template #100 is priestess insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ priestessinsignia_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Temples, #onIsland=false ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 100, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #100" );
   }
   % template #101 is priestess insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ priestessinsignia_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 101, #new_hint = priestessinsignia_assign_2 );
   }
   else
   {
      debug( "Error building QN #101" );
   }
   % template #102 is priestess insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &KriipaClaw, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &PolishedSeraphym, 5 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DragonflyEye, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ShamanBlood, 10 ] ],
         #prizelist = [ [ QN_PRIZETYPE_INSIGNIA ] ],
         #timelimit = 12 * 3600 )    % 12 hrs
   {
      send( self, @SetQuestNodeAssignHint, #index = 102, #new_hint = priestessinsignia_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 102, #new_hint = priestessinsignia_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 102, #new_hint = priestessinsignia_failure_3 );
   }
   else
   {
      debug( "Error building QN #102" );
   }
   
   % template #103 is monk insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ monkinsignia_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Temples, #onIsland=true ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 103, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #103" );
   }
   % template #104 is monk insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ monkinsignia_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 104, #new_hint = monkinsignia_assign_2 );
   }
   else
   {
      debug( "Error building QN #104" );
   }
   % template #105 is monk insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &DarkAngelFeather, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &PurpleMushroom, 40 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &BlueDragonScale, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &OrcTooth, 40 ] ],
         #prizelist = [ [ QN_PRIZETYPE_INSIGNIA ] ],
         #timelimit = 12 * 3600 )    % 12 hrs
   {
      send( self, @SetQuestNodeAssignHint, #index = 105, #new_hint = monkinsignia_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 105, #new_hint = monkinsignia_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 105, #new_hint = monkinsignia_failure_3 );
   }
   else
   {
      debug( "Error building QN #105" );
   }
   
   % template #106 is faction insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ factioninsignia_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Factions, #onIsland=false ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 106, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #106" );
   }
   % template #107 is faction insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ factioninsignia_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index = 107, #new_hint = factioninsignia_assign_2 );
   }
   else
   {
      debug( "Error building QN #107" );
   }
   % template #108 is faction insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ factioninsignia_trigger_3a,
                        factioninsignia_trigger_3b,
                        factioninsignia_trigger_3c,
                        factioninsignia_trigger_3d,
                        factioninsignia_trigger_3e,
                        factioninsignia_trigger_3f,
                        factioninsignia_trigger_3g],
         #timelimit = 2 * 3600 )    % 2 hrs
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionTown ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperTown ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 108, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 108, #new_hint = factioninsignia_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 108, #new_hint = factioninsignia_failure_3 );
   }
   else
   {
      debug( "Error building QN #108" );
   }
   % template #109 is faction insignia quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ factioninsignia_trigger_4a,
                        factioninsignia_trigger_4b,
                        factioninsignia_trigger_4c,
                        factioninsignia_trigger_4d,
                        factioninsignia_trigger_4e,
                        factioninsignia_trigger_4f ],
         #prizelist = [ [ QN_PRIZETYPE_INSIGNIA ] ],
         #timelimit = 2 * 3600 )    % 2 hrs
   {
      send( self, @SetQuestNodeAssignHint, #index = 109, #new_hint = factioninsignia_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 109, #new_hint = factioninsignia_success_4 );
      send( self, @SetQuestNodeFailureHint, #index = 109, #new_hint = factioninsignia_failure_4 );
   }
   else
   {
      debug( "Error building QN #109" );
   }

   % template #110 is mystery monster quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_TAILOR, #onIsland = FALSE ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index =110 , #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #110" );
   }
   % template #111 is mystery monster quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ mysterymonster_trigger_2 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index =111 , #new_hint = mysterymonster_assign_2 );
   }
   else
   {
      debug( "Error building QN #111" );
   }
   % template #112 is mystery monster quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ mysterymonster_trigger_3 ],
         #timelimit = 60 )    % 1 minute
   {
      send( self, @SetQuestNodeAssignHint, #index =112 , #new_hint = mysterymonster_assign_3 );
   }
   else
   {
      debug( "Error building QN #112" );
   }
   % template #113 is mystery monster quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MONSTER_ITEMCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &DressPattern, 1 ] ],
         #monsterlist = [ &SpiderBaby, &SpiderBaby, &Centipede, &Centipede, &Centipede, &Spider, &Ant ],
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &DiscipleRobe, 1 ] ],
         #timelimit = 2 * 24 * 3600 )    %2 days
   {
      send( self, @SetQuestNodeAssignHint, #index =113 , #new_hint = mysterymonster_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index =113 , #new_hint = mysterymonster_success_4 );
      send( self, @SetQuestNodeFailureHint, #index =113 , #new_hint = mysterymonster_failure_4 );
   }
   else
   {
      debug( "Error building QN #113" );
   }
   
   
   
   % template #114 is Moxal scam quest #1
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index =114 , #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #114" );
   }
   % template #115 is Moxal scam quest #1
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ moxalscam1_trigger_2 ],
         #timelimit = 2 * 60 )    % 2 minutes
   {
      send( self, @SetQuestNodeAssignHint, #index =115 , #new_hint = moxalscam1_assign_2 );
   }
   else
   {
      debug( "Error building QN #115" );
   }
   % template #116 is Moxal scam quest #1
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &ScamScroll, 1 ] ],
         #timelimit = 4 * 3600 )    % 4 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanTown ) {
         if not isClass(oNPC, &KocatanBonePriestess) and not isClass(oNPC, &KocatanSentry) and
                  not isClass(oNPC, &KocatanInnkeeper)
         {
            lNPCs = cons( oNPC, lNPCs );
         }
      }
      send( self, @SetQuestNodeNPCList, #index =116 , #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index =116, #new_hint = moxalscam1_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index =116 , #new_hint = moxalscam1_failure_3 );
   }
   else
   {
      debug( "Error building QN #116" );
   }
   % template #117 is Moxal scam quest #1
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &ScamScroll, 1 ] ],
         #timelimit = 3 * 3600 )    % 4 hours
   {
      send( self, @SetQuestNodeNPCList, #index =117 , #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index =117 , #new_hint = moxalscam1_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index =117 , #new_hint = moxalscam1_failure_4 );
   }
   else
   {
      debug( "Error building QN #117" );
   }
   % template #118 is Moxal scam quest #1
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &ScamScroll, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],[ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],[ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],[ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],[ QN_PRIZETYPE_ITEMCLASS, &Mace, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &BlindWand, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &ShortSword, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &ShortSword, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &ShortSword, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &MysticSword, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &PlateArmor, 1 ],
                           [ QN_PRIZETYPE_ITEMCLASS, &Key, 1 ] ] ],
         #timelimit = 2 * 3600 )    % 4 hours
   {
      send( self, @SetQuestNodeNPCList, #index =118 , #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index =118 , #new_hint = moxalscam1_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index =118 , #new_hint = moxalscam1_success_5 );
      send( self, @SetQuestNodeFailureHint, #index =118 , #new_hint = moxalscam1_failure_4 );
   }
   else
   {
      debug( "Error building QN #118" );
   }

   % template #119 is Moxal scam quest #2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index =119 , #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #119" );
   }
   % template #120 is Moxal scam quest #2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #timelimit = 4 * 3600 )    % 4 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanTown ) {
         if not isClass(oNPC, &KocatanBonePriestess) and not isClass(oNPC, &KocatanSentry) {
            lNPCs = cons( oNPC, lNPCs );
         }
      }
      send( self, @SetQuestNodeNPCList, #index = 120, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 120, #new_hint = moxalscam2_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 120, #new_hint = moxalscam2_failure );
   }
   else
   {
      debug( "Error building QN #120" );
   }
   % template #121 is Moxal scam quest #2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ moxalscam2_trigger_3 ],
         #timelimit = 4 * 3600 )    % 4 hours
   {
      send( self, @SetQuestNodeAssignHint, #index = 121, #new_hint = moxalscam2_assign_3 );
   }
   else
   {
      debug( "Error building QN #121" );
   }
   % template #122 is Moxal scam quest #2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #timelimit = 4 * 3600 )    % 4 hours
   {
      send( self, @SetQuestNodeAssignHint, #index = 122, #new_hint = moxalscam2_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 122, #new_hint = moxalscam2_failure );
   }
   else
   {
      debug( "Error building QN #122" );
   }
   % template #123 is Moxal scam quest #2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ moxalscam2_trigger_3 ],
         #timelimit = 4 * 3600 )    % 4 hours
   {
      send( self, @SetQuestNodeAssignHint, #index = 123, #new_hint = moxalscam2_assign_5 );
      send( self, @SetQuestNodeSuccessHint, #index = 123, #new_hint = moxalscam2_success_5 );
   }
   else
   {
      debug( "Error building QN #123" );
   }

   % template #124 is council letter quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_INNKEEPER ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 124, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #124" );
   }
   % template #125 is council letter quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &CouncilLetter, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 750 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 750 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ] ] ],
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Council ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 125, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 125, #new_hint = council_letter_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 125, #new_hint = council_letter_success );
      send( self, @SetQuestNodeFailureHint, #index = 125, #new_hint = council_letter_failure );
   }
   else
   {
      debug( "Error building QN #125" );
   }

   % template #126 is chess quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Council ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &PrincessLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueClerk ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothTailor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothSergeant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 126, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #126" );
   }
   % template #127 is chess quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ chess_trigger ],
         #timelimit = 2 * 60 )    % 2 minutes
   {
      send( self, @SetQuestNodeAssignHint, #index = 127, #new_hint = chess_assign_2 );
   }
   else
   {
      debug( "Error building QN #127" );
   }
   % template #128 is chess quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_CHESSMOVE, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      send( self, @SetQuestNodeNPCList, #index = 128, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 128, #new_hint = chess_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 128, #new_hint = chess_failure );
   }
   else
   {
      debug( "Error building QN #128" );
   }
   % template #129 is chess quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_CHESSMOVE, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 700 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 800 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ] ] ],
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      send( self, @SetQuestNodeAssignHint, #index = 129, #new_hint = chess_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 129, #new_hint = chess_success_4 );
      send( self, @SetQuestNodeFailureHint, #index = 129, #new_hint = chess_failure );
   }
   else
   {
      debug( "Error building QN #129" );
   }
   
   % template #130 is chess checkmate quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      send( self, @SetQuestNodeNPCList, #index = 130, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #130" );
   }
   % template #131 is chess checkmate quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ chess_trigger ],
         #timelimit = 2 * 60 )    % 2 minutes
   {
      send( self, @SetQuestNodeAssignHint, #index = 131, #new_hint = chess_assign_2 );
   }
   else
   {
      debug( "Error building QN #131" );
   }
   % template #132 is chess checkmate quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_CHESSMOVE, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      send( self, @SetQuestNodeNPCList, #index = 132, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 132, #new_hint = chess_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 132, #new_hint = chess_failure );
   }
   else
   {
      debug( "Error building QN #132" );
   }
   % template #133 is chess checkmate quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_CHESSMOVE, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      send( self, @SetQuestNodeAssignHint, #index = 133, #new_hint = chess_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 133, #new_hint = chess_failure );
   }
   else
   {
      debug( "Error building QN #133" );
   }
   % template #134 is chess checkmate quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_CHESSMOVE, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 2000 ] ] ],
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      send( self, @SetQuestNodeAssignHint, #index = 134, #new_hint = chess_checkmate_assign_5 );
      send( self, @SetQuestNodeSuccessHint, #index = 134, #new_hint = chess_checkmate_success_5 );
      send( self, @SetQuestNodeFailureHint, #index = 134, #new_hint = chess_failure );
   }
   else
   {
      debug( "Error building QN #134" );
   }

   % template #135 is love letter quest 1
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &GuildCreator ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RebelLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 135, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #135" );
   }
   % template #136 is love letter quest 1
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &LoveLetter, 1 ] ],
         %#cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &LoveLetter, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &Rose, 1 ] ], % had to delete the rose for text consistency.
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 400 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 700 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 550 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 650 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 400 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 700 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 550 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 650 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 450 ], [ QN_PRIZETYPE_ITEMCLASS, &Key, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SeduceWand, 1] ] ],
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Barloquetailor ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 136, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 136, #new_hint = love_letter_1_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 136, #new_hint = love_letter_1_success );
      send( self, @SetQuestNodeFailureHint, #index = 136, #new_hint = love_letter_failure );
   }
   else
   {
      debug( "Error building QN #136" );
   }

   % template #137 is love letter quest 2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Barloquetailor ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 137, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #137" );
   }
   % template #138 is love letter quest 2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &LoveLetter, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 400 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 700 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 550 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 650 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 450 ], [ QN_PRIZETYPE_ITEMCLASS, &Key, 1 ] ] ],
         #timelimit = 6 * 3600 )    % 6 hrs
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &GuildCreator ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RebelLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 138, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 138, #new_hint = love_letter_2_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 138, #new_hint = love_letter_2_success );
      send( self, @SetQuestNodeFailureHint, #index = 138, #new_hint = love_letter_failure );
   }
   else
   {
      debug( "Error building QN #138" );
   }

   % template #139 is necroguild quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DeadLich ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 139, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #139" );
   }
   % template #140 is necromancer guild quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ necroguild_trigger_2 ],
         #timelimit = 120 )    % 2 min
   {
      send( self, @SetQuestNodeAssignHint, #index = 140, #new_hint = necroguild_assign_2 );
   }
   else
   {
      debug( "Error building QN #140" );
   }
   % template #141 is necromancer guild quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &OfferingQor, 1 ] ],
         #prizelist = [ [ QN_PRIZETYPE_ESTABLISH_NECROGUILD ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_MYSTICISM , -3, 2 ] ],
         #timelimit = 3 * 24 * 3600 )    % 3 days
   {
      send( self, @SetQuestNodeAssignHint, #index = 141, #new_hint = necroguild_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 141, #new_hint = necroguild_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 141, #new_hint = necroguild_failure_3 );
   }
   else
   {
      debug( "Error building QN #141" );
   }

   % template #142 is aphrodesiac quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KraananPriestess ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueTailor ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 142, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #142" );
   }
   % template #143 is aphrodesiac quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ aphrodesiac_trigger_2 ],
         #timelimit = 3600 )    % 1 hour
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Heretic ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 143, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 143, #new_hint = aphrodesiac_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 143, #new_hint = aphrodesiac_failure_2 );
   }
   else
   {
      debug( "Error building QN #143" );
   }
   % template #144 is aphrodesiac quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &SpiderEgg, 1 ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      send( self, @SetQuestNodeAssignHint, #index = 144, #new_hint = aphrodesiac_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 144, #new_hint = aphrodesiac_failure_3 );
   }
   else
   {
      debug( "Error building QN #144" );
   }
   % template #145 is aphrodesiac quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &AphrodesiacPotion, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1400 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1800 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 2000 ] ] ],
         #timelimit = 3600 )    % 1 hour
   {
      send( self, @SetQuestNodeAssignHint, #index = 145, #new_hint = aphrodesiac_assign_4 );
      send( self, @SetQuestNodeSuccessHint, #index = 145, #new_hint = aphrodesiac_success_4 );
      send( self, @SetQuestNodeFailureHint, #index = 145, #new_hint = aphrodesiac_failure_4 );
   }
   else
   {
      debug( "Error building QN #145" );
   }

   % template #146 is necro warning quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DarkWizard ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 146, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #146" );
   }
   % template #147 is necro warning quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &NecromancerLetter, 1 ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -2, 1 ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KraananPriestess ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FarenPriestess ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ShalillePriestess ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &QorPriestess ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 147, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 147, #new_hint = necrowarning_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 147, #new_hint = necrowarning_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 147, #new_hint = necrowarning_failure_2 );
   }
   else
   {
      debug( "Error building QN #147" );
   }
   % template #148 is necro warning quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 800 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1200 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1400 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 10],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 15],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 20],
                        [ QN_PRIZETYPE_ITEMCLASS, &Prism, 1 ] ] ],
         #timelimit = 4 * 3600 )    % 4 hours
   {
      send( self, @SetQuestNodeSuccessHint, #index = 148, #new_hint = necrowarning_success_3 );
   }
   else
   {
      debug( "Error building QN #148" );
   }

   % template #149 is bar restock quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_BARTENDER ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 149, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #149" );
   }
   % template #150 is bar restock quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ barrestock_trigger_2 ],
         #timelimit = 3600 )    % 1 hour
   {
      send( self, @SetQuestNodeNPCList, #index = 150, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 150, #new_hint = barrestock_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 150, #new_hint = barrestock_failure_2 );
   }
   else
   {
      debug( "Error building QN #150" );
   }
   % template #151 is bar restock quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &StoutGoblet, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Goblet, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &WineGoblet, 40 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1300 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1400 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1700 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1800 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1900 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 2000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 25 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 35 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 25 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 35 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ShadowformPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &KaraholsCursePotion, 1 ] ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      send( self, @SetQuestNodeAssignHint, #index = 151, #new_hint = barrestock_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 151, #new_hint = barrestock_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 151, #new_hint = barrestock_failure_3 );
   }
   else
   {
      debug( "Error building QN #151" );
   }

   % template #152 is catering quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &PrincessLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &OneCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TwoCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ThreeCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &fourCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FiveCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 152, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #152" );
   }
   % template #153 is catering quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ catering_trigger_2 ],
         #timelimit = 3600 )    % 1 hour
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #iJob = MOB_ROLE_INNKEEPER ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 153, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 153, #new_hint = catering_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 153, #new_hint = catering_failure_2 );
   }
   else
   {
      debug( "Error building QN #153" );
   }
   % template #154 is catering quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &SpidEye, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Grapes, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Goblet, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Soup, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Drumstick, 50 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1300 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1400 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1700 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1800 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1900 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 2000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 25 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 30 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &BaitPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectGoodPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectEvilPotion, 1 ] ] ],
         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -2, 2 ] ],
         #timelimit = 3600 )    % 1 hour
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &PrincessLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &OneCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TwoCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ThreeCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &fourCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FiveCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 154, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 154, #new_hint = catering_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 154, #new_hint = catering_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 154, #new_hint = catering_failure_3 );
   }
   else
   {
      debug( "Error building QN #154" );
   }

   % template #155 is smithy ore quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ])
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueBlacksmith ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBlacksmith ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBlacksmith ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 155, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #155" );
   }
   % template #156 is smithy ore quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &CheapOreChunk, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 300 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 400 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 450 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 650 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 750 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 550 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 25 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 35 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 25 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 30 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 35 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Axe, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &MysticSword, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Flask, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &StrengthPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &HastePotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &MagicShieldPotion, 1 ] ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      send( self, @SetQuestNodeNPCList, #index = 156, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 156, #new_hint = ore_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 156, #new_hint = ore_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 156, #new_hint = ore_failure_2 );
   }
   else
   {
      debug( "Error building QN #156" );
   }

   % template #157 is apothecary quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ])
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 157, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #157" );
   }
   % template #158 is apothecary quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &PolishedSeraphym, 2 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &UncutSeraphym, 5 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DarkAngelFeather, 5 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &PurpleMushroom, 10 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &BlueDragonScale, 5 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &OrcTooth, 10 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Mushroom, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &KriipaClaw, 5 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DragonflyEye, 5 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 650 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 650 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 750 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 700 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 750 ],[ QN_PRIZETYPE_ITEMCLASS, &Money, 800 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectInvisibilityPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NightVisionPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &VampireWand, 1 ] ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      send( self, @SetQuestNodeNPCList, #index = 158, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 158, #new_hint = apothecary_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 158, #new_hint = apothecary_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 158, #new_hint = apothecary_failure_2 );
   }
   else
   {
      debug( "Error building QN #158" );
   }

   % template #159 is vault tax quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ])
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueVaultman ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBanker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosBanker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 159, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #159" );
   }
   % template #160 is vault tax quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1302 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1133 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1576 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1230 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1614 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1735 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1431 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1638 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1037 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 2209 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &InkyCap, 7 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &EntrootBerry, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &OrcTooth, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectInvisibilityPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectGoodPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectEvilPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &IllusionaryFormPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 30 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 30 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NodeBurstPotion, 1 ] ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ], [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -20, 7] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 160, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 160, #new_hint = vaulttax_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 160, #new_hint = vaulttax_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 160, #new_hint = vaulttax_failure_2 );
   }
   else
   {
      debug( "Error building QN #160" );
   }

   % template #161 is merchant tax quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ])
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CornothGrocer ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 161, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #161" );
   }
   % template #162 is merchant tax quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 130 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 113 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 157 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 123 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 161 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 173 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 143 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 163 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 103 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 220 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &InkyCap, 4 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &EntrootBerry, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &OrcTooth, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectInvisibilityPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectGoodPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectEvilPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &IllusionaryFormPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NodeBurstPotion, 1 ] ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 162, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 162, #new_hint = merchanttax_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 162, #new_hint = merchanttax_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 162, #new_hint = merchanttax_failure_2 );
   }
   else
   {
      debug( "Error building QN #162" );
   }

   % template #163 is late tax quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 800 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1200 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1400 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 20 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectGoodPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectEvilPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &DetectInvisibilityPotion, 1 ] ] ],
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 163, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #163" );
   }
   % template #164 is late tax quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &TaxLetter, 1 ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CornothGrocer ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 164, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 164, #new_hint = latetax_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 164, #new_hint = latetax_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 164, #new_hint = latetax_failure_2 );
   }
   else
   {
      debug( "Error building QN #164" );
   }

   % template #165 is kocatan weapon trade quest, say "need a courier"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ])
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBowMaker ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 165, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #165" );
   }
   % template #166 is kocatan weapon trade quest, say "yes"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ chess_trigger ],
         #timelimit = 2 * 60 )    % 2 minutes
   {
      send( self, @SetQuestNodeAssignHint, #index = 166, #new_hint = kocweapon_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 166, #new_hint = kocweapon_failure_2 );
   }
   else
   {
      debug( "Error building QN #166" );
   }
   % template #167 is kocatan weapon trade quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Arrow, 100 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 50 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &InkyCap, 10 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Emerald, 6 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &IdentifyWand, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &PurifyWand, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistColdPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistFirePotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistMagicPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistPoisonPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistShockPotion, 1 ] ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ] ],
         #timelimit = 4 * 3600 )    % 4 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &PrincessLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 167, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 167, #new_hint = kocweapon_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 167, #new_hint = kocweapon_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 167, #new_hint = kocweapon_failure_3 );
   }
   else
   {
      debug( "Error building QN #167" );
   }

   % template #168 is kocatan ale trade quest, say "need a courier"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ])
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnKeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 168, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #168" );
   }
   % template #169 is kocatan ale trade quest, say "yes"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_SAME,
         #cargolist = [ chess_trigger ],
         #timelimit = 2 * 60 )    % 2 minutes
   {
      send( self, @SetQuestNodeAssignHint, #index = 169, #new_hint = kocale_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 169, #new_hint = kocale_failure_2 );
   }
   else
   {
      debug( "Error building QN #169" );
   }
   % template #170 is kocatan ale trade quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMCLASS, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Goblet, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &StoutGoblet, 50 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &wineGoblet, 40 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &mug, 50 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &InkyCap, 10 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &LongBow, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Arrow, 60 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &NeruditeArrow, 30 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &SilverArrow, 30 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &KaraholsCursePotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &HoldWand, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &FireRing, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ColdRing, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ShockRing, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &AcidRing, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistMagicPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistPoisonPotion, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &ResistShockPotion, 1 ] ] ],
         #penaltylist = [ [ QN_PRIZETYPE_OUTLAW ], [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_VIGOR, -20, 7] ],
         #timelimit = 4 * 3600 )    % 4 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBartender ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 170, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 170, #new_hint = kocale_assign_3 );
      send( self, @SetQuestNodeSuccessHint, #index = 170, #new_hint = kocale_success_3 );
      send( self, @SetQuestNodeFailureHint, #index = 170, #new_hint = kocale_failure_3 );
   }
   else
   {
      debug( "Error building QN #170" );
   }

   % template #171 is necro warning quest 2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ letter_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 171, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #171" );
   }
   % template #172 is necro warning quest 2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_NONE,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &NecromancerWarningLetter, 1 ] ],
         #timelimit = 2 * 3600 )    % 2 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KraananPriestess ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FarenPriestess ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ShalillePriestess ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &QorPriestess ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 172, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 172, #new_hint = necrowarning2_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 172, #new_hint = necrowarning2_success_2 );
      send( self, @SetQuestNodeFailureHint, #index = 172, #new_hint = necrowarning2_failure_2 );
   }
   else
   {
      debug( "Error building QN #172" );
   }
   % template #173 is necro warning quest 2
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP, #NPC_modifier = QN_NPCMOD_PREVIOUS,
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1200 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1400 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1600 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &VampireWand, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &VampireWand, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Prism, 1 ] ] ],
         #timelimit = 4 * 3600 )    % 4 hours
   {
      send( self, @SetQuestNodeSuccessHint, #index = 173, #new_hint = necrowarning2_success_3 );
   }
   else
   {
      debug( "Error building QN #173" );
   }

   % template #174 is the warletter quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ warletter_trigger1 ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RebelLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &OneCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TwoCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ThreeCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &fourCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FiveCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueVaultman ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBanker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosBanker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 174, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #174" );
   }
   
   % template #175 is warletter quest
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM, #NPC_modifier = QN_NPCMOD_DIFFERENT,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &WarLetter, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 2000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Longsword, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &VampireWand, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &InkyCap, 5 ] ],
                        [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 2000 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &Longsword, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &Gauntlet, 1 ],
                        [ QN_PRIZETYPE_ITEMCLASS, &InkyCap, 5 ] ] ],
         #timelimit = 3 * 3600 )    % 3 hrs
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RebelLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &OneCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TwoCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ThreeCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &fourCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &FiveCouncilor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueVaultman ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBanker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosBanker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 175, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 175, #new_hint = warletter_assign );
      send( self, @SetQuestNodeSuccessHint, #index = 175, #new_hint = warletter_success );
      send( self, @SetQuestNodeFailureHint, #index = 175, #new_hint = warletter_failure );
   }
   else
   {
      debug( "Error building QN #175" );
   }

   % template #176 is potion ID quest kickoff, "need a courier"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ identify_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CornothGrocer ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothSergeant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBanker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionElder ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnKeeper ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 176, #new_NPC_list = lNPCs);
   }
   else
   {
      debug( "Error building QN #176" );
   }
   % template #177 is potion ID quest, deliver the mystery potion
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &MysteryPotion, 1 ] ],
         #timelimit = 6 * 3600 ) % time limit is 6 hours
   {
      lNPCs = $;
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary )),lNPCs);
      send( self, @SetQuestNodeNPCList, #index = 177, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 177, #new_hint = potion_identify_assign_1 );
      send( self, @SetQuestNodeFailureHint, #index = 177, #new_hint = potion_identify_failure_1 );
   }
   else
   {
      debug( "Error building QN #177" );
   }
   % template #178 is potion ID quest, come back and give the labeled potion
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &LabeledPotion, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ],
                          [ QN_PRIZETYPE_ITEMCLASS, &MeatPie, 4 ], [ QN_PRIZETYPE_ITEMCLASS, &Cheese, 3 ],
                          [ QN_PRIZETYPE_ITEMCLASS, &ShortSword, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &Hammer, 1 ] ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 178, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 178, #new_hint = potion_identify_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 178, #new_hint = potion_identify_success );
      send( self, @SetQuestNodeFailureHint, #index = 178, #new_hint = potion_identify_failure_2 );
   }
   else
   {
      debug( "Error building QN #178" );
   }

   % template #179 is wand ID quest kickoff, "need a courier"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ identify_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Barloquetailor ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CornothGrocer ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperMerchant ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBlacksmith ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionElder ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 179, #new_NPC_list = lNPCs);
   }
   else
   {
      debug( "Error building QN #179" );
   }
   % template #180 is wand ID quest, deliver the mystery potion
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &MysteryWand, 1 ] ],
         #timelimit = 6 * 3600 ) % time limit is 6 hours
   {
      lNPCs = $;
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary )),lNPCs);
      send( self, @SetQuestNodeNPCList, #index = 180, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 180, #new_hint = wand_identify_assign_1 );
      send( self, @SetQuestNodeFailureHint, #index = 180, #new_hint = wand_identify_failure_1 );
   }
   else
   {
      debug( "Error building QN #180" );
   }
   % template #181 is wand ID quest, come back and give the labeled potion
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEM,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &LabeledWand, 1 ] ],
         #prizelist = [ [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 1000 ], [ QN_PRIZETYPE_ITEMCLASS, &Money, 1500 ],
                          [ QN_PRIZETYPE_ITEMCLASS, &MeatPie, 4 ], [ QN_PRIZETYPE_ITEMCLASS, &Cheese, 3 ],
                          [ QN_PRIZETYPE_ITEMCLASS, &ShortSword, 1 ], [ QN_PRIZETYPE_ITEMCLASS, &Hammer, 500 ] ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 181, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 181, #new_hint = wand_identify_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 181, #new_hint = wand_identify_success );
      send( self, @SetQuestNodeFailureHint, #index = 181, #new_hint = wand_identify_failure_2 );
   }
   else
   {
      debug( "Error building QN #181" );
   }

   % template #182 is Princess's Murder Mystery quest kickoff, "murder"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ murder_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &PrincessLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 182, #new_NPC_list = lNPCs);
   }
   else
   {
      debug( "Error building QN #182" );
   }
   % template #183 is Princess's Murder Mystery quest, "deliver" the trigger.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ murder_trigger ],
         #timelimit = 6 * 3600 ) % time limit is 6 hours
   {
      lNPCs = $;
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBartender )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueVaultMan )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueTailor )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueMerchant )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothSergeant )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBlacksmith )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionInnkeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBartender )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnkeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BasicInnKeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &OneCouncilor )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel )),lNPCs);
      send( self, @SetQuestNodeNPCList, #index = 183, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 183, #new_hint = murder_princess_assign );
   }
   else
   {
      debug( "Error building QN #183" );
   }
   lCargo  = [ murder_jonas_w_1, murder_jonas_w_2, murder_jonas_w_3, murder_jonas_w_4, murder_jonas_w_5,
               murder_jonas_m_1, murder_jonas_m_2, murder_jonas_m_3, murder_jonas_m_4, murder_jonas_m_5,
               murder_jonas_c_1, murder_jonas_c_2, murder_jonas_c_3, murder_jonas_c_4, murder_jonas_c_5,
               murder_akardius_w_1, murder_akardius_w_2, murder_akardius_w_3, murder_akardius_w_4, murder_akardius_w_5,
               murder_akardius_m_1, murder_akardius_m_2, murder_akardius_m_3, murder_akardius_m_4, murder_akardius_m_5 ];
   lCargo2 = [ murder_akardius_c_1, murder_akardius_c_2, murder_akardius_c_3, murder_akardius_c_4, murder_akardius_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #184 is Princess's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 184, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 184, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 184, #new_hint = murder_princess_success );
   }
   else
   {
      debug( "Error building QN #184" );
   }
   lCargo  = [ murder_miriana_w_1, murder_miriana_w_2, murder_miriana_w_3, murder_miriana_w_4, murder_miriana_w_5,
               murder_miriana_m_1, murder_miriana_m_2, murder_miriana_m_3, murder_miriana_m_4, murder_miriana_m_5,
               murder_miriana_c_1, murder_miriana_c_2, murder_miriana_c_3, murder_miriana_c_4, murder_miriana_c_5,
               murder_lich_w_1, murder_lich_w_2, murder_lich_w_3, murder_lich_w_4, murder_lich_w_5,
               murder_lich_m_1, murder_lich_m_2, murder_lich_m_3, murder_lich_m_4, murder_lich_m_5 ];
   lCargo2 = [ murder_lich_c_1, murder_lich_c_2, murder_lich_c_3, murder_lich_c_4, murder_lich_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #185 is Princess's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 185, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 185, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 185, #new_hint = murder_princess_success );
   }
   else
   {
      debug( "Error building QN #185" );
   }
   lCargo  = [ murder_maleval_w_1, murder_maleval_w_2, murder_maleval_w_3, murder_maleval_w_4, murder_maleval_w_5,
               murder_maleval_m_1, murder_maleval_m_2, murder_maleval_m_3, murder_maleval_m_4, murder_maleval_m_5,
               murder_maleval_c_1, murder_maleval_c_2, murder_maleval_c_3, murder_maleval_c_4, murder_maleval_c_5,
               murder_roq_w_1, murder_roq_w_2, murder_roq_w_3, murder_roq_w_4, murder_roq_w_5,
               murder_roq_m_1, murder_roq_m_2, murder_roq_m_3, murder_roq_m_4, murder_roq_m_5 ];
   lCargo2 = [ murder_roq_c_1, murder_roq_c_2, murder_roq_c_3, murder_roq_c_4, murder_roq_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #186 is Princess's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 186, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 186, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 186, #new_hint = murder_princess_success );
   }
   else
   {
      debug( "Error building QN #186" );
   }

   % template #187 is Duke's Murder Mystery quest kickoff, "murder"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ murder_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &DukeLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 187, #new_NPC_list = lNPCs);
   }
   else
   {
      debug( "Error building QN #185" );
   }
   % template #188 is Duke's Murder Mystery quest, "deliver" the trigger.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ murder_trigger ],
         #timelimit = 6 * 3600 ) % time limit is 6 hours
   {
      lNPCs = $;
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBartender )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBanker )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueVaultMan )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CornothInnkeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBlacksmith )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBanker )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionInnkeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBartender )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnkeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &ThreeCouncilor )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TwoCouncilor )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel )),lNPCs);
      send( self, @SetQuestNodeNPCList, #index = 188, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 188, #new_hint = murder_duke_assign );
   }
   else
   {
      debug( "Error building QN #188" );
   }
   lCargo  = [ murder_jonas_w_1, murder_jonas_w_2, murder_jonas_w_3, murder_jonas_w_4, murder_jonas_w_5,
               murder_jonas_m_1, murder_jonas_m_2, murder_jonas_m_3, murder_jonas_m_4, murder_jonas_m_5,
               murder_jonas_c_1, murder_jonas_c_2, murder_jonas_c_3, murder_jonas_c_4, murder_jonas_c_5,
               murder_princess_w_1, murder_princess_w_2, murder_princess_w_3, murder_princess_w_4, murder_princess_w_5,
               murder_princess_m_1, murder_princess_m_2, murder_princess_m_3, murder_princess_m_4, murder_princess_m_5 ];
   lCargo2 = [ murder_princess_c_1, murder_princess_c_2, murder_princess_c_3, murder_princess_c_4, murder_princess_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #189 is Duke's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 189, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 189, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 189, #new_hint = murder_duke_success );
   }
   else
   {
      debug( "Error building QN #189" );
   }
   lCargo  = [ murder_miriana_w_1, murder_miriana_w_2, murder_miriana_w_3, murder_miriana_w_4, murder_miriana_w_5,
               murder_miriana_m_1, murder_miriana_m_2, murder_miriana_m_3, murder_miriana_m_4, murder_miriana_m_5,
               murder_miriana_c_1, murder_miriana_c_2, murder_miriana_c_3, murder_miriana_c_4, murder_miriana_c_5,
               murder_lich_w_1, murder_lich_w_2, murder_lich_w_3, murder_lich_w_4, murder_lich_w_5,
               murder_lich_m_1, murder_lich_m_2, murder_lich_m_3, murder_lich_m_4, murder_lich_m_5 ];
   lCargo2 = [ murder_lich_c_1, murder_lich_c_2, murder_lich_c_3, murder_lich_c_4, murder_lich_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #190 is Duke's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 190, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 190, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 190, #new_hint = murder_duke_success );
   }
   else
   {
      debug( "Error building QN #190" );
   }
   lCargo  = [ murder_maleval_w_1, murder_maleval_w_2, murder_maleval_w_3, murder_maleval_w_4, murder_maleval_w_5,
               murder_maleval_m_1, murder_maleval_m_2, murder_maleval_m_3, murder_maleval_m_4, murder_maleval_m_5,
               murder_maleval_c_1, murder_maleval_c_2, murder_maleval_c_3, murder_maleval_c_4, murder_maleval_c_5,
               murder_roq_w_1, murder_roq_w_2, murder_roq_w_3, murder_roq_w_4, murder_roq_w_5,
               murder_roq_m_1, murder_roq_m_2, murder_roq_m_3, murder_roq_m_4, murder_roq_m_5 ];
   lCargo2 = [ murder_roq_c_1, murder_roq_c_2, murder_roq_c_3, murder_roq_c_4, murder_roq_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #191 is Duke's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 500 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 191, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 191, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 191, #new_hint = murder_duke_success );
   }
   else
   {
      debug( "Error building QN #191" );
   }

   % template #192 is Jonas's Murder Mystery quest kickoff, "murder"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ murder_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &RebelLiege ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 192, #new_NPC_list = lNPCs);
   }
   else
   {
      debug( "Error building QN #192" );
   }
   % template #193 is Jonas's Murder Mystery quest, "deliver" the trigger.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ murder_trigger ],
         #timelimit = 6 * 3600 ) % time limit is 6 hours
   {
      lNPCs = $;
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueApothecary )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BarloqueVaultMan )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBlacksmith )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionInnkeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBartender )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosApothecary )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnkeeper )),lNPCs);
      lNPCs = cons(first(send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &BasicInnKeeper )),lNPCs);
      send( self, @SetQuestNodeNPCList, #index = 193, #new_NPC_list = lNPCs );
      send( self, @SetQuestNodeAssignHint, #index = 193, #new_hint = murder_jonas_assign );
   }
   else
   {
      debug( "Error building QN #193" );
   }
   lCargo  = [ murder_princess_w_1, murder_princess_w_2, murder_princess_w_3, murder_princess_w_4, murder_princess_w_5,
               murder_princess_m_1, murder_princess_m_2, murder_princess_m_3, murder_princess_m_4, murder_princess_m_5,
               murder_princess_c_1, murder_princess_c_2, murder_princess_c_3, murder_princess_c_4, murder_princess_c_5,
               murder_akardius_w_1, murder_akardius_w_2, murder_akardius_w_3, murder_akardius_w_4, murder_akardius_w_5,
               murder_akardius_m_1, murder_akardius_m_2, murder_akardius_m_3, murder_akardius_m_4, murder_akardius_m_5 ];
   lCargo2 = [ murder_akardius_c_1, murder_akardius_c_2, murder_akardius_c_3, murder_akardius_c_4, murder_akardius_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #194 is Jonas's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 400 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 194, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 194, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 194, #new_hint = murder_jonas_success );
   }
   else
   {
      debug( "Error building QN #194" );
   }
   lCargo  = [ murder_miriana_w_1, murder_miriana_w_2, murder_miriana_w_3, murder_miriana_w_4, murder_miriana_w_5,
               murder_miriana_m_1, murder_miriana_m_2, murder_miriana_m_3, murder_miriana_m_4, murder_miriana_m_5,
               murder_miriana_c_1, murder_miriana_c_2, murder_miriana_c_3, murder_miriana_c_4, murder_miriana_c_5,
               murder_lich_w_1, murder_lich_w_2, murder_lich_w_3, murder_lich_w_4, murder_lich_w_5,
               murder_lich_m_1, murder_lich_m_2, murder_lich_m_3, murder_lich_m_4, murder_lich_m_5 ];
   lCargo2 = [ murder_lich_c_1, murder_lich_c_2, murder_lich_c_3, murder_lich_c_4, murder_lich_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #195 is Jonas's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 400 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 195, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 195, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 195, #new_hint = murder_jonas_success );
   }
   else
   {
      debug( "Error building QN #195" );
   }
   lCargo  = [ murder_maleval_w_1, murder_maleval_w_2, murder_maleval_w_3, murder_maleval_w_4, murder_maleval_w_5,
               murder_maleval_m_1, murder_maleval_m_2, murder_maleval_m_3, murder_maleval_m_4, murder_maleval_m_5,
               murder_maleval_c_1, murder_maleval_c_2, murder_maleval_c_3, murder_maleval_c_4, murder_maleval_c_5,
               murder_roq_w_1, murder_roq_w_2, murder_roq_w_3, murder_roq_w_4, murder_roq_w_5,
               murder_roq_m_1, murder_roq_m_2, murder_roq_m_3, murder_roq_m_4, murder_roq_m_5 ];
   lCargo2 = [ murder_roq_c_1, murder_roq_c_2, murder_roq_c_3, murder_roq_c_4, murder_roq_c_5,
               murder_random_w_1, murder_random_m_1, murder_random_c_1 ];
   for i in lCargo2
   {
      lCargo = cons(i, lCargo);
   }
   % template #196 is Jonas's Murder Mystery quest, come back and give the info
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = lCargo,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &Money, 400 ] ],
         #timelimit = 3 * 3600 ) % time limit is 3 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 196, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 196, #new_hint = murder_say );
      send( self, @SetQuestNodeSuccessHint, #index = 196, #new_hint = murder_jonas_success );
   }
   else
   {
      debug( "Error building QN #196" );
   }

   % template #197 is 1st Rebel loyalty node, say "loyalty" to Jonas
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ duke_standard1_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 197,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
                     #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &RebelLiege ) );
   }
   else
   {
      debug( "Error building QN #197" );
   }
   % template # 198 is 2nd Rebel Loyalty node, bring an item to Jonas
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_ITEMFINDCLASS,\
            #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &SimpleHelm, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Knightshield, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Gauntlet, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &LongSword, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &MysticSword, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Scimitar, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &NeruditeSword, 1 ] ],\
            #prizelist = [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_UPDATE ],
                          [ QN_PRIZETYPE_SCHEDULE_QUEST, QST_ID_REBEL_SERVICE ] ],
            #penaltylist = [ [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_NEUTRAL ] ] ],
            #timelimit = 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 198, #new_hint = rebel_standard2_assign);
      send( self, @SetQuestNodeSuccessHint, #index = 198, #new_hint = rebel_standard2_success );
      send( self, @SetQuestNodeFailureHint, #index = 198, #new_hint = rebel_standard2_failure );
   }
   else
   {
      debug( "Error building QN #198" );
   }

   % template #199 is 1st Rebel Join node, say "join" to Jonas
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ duke_join1_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 199,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
                     #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &RebelLiege ) );
   }
   else
   {
      debug( "Error building QN #199" );
   }
   % template # 200 is 2nd Rebel Join node, bring an item to Jonas
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_ITEMFINDCLASS,\
            #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &PlateArmor, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &SimpleHelm, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Knightshield, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Gauntlet, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &MysticSword, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Scimitar, 1 ],\
		           [ QN_PRIZETYPE_ITEMCLASS, &Scimitar, 1 ] ],\
            #prizelist = [ [ QN_PRIZETYPE_FACTION, QN_PRIZE_FACTION_REBEL ] ],
            #timelimit = 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 200, #new_hint = rebel_join2_assign);
      send( self, @SetQuestNodeSuccessHint, #index = 200, #new_hint = rebel_join2_success );
      send( self, @SetQuestNodeFailureHint, #index = 200, #new_hint = rebel_join2_failure );
   }
   else
   {
      debug( "Error building QN #200" );
   }

   % template #201 is Jala necklack kickoff
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ jala_necklace_trigger ] )
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &Minstrel ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 201, #new_NPC_list = lNPCs );
   }
   else
   {
      debug( "Error building QN #201" );
   }
   % template #202 is visiting Moxal
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ jala_necklace_trigger ],
         #timelimit = 6 * 3600 )  % time limit is 6 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 202, #new_NPC_list = lNPCs );

      send( self, @SetQuestNodeAssignHint, #index = 202, #new_hint = jala_necklace_assign_1 );
      send( self, @SetQuestNodeFailureHint, #index = 202, #new_hint = jala_necklace_failure_1 );
   }
   else
   {
      debug( "Error building QN #202" );
   }
   % template #203 is visiting an Innkeeper or Barkeep
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ jala_necklace_trigger_2 ],
         #timelimit = 6 * 3600 )  % time limit is 6 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperBartender ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &TosInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &CorNothInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionBartender ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 203, #new_NPC_list = lNPCs );

      send( self, @SetQuestNodeAssignHint, #index = 203, #new_hint = jala_necklace_assign_2 );
      send( self, @SetQuestNodeFailureHint, #index = 203, #new_hint = jala_necklace_failure_2 );
   }
   else
   {
      debug( "Error building QN #203" );
   }
   % template #204 is visiting an Elder/Wiseman for backup.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ jala_necklace_trigger_3 ],
         #timelimit = 6 * 3600 )  % time limit is 6 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanWeaponsMaster ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanBowMaker ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &PrincessLiege ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &MarionHealer ) { lNPCs = cons( oNPC, lNPCs );}
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &JasperElder ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 204, #new_NPC_list = lNPCs );

      send( self, @SetQuestNodeAssignHint, #index = 204, #new_hint = jala_necklace_assign_3 );
      send( self, @SetQuestNodeFailureHint, #index = 204, #new_hint = jala_necklace_failure_3 );
   }
   else
   {
      debug( "Error building QN #204" );
   }
   % template #205 is heading back to the Innkeeper or Barkeep.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE,
         #cargolist = [ jala_necklace_trigger_4 ],
         #timelimit = 6 * 3600 )  % time limit is 6 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 205, #new_mod = QN_NPCMOD_PREVIOUS );
      send( self, @SetQuestNodeAssignHint, #index = 205, #new_hint = jala_necklace_assign_4 );
      send( self, @SetQuestNodeFailureHint, #index = 205, #new_hint = jala_necklace_failure_4 );
   }
   else
   {
      debug( "Error building QN #205" );
   }
   % template #206 is brining in the Lute.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_ITEMFINDCLASS,
         #cargolist = [ [ QN_PRIZETYPE_ITEMCLASS, &Lute, 1 ] ],
         #timelimit = 6 * 3600 )  % time limit is 6 hours
   {
      send( self, @SetQuestNodeNPCModifier, #index = 206, #new_mod = QN_NPCMOD_SAME );
      send( self, @SetQuestNodeAssignHint, #index = 206, #new_hint = jala_necklace_assign_5 );
      send( self, @SetQuestNodeFailureHint, #index = 206, #new_hint = jala_necklace_failure_5 );
   }
   else
   {
      debug( "Error building QN #206" );
   }
   % template #207 is heading to Moxal and getting our final reward.
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_SHOWUP,
         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &JalaNecklace, 1 ] ],
         #timelimit = 6 * 3600 )  % time limit is 6 hours
   {
      lNPCs = $;
      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = &KocatanInnkeeper ) { lNPCs = cons( oNPC, lNPCs );}
      send( self, @SetQuestNodeNPCList, #index = 207, #new_NPC_list = lNPCs );

      send( self, @SetQuestNodeAssignHint, #index = 207, #new_hint = jala_necklace_assign_6 );
      send( self, @SetQuestNodeSuccessHint, #index = 207, #new_hint = jala_necklace_success );
      send( self, @SetQuestNodeFailureHint, #index = 207, #new_hint = jala_necklace_failure_6 );
   }
   else
   {
      debug( "Error building QN #207" );
   }

   % template #208 is 1st Duke Soldier Shield quest, say "soldier"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ faction_soldier_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 208,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
                     #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &DukeLiege ) );
   }
   else
   {
      debug( "Error building QN #208" );
   }
   % template #209 is 2nd Duke Soldier Shield quest, kill first faction soldier
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_MONSTER,\
            #monsterlist = [ &RebelTroop ],\
            #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 209, #new_hint = duke_faction_soldier_assign_1 );
      send( self, @SetQuestNodeFailureHint, #index = 209, #new_hint = duke_faction_soldier_failure );
   }
   else
   {
      debug( "Error building QN #209" );
   }
   % template #210 is 3rd Duke Soldier Shield quest, kill second faction soldier
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_MONSTER,\
            #monsterlist = [ &PrincessTroop ],\
            #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &DukeShield, 1 ] ],
            #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 210, #new_hint = duke_faction_soldier_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 210, #new_hint = duke_faction_soldier_success );
      send( self, @SetQuestNodeFailureHint, #index = 210, #new_hint = duke_faction_soldier_failure );
   }
   else
   {
      debug( "Error building QN #210" );
   }

   % template #211 is 1st Princess Soldier Shield quest, say "soldier"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ faction_soldier_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 211,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
                     #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &PrincessLiege ) );
   }
   else
   {
      debug( "Error building QN #211" );
   }
   % template #212 is 2nd Princess Soldier Shield quest, kill first faction soldier
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_MONSTER,\
            #monsterlist = [ &DukeTroop ],\
            #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 212, #new_hint = princess_faction_soldier_assign_1 );
      send( self, @SetQuestNodeFailureHint, #index = 212, #new_hint = princess_faction_soldier_failure );
   }
   else
   {
      debug( "Error building QN #212" );
   }
   % template #213 is 3rd Princess Soldier Shield quest, kill second faction soldier
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_MONSTER,\
            #monsterlist = [ &RebelTroop ],\
            #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &PrincessShield, 1 ] ],
            #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 213, #new_hint = princess_faction_soldier_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 213, #new_hint = princess_faction_soldier_success );
      send( self, @SetQuestNodeFailureHint, #index = 213, #new_hint = princess_faction_soldier_failure );
   }
   else
   {
      debug( "Error building QN #213" );
   }

   % template #214 is 1st Rebel Soldier Shield quest, say "soldier"
   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #cargolist = [ faction_soldier_trigger ] )
   {
      send( self, @SetQuestNodeNPCList, #index = 214,
            #new_NPC_list = send( send( SYS, @GetLibrary ), @GetOccupationList,
                     #iJob = MOB_ROLE_ROYALTY, #cNPC_class = &RebelLiege ) );
   }
   else
   {
      debug( "Error building QN #214" );
   }
   % template #215 is 2nd Rebel Soldier Shield quest, kill first faction soldier
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_MONSTER,\
            #monsterlist = [ &PrincessTroop ],\
            #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 215, #new_hint = rebel_faction_soldier_assign_1 );
      send( self, @SetQuestNodeFailureHint, #index = 215, #new_hint = rebel_faction_soldier_failure );
   }
   else
   {
      debug( "Error building QN #215" );
   }
   % template #216 is 3rd Rebel Soldier Shield quest, kill second faction soldier
   if send( self, @AddQuestNodeTemplate,\
            #NPC_modifier = QN_NPCMOD_SAME,\
            #questnode_type = QN_TYPE_MONSTER,\
            #monsterlist = [ &DukeTroop ],\
            #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &RebelShield, 1 ] ],
            #timelimit = 3 * 3600 )
   {
      send( self, @SetQuestNodeAssignHint, #index = 216, #new_hint = rebel_faction_soldier_assign_2 );
      send( self, @SetQuestNodeSuccessHint, #index = 216, #new_hint = rebel_faction_soldier_success );
      send( self, @SetQuestNodeFailureHint, #index = 216, #new_hint = rebel_faction_soldier_failure );
   }
   else
   {
      debug( "Error building QN #216" );
   }



%   % template # is  quest
%   if send( self, @AddQuestNodeTemplate, #questnode_type = QN_TYPE_MESSAGE, #NPC_modifier = QN_NPCMOD_NONE,
%         #cargolist = [  ],
%         #prizelist = [ [ QN_PRIZETYPE_ITEMCLASS, &, 1 ] ],
%         #penaltylist = [ [QN_PRIZETYPE_BOON, QN_PRIZE_BOON_INTELLECT , -6, 2 ] ],
%         #timelimit =  )    %
%   {
%      lNPCs = $;
%      for oNPC in send( send( SYS, @GetLibrary ), @GetOccupationList, #cNPC_class = & ) { lNPCs = cons( oNPC, lNPCs );}
%      send( self, @SetQuestNodeNPCList, #index = , #new_NPC_list = lNPCs );
%      send( self, @SetQuestNodeAssignHint, #index = , #new_hint =  );
%      send( self, @SetQuestNodeSuccessHint, #index = , #new_hint =  );
%      send( self, @SetQuestNodeFailureHint, #index = , #new_hint =  );
%   }
%   else
%   {
%      debug( "Error building QN #" );
%   }


   % resume if suspended
   send( self, @Suspend, #resume = 1 );

   % start timer
   ptQuestTimer = CreateTimer( self, @OnQuestTimer, 2000 );
   %send(self, @OnQuestTimer);

   % schedule faction loyalty quests up to max
   i = 0;
   iMax = Nth( send(self,@GetQuestTemplate,#index=QST_ID_PRINCESS_SERVICE), QT_MAX_NUM_ACTIVE );
   while i < iMax {
      i = i + 1;
      send(self,@ScheduleQuest,#index = QST_ID_PRINCESS_SERVICE, #override=TRUE);
   }
   i = 0;
   iMax = Nth( send(self,@GetQuestTemplate,#index=QST_ID_DUKE_SERVICE), QT_MAX_NUM_ACTIVE );
   while i < iMax {
      i = i + 1;
      send(self,@ScheduleQuest,#index = QST_ID_DUKE_SERVICE, #override=TRUE);
   }

   return;
}

%% AddQuestNodeTemplate:
%	Adds a new questnode template to plQuestNodeTemplates
%	Returns index number of new questnode template if successful, 0 otherwise
%	Creates new permanent strings, if successful.
%
	% QuestNodeTemplate is
	%	[	NPC list,
	%		NPC modifier,
	%		questnode type,
	%		cargo list,
	%		monster list,
	%		prizelist,
	%		penaltylist,
	%		assign hint,
	%		success hint,
	%		failure hint
	%		time limit	]
%%
AddQuestNodeTemplate(NPC_modifier = $,
	             questnode_type = $,
	             cargolist = $,
	             monsterlist = $,
	             prizelist = $, 
	             penaltylist = $,
	             timelimit = 0 )
{
	% Validity checks

	local NPC, lThisQuestNodeTemplate, iThisQNTIndex;

	% NPC modifier must be valid
	if( NPC_modifier = $ )
	{
		NPC_modifier = piDefaultNPCModifier;
	}
	if( ( NPC_modifier < QN_NPCMOD_NONE ) OR ( NPC_modifier > QN_NPCMOD_DIFFERENT ) )
	{
		return 0;
	}

	% Questnode type must be valid
	if( questnode_type = $ )
	{
		questnode_type = piDefaultQuestNodeType;
	}
	if( ( questnode_type < QN_TYPE_MESSAGE ) OR ( questnode_type > QN_TYPE_MONSTER_ITEMCLASS ) )
	{
		return 0;
	}

	% Cargolist must be valid
	if( cargolist = $ )
	{
		cargolist = [];
	}

	% Monsterlist must be valid
	if( monsterlist = $ )
	{
		monsterlist = [];
	}

	% Prizelist must be valid
	if( prizelist = $ )
	{
		prizelist = [];
	}

	% Time limit must be valid
	if( timelimit = 0 )
	{
		timelimit = piDefaultTimeLimit;
	}

	% Penaltylist must be valid
	if( penaltylist = $ )
	{
		penaltylist = [];
	}

	lThisQuestNodeTemplate = [ plDefaultNPCList, NPC_modifier, questnode_type,\
		cargolist, monsterlist, prizelist, penaltylist, CreateString(), CreateString(), CreateString(), timelimit ];

	%	Can only add to front of list
	plQuestNodeTemplates = Cons( lThisQuestNodeTemplate, plQuestNodeTemplates );

	iThisQNTIndex = Length( plQuestNodeTemplates );

	send( self, @SetQuestNodeNPCList, #index = iThisQNTIndex );
	send( self, @SetQuestNodeAssignHint, #index = iThisQNTIndex );
	send( self, @SetQuestNodeSuccessHint, #index = iThisQNTIndex );
	send( self, @SetQuestNodeFailureHint, #index = iThisQNTIndex );

	return iThisQNTIndex;
}

%% GetQuestNodeNPCModifier()
%	return the NPC modifier from a quest node template
%%
GetQuestNodeNPCModifier( index = $ )
{
	return Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_NPC_MODIFIER );
}

%% GetQuestNodeType( index )
%	Retrieves a questnode type by index number
%	Returns type if successful, $ otherwise
%%
GetQuestNodeType( index = 0 )
{
	return Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_TYPE );
}

GetQuestNodeAssignHint( index = 0 )
{
	return Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_ASSIGN_HINT );
}

GetQuestNodeSuccessHint( index = 0 )
{
	return Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_SUCCESS_HINT );
}

GetQuestNodeFailureHint( index = 0 )
{
	return Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_FAILURE_HINT );
}

%% GetQuestNodeTemplate()
%	Retrieves a questnode template by index number, counting from *end* of list,
%	since we can only add to the front of a list (yuk).
%	The alternative is to give each questnode a name, but that would lead to garbage collection hell.
%	Don't you love this cheesy language?
%	Index numbers begin with 1.
%	Returns template if successful, $ otherwise
%%
GetQuestNodeTemplate( index = 0 )
{
	if( ( index < 1 ) OR ( index > Length( plQuestNodeTemplates ) ) )
	{
		return $;
	}
	return Nth( plQuestNodeTemplates, Length( plQuestNodeTemplates ) + 1 - index );
}

%% IsValidQuestNodeTemplate()
%	Returns 1 if index refers to a valid quest node template, 0 otherwise
%%
IsValidQuestNodeTemplate( index = 0 )
{
	if( index < 1 )
	{
		return 0;
	}
	if( Length( plQuestNodeTemplates ) < index )
	{
		return 0;
	}

	return 1;
}

%% GetRandomNPCFromQuestNodeTemplate( index )
%	Retrieves a random NPC from the list in questnode template #index
%	Does not check NPC modifier -- check it before deciding to call this
%	Returns NPC if successful, $ otherwise
%%
GetRandomNPCFromQuestNodeTemplate( index = 0, not_NPC = $ )
{
	local lNPCList, oNPC;

	lNPCList = Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_NPC_LIST );

	if( lNPCList = $ )
	{
           DEBUG("Nil NPC list, QN:",index);
		return $;
	}
	oNPC = Nth( lNPCList, Random( 1, Length( lNPCList ) ) );
	if( not_NPC = $ )
	{
		return oNPC;
	}
	while( ( oNPC = not_NPC ) AND ( lNPCList <> $ ) )
	{
		lNPCList = DelListElem( lNPCList, oNPC );
		if Length( lNPCList ) = 0 { DEBUG("Disallowed all NPCs listed, so no NPC to choose!  QN:",index);  return $; }
		oNPC = Nth( lNPCList, Random( 1, Length( lNPCList ) ) );
	}
	if( lNPCList <> $ )
	{
		return oNPC;
	}
	return $;
}

%% GetRandomCargoFromQuestNodeTemplate( index )
%	Retrieves a random cargo from the list in questnode template #index
%	Returns cargo if successful, $ otherwise
%%
GetRandomCargoFromQuestNodeTemplate( index = 0 )
{
	local lCargoList;

	lCargoList = Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_CARGO_LIST );
	if( lCargoList = $ )
	{
		return $;
	}
	return Nth( lCargoList, Random( 1, Length( lCargoList ) ) );
}

%% GetRandomPrizeFromQuestNodeTemplate( index )
%	Retrieves a random prize from the list in questnode template #index
%	Returns prize if successful, $ otherwise
%%
GetRandomPrizeFromQuestNodeTemplate( index = 0 )
{
	local lPrizeList, i, prize, retVal;

	lPrizeList = Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_PRIZE_LIST );
	if( lPrizeList = $ )
	{
		return $;
	}
   retVal = $;
   i = length(lPrizelist);
	while i > 0 {
           prize = nth(lPrizelist, i);
           if isList(first(prize)) {                                      % if the prize is actually a list of prizes,
              retVal = cons(nth(prize,random(1,length(prize))),retVal);   %  pick one randomly
   	}
   	else {
              retVal = cons(prize,retVal);
   	}
           i=i-1;
	}
	return retVal;
}

%% GetRandomPenaltyFromQuestNodeTemplate( index )
%	Retrieves a random penalty from the list in questnode template #index
%	Returns penalty if successful, $ otherwise
%%
GetRandomPenaltyFromQuestNodeTemplate( index = 0 )
{
	local lPenaltyList, i, penalty, retVal;

	lPenaltyList = Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_PENALTY_LIST );
	if( lPenaltyList = $ )
	{
		return $;
	}
   retVal = $;
   i = length(lPenaltyList);
	while i > 0 {
           penalty = nth(lPenaltyList, i);
           if isList(first(penalty)) {                                      % if the prize is actually a list of prizes,
              retVal = cons(nth(penalty,random(1,length(penalty))),retVal);   %  pick one randomly
   	}
   	else {
              retVal = cons(penalty,retVal);
   	}
           i=i-1;
	}
	return retVal;
}

%% GetRandomMonsterFromQuestNodeTemplate( index )
%	Retrieves a random monster class from the list in questnode template #index
%	Returns monster class if successful, $ otherwise
%%
GetRandomMonsterFromQuestNodeTemplate( index = 0 )
{
	local lQNTemplate, lMonsterList;

	lQNTemplate = send( self, @GetQuestNodeTemplate, #index = index);
	lMonsterList = Nth( lQNTemplate, QNT_MONSTER_LIST );
	if( lMonsterList = $ )
	{
		return $;
	}

	return Nth( lMonsterList, Random( 1, Length( lMonsterList ) ) );
}

GetQuestNodeTimeLimit( index = 0 )
{
	return Nth( send( self, @GetQuestNodeTemplate, #index = index), QNT_TIME_LIMIT );
}

%% SetQuestNodeNPCList:
%	Set the NPC_list of QNT #index to new_NPC_list
%	Resets NPC_list to plDefaultNPCList if new_NPC_list is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeNPCList( index = 0, new_NPC_list = $ )
{
   local oNPC;

   if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
   {
      return 0;
   }

   % NPC's must be listeners and receivers and not quest prohibited
   for oNPC in new_NPC_list
   {  
      if( ( ( Send( oNPC, @GetAttributes ) & ( MOB_RECEIVE | MOB_LISTEN ) ) = 0 )
       OR ( Send( oNPC, @GetAttributes ) & MOB_NOQUEST ) )
      {
%         debug( "SetQuestNodeNPCList #",index );
%         debug( "Invalid NPC - ignored",oNPC );
         new_NPC_list = DelListElem( new_NPC_list, oNPC );
      }
   }

   if( new_NPC_list = $ )
   {
      return 0;
   }
   SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_NPC_LIST, new_NPC_list );
   return 1;
}

%% SetQuestNodeNPCModifier:
%	Set the NPCModifier of QNT #index to the new_mod
%	Resets NPCModifier to default if new_mod is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeNPCModifier( index = 0, new_mod = $ )
{
	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( ( new_mod < QN_NPCMOD_NONE ) OR ( new_mod > QN_NPCMOD_DIFFERENT ) )
	{
		return 0;
	}
	if( new_mod = $ )
	{
		new_mod = piDefaultNPCModifier;
	}

	SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_NPC_MODIFIER, new_mod );

	return 1;
}

%% SetQuestNodeType:
%	Set the Type of QNT #index to the new_type
%	Resets Type to default if new_type is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeType( index = 0, new_type = $ )
{
	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( ( new_type < QN_TYPE_MESSAGE ) OR ( new_type > QN_TYPE_MONSTER_ITEMCLASS ) )
	{
		return 0;
	}
	if( new_type = $ )
	{
		new_type = piDefaultQuestNodeType;
	}

	SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_TYPE, new_type );

	return 1;
}

%% SetQuestNodeCargoList:
%	Set the CargoList of QNT #index to new_cargo_list
%	No checking of list is done!
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeCargoList( index = 0, new_cargo_list = $ )
{
	local oNPC;

	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}

	% no checking of list!
	if( new_cargo_list = $ )
	{
		new_cargo_list = [];
	}

	SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_CARGO_LIST, new_cargo_list );

	return 1;
}

%% SetQuestNodeMonsterList:
%	Set the MonsterList of QNT #index to new_monster_list
%	No checking of list is done!
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeMonsterList( index = 0, new_monster_list = $ )
{
	local oNPC;

	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}

	% no checking of list!
	if( new_monster_list = $ )
	{
		new_monster_list = [];
	}

	SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_MONSTER_LIST, new_monster_list );

	return 1;
}
%% SetQuestNodePrizeList:
%	Set the PrizeList of QNT #index to new_prize_list
%	No checking of list is done!
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodePrizeList( index = 0, new_prize_list = $ )
{
	local oNPC;

	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}

	% no checking of list!
	if( new_prize_list = $ )
	{
		new_prize_list = [];
	}

	SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_PRIZE_LIST, new_prize_list );

	return 1;
}

%% SetQuestNodePenaltyList:
%	Set the PenaltyList of QNT #index to new_penalty_list
%	No checking of list is done!
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodePenaltyList( index = 0, new_penalty_list = $ )
{
	local oNPC;

	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}

	% no checking of list!
	if( new_penalty_list = $ )
	{
		new_penalty_list = [];
	}

	SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_PENALTY_LIST, new_penalty_list );

	return 1;
}

%% SetQuestNodeAssignHint:
%	Set the assign_hint of QNT #index to the string new_hint
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeAssignHint( index = 0, new_hint = $ )
{
   if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
   {
   	return 0;
   }
   
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%
   % Happyland text subs
   if not send(SYS,@IsPKAllowed)
   {
      if new_hint = sporeburstlearn_assign_2 { new_hint = sporeburstlearn_assign_2_h; }
      if new_hint = sporeburstlearn_assign_3 { new_hint = sporeburstlearn_assign_3_h; }
      if new_hint = barrestock_assign_3 { new_hint = barrestock_assign_3_h; }
      if new_hint = catering_assign_3 { new_hint = catering_assign_3_h; }
      if new_hint = apothecary_assign_2 { new_hint = apothecary_assign_2_h; }
      if new_hint = ore_assign_2 { new_hint = ore_assign_2_h; }
      if new_hint = vaulttax_assign_2 { new_hint = vaulttax_assign_2_h; }
      if new_hint = merchanttax_assign_2 { new_hint = merchanttax_assign_2_h; }
      if new_hint = latetax_assign_2 { new_hint = latetax_assign_2_h; }
      if new_hint = kocweapon_assign_2 { new_hint = kocweapon_assign_2_h; }
      if new_hint = kocweapon_assign_3 { new_hint = kocweapon_assign_3_h; }
      if new_hint = kocale_assign_2 { new_hint = kocale_assign_2_h; }
      if new_hint = kocale_assign_3 { new_hint = kocale_assign_3_h; }
   }
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%

   % no checking of hint!
   if( new_hint = $ )
   {
       SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_ASSIGN_HINT, $ );
       return 1;
   }
   if( send( self, @GetQuestNodeAssignHint, #index = index ) = $ )
   {
      SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_ASSIGN_HINT, CreateString() );
   }
   SetString( send( self, @GetQuestNodeAssignHint, #index = index ), new_hint );

	return 1;
}

%% SetQuestNodeSuccessHint:
%	Set the success_hint of QNT #index to the string new_hint
%	Resets success_hint to default_success_hint if new_hint is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeSuccessHint( index = 0, new_hint = $ )
{
	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}

   %%%%%%%%%%%%%%%%%%%%%%%%%%%%
   % Happyland text subs
   if not send(SYS,@IsPKAllowed)
   {
      if new_hint = sporeburstlearn_success_3 { new_hint = sporeburstlearn_success_3_h; }
   }
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%

	if( new_hint = $ )
	{
            SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_SUCCESS_HINT, $ );
            return 1;
         }
         if( send( self, @GetQuestNodeSuccessHint, #index = index ) = $ )
         {
            SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_SUCCESS_HINT, CreateString() );
         }

	SetString( send( self, @GetQuestNodeSuccessHint, #index = index ), new_hint );

	return 1;
}

%% SetQuestNodeFailureHint:
%	Set the failure_hint of QNT #index to the string new_hint
%	Resets failure_hint to default_failure_hint if new_hint is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeFailureHint( index = 0, new_hint = $ )
{
	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}

   %%%%%%%%%%%%%%%%%%%%%%%%%%%%
   % Happyland text subs
   if not send(SYS,@IsPKAllowed)
   {
      if new_hint = barrestock_failure_3 { new_hint = barrestock_failure_3_h; }
      if new_hint = catering_failure_3 { new_hint = catering_failure_3_h; }
      if new_hint = apothecary_failure_2 { new_hint = apothecary_failure_2_h; }
      if new_hint = ore_failure_2 { new_hint = ore_failure_2_h; }
      if new_hint = vaulttax_failure_2 { new_hint = vaulttax_failure_2_h; }
      if new_hint = merchanttax_failure_2 { new_hint = vaulttax_failure_2_h; }
      if new_hint = latetax_failure_2 { new_hint = latetax_failure_2_h; }
      if new_hint = kocweapon_failure_3 { new_hint = kocweapon_failure_3_h; }
      if new_hint = kocale_failure_3 { new_hint = kocale_failure_3_h; }
   }
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%

	if( new_hint = $ )
	{
            SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_FAILURE_HINT, $ );
            return 1;
         }
         if( send( self, @GetQuestNodeFailureHint, #index = index ) = $ )
         {
            SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_FAILURE_HINT, CreateString() );
         }
	SetString( send( self, @GetQuestNodeFailureHint, #index = index ), new_hint );

	return 1;
}

%	Set the TimeLimit of QNT #index to the new_limit
%	Resets TimeLimit to default if new_limit is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodeTimeLimit( index = 0, new_limit = $ )
{
	if( send( self, @IsValidQuestNodeTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( new_limit < 0 )
	{
		return 0;
	}
	if( new_limit = $ )
	{
		new_limit = piDefaultTimeLimit;
	}

	SetNth( send( self, @GetQuestNodeTemplate, #index = index), QNT_TIME_LIMIT, new_limit );

	return 1;
}

%% AddQuestTemplate:
%	Adds a new quest template to plQuestTemplates
%	Returns index number of new quest template if successful, 0 otherwise
%	Will be scheduled next timer fire, if successful.
%
	% QuestTemplate is
	%	[	number of players,
	%		type of quest,
	%		eligible player restrictions,
	%		quest nodes,
	%		max number active,
	%		currently active quests,
	%		percent chance of scheduling (on timer firing)
	%     special restrictions]
%%
AddQuestTemplate(	num_players = $,
					quest_type = $,
					player_restrict = $,
					player_restrict2 = $,
					nodes = $,
					max_active = $, 
					schedule_pct = $ )
{
	% Validity checks

	local iNodeIndex, lThisQuestTemplate, iThisQNTIndex;

	% num_players must be valid
	if( num_players = $ )
	{
		num_players = piDefaultNumPlayers;
	}
	if( ( num_players < 1 ) OR ( num_players > QUEST_MAX_NUM_PLAYERS ) )
	{
		return 0;
	}

	% Quest type must be valid
	if( quest_type = $ )
	{
		quest_type = piDefaultQuestType;
	}
	if( ( quest_type < Q_TYPE_COMPETITIVE ) OR ( quest_type > Q_TYPE_COLLECTIVE ) )
	{
		return 0;
	}

	% player_restrict must be valid
	if( player_restrict = $ )
	{
		player_restrict = piDefaultPlayerRestrict;
	}
	if( ( player_restrict < 0 ) OR ( player_restrict > Q_PLAYER_FACTION_OUT ) )
	{
		return 0;
	}

	% nodes must be valid -- set these up first
	if( nodes = $ )
	{
		nodes = plDefaultQuestNodes;
	}
	for iNodeIndex in nodes
	{
		if( NOT send( self, @IsValidQuestNodeTemplate, #index = iNodeIndex ) )
		{
			return 0;
		}
	}

	% max_active must be valid
	if( max_active = $ )
	{
		max_active = piDefaultMaxNumberActive;
	}

	% schedule_pct must be valid
	if( schedule_pct = $ )
	{
		schedule_pct = piDefaultRescheduleChance;
	}
	if( ( schedule_pct < 0 ) OR ( schedule_pct > 100 ) )
	{
		return 0;
	}

	lThisQuestTemplate = [ num_players, quest_type,	player_restrict,\
							nodes, max_active, [], schedule_pct, player_restrict2 ];

	%	Can only add to front of list
	plQuestTemplates = Cons( lThisQuestTemplate, plQuestTemplates );

	return Length( plQuestNodeTemplates );
}

%% IsValidQuestTemplate()
%	Returns 1 if index refers to a valid quest template, 0 otherwise
%%
IsValidQuestTemplate( index = 0 )
{
	if( Length( plQuestTemplates ) < index ) or (index < 1)
	{
		return 0;
	}

	return 1;
}

%% GetQuestTemplate()
%	Retrieves a quest template by index number, counting from *end* of list,
%	since we can only add to the front of a list (yuk).
%	The alternative is to give each quest a name, but that would lead to garbage collection hell.
%	Don't you love this cheesy language?
%	Index numbers begin with 1.
%	Returns template if successful, $ otherwise
%%
GetQuestTemplate( index = 0 )
{
	if( ( index < 1 ) OR ( index > Length( plQuestTemplates ) ) )
	{
		return $;
	}
	return Nth( plQuestTemplates, Length( plQuestTemplates ) + 1 - index );
}

%% SetQuestNumPlayers()
%	Set the NumPlayers of QT #index to the new_num
%	Resets NumPlayers to default if new_num is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNumPlayers( index = 0, new_num = $ )
{
	if( send( self, @IsValidQuestTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( new_num = $ )
	{
		new_num = piDefaultNumPlayers;
	}
	if( ( new_num < 1 ) OR ( new_num > QUEST_MAX_NUM_PLAYERS ) )
	{
		return 0;
	}

	SetNth( send( self, @GetQuestTemplate, #index = index), QT_NUM_PLAYERS, new_num );

	return 1;
}

%% SetQuestType()
%	Set the Type of QT #index to the new_type
%	Resets Type to default if new_type is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestType( index = 0, new_type = $ )
{
	if( send( self, @IsValidQuestTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( new_type = $ )
	{
		new_type = piDefaultQuestType;
	}
	if( ( new_type < Q_TYPE_COMPETITIVE ) OR ( new_type > Q_TYPE_COLLECTIVE ) )
	{
		return 0;
	}

	SetNth( send( self, @GetQuestTemplate, #index = index), QT_QUEST_TYPE, new_type );

	return 1;
}

%% SetQuestNodesList()
%	Set the NodesList of QT #index to the new_list
%	Resets NodesList to default if new_list is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestNodesList( index = 0, new_list = $ )
{
	local iNodeIndex;
	if( send( self, @IsValidQuestTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( new_list = $ )
	{
		new_list = plDefaultQuestNodes;
	}
	for iNodeIndex in new_list
	{
		if( NOT send( self, @IsValidQuestNodeTemplate, #index = iNodeIndex ) )
		{
			return 0;
		}
	}

	SetNth( send( self, @GetQuestTemplate, #index = index), QT_QUEST_NODES, new_list );

	return 1;
}

%% SetQuestMaxActive()
%	Set the MaxActive of QT #index to the new_max
%	Resets MaxActive to default if new_max is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestMaxActive( index = 0, new_max = $ )
{
	if( send( self, @IsValidQuestTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( new_max = $ )
	{
		new_max = piDefaultMaxNumberActive;
	}
	if( ( new_max < 0 ) OR ( new_max > QUEST_MAX_MAX_ACTIVE ) )
	{
		return 0;
	}

	SetNth( send( self, @GetQuestTemplate, #index = index), QT_MAX_NUM_ACTIVE, new_max );

	return 1;
}

%% SetQuestScheduleChance()
%	Set the ScheduleChance of QT #index to the new_pct
%	Resets ScheduleChance to default if new_pct is nil
%	Returns 1 if successful, 0 otherwise
%%
SetQuestScheduleChance( index = 0, new_pct = $ )
{
	if( send( self, @IsValidQuestTemplate, #index = index ) = FALSE )
	{
		return 0;
	}
	if( new_pct = $ )
	{
		new_pct = piDefaultRescheduleChance;
	}
	if( ( new_pct < 0 ) OR ( new_pct > 100 ) )
	{
		return 0;
	}

	SetNth( send( self, @GetQuestTemplate, #index = index), QT_SCHEDULE_CHANCE, new_pct );

	return 1;
}

%% CreateQuest()
%
%%
CreateQuest( quest_template = 1 )
{
	% Needs error-checking!

	local lQuestTemplate, oQuest, oFirstNode; 

	lQuestTemplate = send( self, @GetQuestTemplate, #index = quest_template );
	if( lQuestTemplate = $ )
	{
		return $;
	}

	% Create and initialize quest
	oQuest = Create( &QuestX );
	send( oQuest, @Init, #template_index = quest_template, #report = piDebug );

	% Add new quest to questtemplate's list of active quests
	send( self, @AddQuestToActiveList, #quest_template = quest_template, #new_quest = oQuest );
	return;
}

%% AddQuestToActiveList()
%	Add new quest to questtemplate's list of active quests
%%
AddQuestToActiveList( quest_template = $, new_quest = $ )
{
	local lActiveQuests;

	if( new_quest = $ )
	{
		return;
	}
	if( send( self, @IsValidQuestTemplate, #index = quest_template ) )
	{
		lActiveQuests = Nth( send( self, @GetQuestTemplate, #index = quest_template ), QT_ACTIVE_QUESTS );
		SetNth( send( self, @GetQuestTemplate, #index = quest_template ), QT_ACTIVE_QUESTS, cons( new_quest, lActiveQuests ) );
	}
	return;
}

%% RemoveQuestFromActiveList()
%	Remove finished quest from questtemplate's list of active quests
%%
RemoveQuestFromActiveList( quest_template = $, done_quest = $ )
{
	local lActiveQuests;

	if( done_quest = $ ) { return; }
	
	if( send( self, @IsValidQuestTemplate, #index = quest_template ) )
	{
		lActiveQuests = Nth( send( self, @GetQuestTemplate, #index = quest_template ), QT_ACTIVE_QUESTS );
		if FindListElem(lActiveQuests, done_quest) {
	           SetNth( send( self, @GetQuestTemplate, #index = quest_template ), QT_ACTIVE_QUESTS, DelListElem( lActiveQuests, done_quest ) );
		}
		else {
	           DEBUG("Questengine::RemoveQuestFromActiveList:  Couldn't find quest in activelist of quest type ",quest_template,"!");
		}
	}
	return;
}

%% GetNextQuestNode()
%	return the index of the next quest node in a quest's list
%%
GetNextQuestNode( quest_template = $, counter = 1 )
{
	if( Length( Nth( send( self, @GetQuestTemplate, #index = quest_template ), QT_QUEST_NODES ) ) < counter )
	{
		return $;
	}

	return Nth( Nth( send( self, @GetQuestTemplate, #index = quest_template ), QT_QUEST_NODES ), counter );
}

GetQuestPlayerRestrictions( index = $ )
{
	return Nth( send( self, @GetQuestTemplate, #index = index), QT_PLAYER_RESTRICT );
}
GetQuestPlayerRestrictions2( index = $ )
{
   if length(send( self, @GetQuestTemplate, #index = index)) >= QT_PLAYER_RESTRICT2 {
           return Nth( send( self, @GetQuestTemplate, #index = index), QT_PLAYER_RESTRICT2 );
	}
	return $;
}

GetDebugStatus()
{
   return piDebug;
}

GetQuestHistoryRecentTime()
{
   return piQuestHistoryRecentTime;
}

%% GetRandomChessMove()
%	return a string containing a random legal chess move
%%
GetRandomChessMove()
{
	local i, sChessMove;
	sChessMove = CreateString();

	% arbitrary: equal chance of a move or capture (no castling)
	i = Random( 1, 2 );
	if( i = 1 )
	{
		% move
		SetString( sChessMove, chess_move );
		StringSubstitute( sChessMove, chess_substring, Nth( plChessPieces, Random( 1, Length( plChessPieces ) ) ) );
		StringSubstitute( sChessMove, chess_substring, Nth( plChessPiecesFiles, Random( 1, Length( plChessPiecesFiles ) ) ) );
		StringSubstitute( sChessMove, chess_substring, Nth( plChessPiecesRanks, Random( 1, Length( plChessPiecesRanks ) ) ) );

		return sChessMove;
	}

	% (else) capture
	SetString( sChessMove, chess_capture );
	StringSubstitute( sChessMove, chess_substring, Nth( plChessPieces, Random( 1, Length( plChessPieces ) ) ) );
	StringSubstitute( sChessMove, chess_substring, Nth( plChessPiecesCaptured, Random( 1, Length( plChessPiecesCaptured ) ) ) );

	return sChessMove;
}

%% AddQuestNodeToAwaitingMonsterDeathList()
%	Add the quest node to the list of those waiting for a certain player to kill a certain type of monster
%%
AddQNToAwaitingMonsterDeathList( QN = $ )
{
	if( QN <> $ )
	{
		plQuestNodesAwaitingMonsterDeath = cons( QN, plQuestNodesAwaitingMonsterDeath );
	}
	
	return;
}		         

%% RemoveQuestNodeFromAwaitingMonsterDeathList()
%	Remove the quest node from the list of those waiting for a certain player to kill a certain type of monster
%%
RemoveQNFromAwaitingMonsterDeathList( QN = $ )
{
	if( QN = $ ) or (plQuestNodesAwaitingMonsterDeath=$) { return; }
	
	if FindListElem(plQuestNodesAwaitingMonsterDeath,QN )
	{
		plQuestNodesAwaitingMonsterDeath = DelListElem( plQuestNodesAwaitingMonsterDeath, QN );
	}
	%%  this actually gets called quite frequently, so leave out this debug for now.
	%else
	%{
	%   DEBUG("QuestEngine::RemoveQNFromAwaitingMonsterDeathList: Node of type ",send(QN,@GetQuestNodeTemplateIndex)," not found in plQuestNodesAwaitingMonsterDeath.");
	%}
	
	return;
}		         

%% MonsterKilled()
%	A player has just killed a monster.
%	Notify those quest nodes waiting for a certain player to kill a certain type of monster
%%
MonsterKilled( dead_monster = $, killing_player = $, corpse = $ )
{
	local QN;
	for QN in plQuestNodesAwaitingMonsterDeath
	{
		if( QN <> $ )
		{
			if( send( QN, @MonsterKilled, #dead_monster = dead_monster, #killing_player = killing_player, #corpse = corpse ) )
			{
				% found the questnode waiting for this player to kill this type of monster 
				send( self, @RemoveQNFromAwaitingMonsterDeathList, #QN = QN );
				return;	
			}
		}
	}
	return;
}		         

ManualSetoffQuestTimer()
{
   DeleteTimer( ptQuestTimer );
   send(self,@OnQuestTimer);
   return;
}

OnQuestTimer()
{
   local QTindex, iNumQT;

   %	DeleteTimer( ptQuestTimer );		% try removing this line -- damian
   ptQuestTimer = $;
   ptQuestTimer = CreateTimer( self, @OnQuestTimer, piQuestTimerDelay );
   if ptQuestDeadlineTimer = $ {
      ptQuestDeadlineTimer = CreateTimer(self, @OnQuestDeadlineTimer, piQuestDeadlineTimerDelay );
   }

   if( piActive = 0 )
   {
      return;
   }
   	
   % Check each quest to see if its deadline has passed.
   send(self,@CheckQuestDeadlines);

   % Check each quest template to see if another quest needs to be scheduled
   QTindex = 0;
   iNumQT = Length( plQuestTemplates );
   while( QTindex < iNumQT ) {
      QTindex = QTindex + 1;
      send(self,@ScheduleQuest,#index=QTindex);
   }         
   return;
}

ScheduleQuest(index=0, override=FALSE)
"Schedules a Quest if the cap hasn't been reached "
"Also does a QT_SCHEDULE_CHANCE die roll unless override=TRUE."
{
   local QT, lActiveQuests, QTindex, iActive, iMaxActive;
   
   QT = send(self,@GetQuestTemplate,#index=index);
   if QT = $ {return;}
   lActiveQuests = Nth( QT, QT_ACTIVE_QUESTS );
   iActive = Length( lActiveQuests );
   iMaxActive = Nth( QT, QT_MAX_NUM_ACTIVE );
%      debug( "Active ", iActive );
%      debug( "Max ", iMaxActive );
   if( iActive < iMaxActive )
   {
      % another one is allowed, so do the die roll
      if override or ( Random( 1, 100 ) < Nth(QT, QT_SCHEDULE_CHANCE) )
      {
         if piDebug 
         {
            debug( "Scheduling quest of type ", index );
         }
         send( self, @CreateQuest, #quest_template = index );
      }
   }
   return;
}

GetNumScheduled(index = 0)
{
   return length(Nth( send( self, @GetQuestTemplate, #index = index), QT_ACTIVE_QUESTS ));
}

OnQuestDeadlineTimer()
{
   ptQuestDeadlineTimer = $;
   send(self,@CheckQuestDeadlines);
   ptQuestDeadlineTimer = CreateTimer(self, @OnQuestDeadlineTimer, piQuestDeadlineTimerDelay );
   return;
}

CheckQuestDeadlines()
{
   local QT, Q, iTime;
   iTime = GetTime();

   for QT in plQuestTemplates {
      if( QT = $ ) {
         DEBUG( "Nil quest template!" );	% should delete it here xxxAJM: plQuestTemplates = DelListElem( plQuestTemplates, QT );
      }
      else {
         for Q in Nth( QT, QT_ACTIVE_QUESTS ) {
            if( Q = $ ) {
               DEBUG( "Nil quest!" );	% should delete it here xxxAJM
            }
            else {
               send( Q, @CheckDeadline, #time = iTime );
            }
         }
      }
   }
   return;
}

   %% Suspend()
   % suspends scheduling of quests and processing of deadlines
   % call with resume <> 0 to resume
   %%
   Suspend( resume = 0 )
   {
      if( resume = 0 )
      {
         debug( "Quest scheduling suspended." );
         piActive = 0;
      }
      else
      {
         debug( "Quest scheduling resumed." );
         piActive = 1;
      }
      return;
   }

   %% DeleteActiveQuests()
   % deletes all active quests
   %%
   DeleteActiveQuests()
   {
      local iQT, oQuest, iStatus, lOcc,oNPC;
      iStatus = piActive;
      if( iStatus )
      {
         send( self, @Suspend );
      }
      for iQT in plQuestTemplates
      {
         for oQuest in Nth( iQT, QT_ACTIVE_QUESTS )
         {
            send( oQuest, @Cancel );
         }
      }

      if( iStatus )
      {
         send( self, @Suspend, #resume = 1 );
      }
      return;
   }

%% ClearAllQuests()
%  This cancels all active quests, and strips the quest templates so NPC's can be rebuilt
%  It is called by RecreateAll, prior to rebuilding the templates with Recreate( #all = 1 )
%%
   ClearAllQuests()
   {
      send( self, @DeleteActiveQuests );
      send( self, @Suspend );
      plQuestTemplates = $;
      plDefaultNPCList = $;
      plQuestNodeTemplates = $;
      plQuestNodesAwaitingMonsterDeath = $;
      return;
   }

   QuestReport(who = $)
   {
      local iQ, oQ, sQuesters, bFirst, iAvailable, iAssigned, iUnassigned;
      if who = $
      {
         % find player named 'aphasia' and send it to her.
         return;
      }
      iQ = 1;
      while send(self,@IsValidQuestTemplate, #index=iQ) {
         iAvailable = 0;
         iUnassigned = 0;
         iAssigned = 0;
         ClearTempString();
         bFirst = TRUE;
         for oQ in nth(send(self,@GetQuestTemplate,#index=iQ),QT_ACTIVE_QUESTS) {
            iAvailable = iAvailable + 1;
            if send(oQ,@GetQuesters) = $ {
               iUnassigned = iUnassigned + 1;
            }
            else {
               iAssigned = iAssigned + 1;
               if not bFirst {
                  AppendTempString(questEngine_report_2);
               }
               else {
                  bFirst = FALSE;
               }
               AppendTempString(send(first(send(oQ,@GetQuesters)),@GetName));
            }
         }
         sQuesters = CreateString();
         setString(sQuesters,GetTempString());
         send(who,@receivenestedmail,#from=questEngine_report_sender,
               #dest_list=[who],
               #nest_list=[4,questEngine_report_1,
                           4,send(SYS,@IntToString,#num=iQ),
                           4,send(SYS,@IntToString,#num=iQ),
                           4,send(SYS,@IntToString,#num=iAvailable),
                           4,send(SYS,@IntToString,#num=iUnassigned),
                           4,send(SYS,@IntToString,#num=iAssigned),
                           4,sQuesters ]);
         if piDebug {
            debug("Quest ",iQ,": ",iAvailable," available; ",iUnassigned," unassigned and ",iAssigned," assigned.");
         }
         if piDebug > 1 {
            for oQ in nth(send(self,@GetQuestTemplate,#index=iQ),QT_ACTIVE_QUESTS) {
               if send(oQ,@GetQuesters) <> $ {
                  debug( "Quest of type ",iQ," assigned to ",send(first(send(oQ,@GetQuesters)),@GetName) );
               }
            }
         }
         iQ = iQ + 1;
      }

      return;      
   }

   CensusReport()
   "Prints summary information about quests to the debug log."
   {
      local iQT;
      iQT = 1;
      while send(self,@IsValidQuestTemplate,#index = iQT) {
         piCensusTallyDeleted = 0;
         piCensusTallyActive = 0;
         piCensusTallyActiveOrphaned = 0;
         piCensusTallyActiveDuplicate = 0;
         send(&QuestX,@CensusRespond,#index=iQT);
         debug("Quest Template ",iQT," has ",piCensusTallyActive," active quests and ",piCensusTallyDeleted," deleted quests.");
         if piCensusTallyActiveOrphaned <> 0 {
            debug("Quest Template ",iQT," has ",piCensusTallyActiveOrphaned,"orphaned active quests!");
         }
         if piCensusTallyActiveDuplicate <> 0 {
            debug("Quest Template ",iQT," has ",piCensusTallyActiveDuplicate,"duplicate active quests!");
         }
         iQT = iQT + 1;
      }
      return;
   }


   CensusCountDeleted()
   {
      piCensusTallyDeleted = piCensusTallyDeleted +1;
      return;
   }

   CensusCountActive(what=$)
   {
      local oQ, bFound;
      bFound = FALSE;
      for oQ in nth(send(self,@GetQuestTemplate,#index = send(what,@GetQuestTemplateIndex)),QT_ACTIVE_QUESTS) {
         if oQ = what {
            if not bFound {
               piCensusTallyActive = piCensusTallyActive +1;
               bFound = TRUE;
            }
            else {
               piCensusTallyActiveDuplicate = piCensusTallyActiveDuplicate + 1;
            }
         }
      }
      if not bFound {
         piCensusTallyActiveOrphaned = piCensusTallyActiveOrphaned + 1;
      }
      return;
   }

   Jumpstart()
   "A quick and dirty way to get things running again."
   {
      send(self,@Recreate);
      send(self,@RecreateQuestNodes);

      return;
   }


end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
